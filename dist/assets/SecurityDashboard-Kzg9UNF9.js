import{r as c,l as w,t as S,j as e,T as x}from"./index-o4gpx1In.js";import{S as m}from"./shield-Bpl7O2Ou.js";import{A as h}from"./activity-Cw-Sm8QH.js";import{C as j}from"./circle-x-Bc15q1z6.js";import{L as p}from"./lock-So9soKzo.js";import{C as o}from"./circle-check-big-b_APp8Jk.js";import{E}from"./eye-DVmOJ1xJ.js";function T(){const[i,l]=c.useState([]),[s,a]=c.useState({totalEvents:0,criticalEvents:0,blockedRequests:0,authFailures:0,rateLimitHits:0}),[d,y]=c.useState("24h"),[b,u]=c.useState(!0);c.useEffect(()=>{N()},[d]);const N=async()=>{u(!0);try{await new Promise(v=>setTimeout(v,500));const t=[{id:"1",timestamp:new Date().toISOString(),type:"rate_limit",severity:"medium",description:"Rate limit exceeded for API endpoint",ip:"192.168.1.100"},{id:"2",timestamp:new Date(Date.now()-36e5).toISOString(),type:"auth_failure",severity:"high",description:"Multiple failed login attempts",ip:"192.168.1.101"}];l(t),a({totalEvents:142,criticalEvents:3,blockedRequests:28,authFailures:12,rateLimitHits:45})}catch(t){w.error("Error fetching security data:",t),S.error("Failed to load security data")}finally{u(!1)}},g=t=>{switch(t){case"critical":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-blue-600 bg-blue-50";default:return"text-gray-600 bg-gray-50"}},f=t=>{switch(t){case"rate_limit":return e.jsx(h,{className:"w-5 h-5"});case"auth_failure":return e.jsx(p,{className:"w-5 h-5"});case"invalid_input":return e.jsx(x,{className:"w-5 h-5"});case"suspicious_activity":return e.jsx(E,{className:"w-5 h-5"});default:return e.jsx(m,{className:"w-5 h-5"})}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(m,{className:"w-8 h-8 text-[#D91C81]"}),"Security Dashboard"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and manage security events"})]}),e.jsx("div",{className:"flex gap-2",children:["1h","24h","7d","30d"].map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d===t?"bg-[#D91C81] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t==="1h"?"1 Hour":t==="24h"?"24 Hours":t==="7d"?"7 Days":"30 Days"},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(n,{icon:e.jsx(h,{className:"w-6 h-6 text-blue-600"}),label:"Total Events",value:s.totalEvents,color:"blue"}),e.jsx(n,{icon:e.jsx(x,{className:"w-6 h-6 text-red-600"}),label:"Critical Events",value:s.criticalEvents,color:"red"}),e.jsx(n,{icon:e.jsx(j,{className:"w-6 h-6 text-orange-600"}),label:"Blocked Requests",value:s.blockedRequests,color:"orange"}),e.jsx(n,{icon:e.jsx(p,{className:"w-6 h-6 text-purple-600"}),label:"Auth Failures",value:s.authFailures,color:"purple"}),e.jsx(n,{icon:e.jsx(m,{className:"w-6 h-6 text-green-600"}),label:"Rate Limit Hits",value:s.rateLimitHits,color:"green"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Security Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(r,{name:"HTTPS Enabled",status:"active"}),e.jsx(r,{name:"Rate Limiting",status:"active"}),e.jsx(r,{name:"Input Sanitization",status:"active"}),e.jsx(r,{name:"CSRF Protection",status:"active"}),e.jsx(r,{name:"Security Headers",status:"active"}),e.jsx(r,{name:"Audit Logging",status:"active"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recent Security Events"}),i.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(o,{className:"w-12 h-12 mx-auto mb-3 text-green-500"}),e.jsx("p",{children:"No security events recorded"})]}):e.jsx("div",{className:"space-y-3",children:i.map(t=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${g(t.severity)}`,children:f(t.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.description}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${g(t.severity)}`,children:t.severity.toUpperCase()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:new Date(t.timestamp).toLocaleString()}),t.ip&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["IP: ",e.jsx("code",{className:"bg-gray-100 px-2 py-0.5 rounded",children:t.ip})]})]})]})})},t.id))})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(m,{className:"w-6 h-6 text-blue-600"}),"Security Recommendations"]}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:"All security features are properly configured"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:"Rate limiting is active and protecting endpoints"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:"Input validation and sanitization implemented"})]})]})]})]})}function n({icon:i,label:l,value:s,color:a}){return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i,e.jsx("span",{className:`text-2xl font-bold text-${a}-600`,children:s})]}),e.jsx("p",{className:"text-sm text-gray-600",children:l})]})}function r({name:i,status:l}){const a={active:{color:"text-green-600",bg:"bg-green-50",icon:o},inactive:{color:"text-red-600",bg:"bg-red-50",icon:j},warning:{color:"text-yellow-600",bg:"bg-yellow-50",icon:x}}[l],d=a.icon;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${a.bg}`,children:[e.jsx(d,{className:`w-5 h-5 ${a.color}`}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:i})]})}export{T as SecurityDashboard};
