import{m as ft,r as x,W as Se,j as e,P as Ge,ah as pt,u as mt,a1 as gt,C as me,n as De,x as xt,t as oe,g as bt}from"./index-Cwl2suO6.js";import{C as ge}from"./card-C0rUAEdB.js";import{B as Ie}from"./badge-CVvH5yJO.js";import{P as vt}from"./progress-BW6z8-Tw.js";import{P as Ee}from"./index-CW1p-fle.js";import{P as Pe}from"./index-boiny7SK.js";import{c as yt,b as be,u as xe,a as wt}from"./index-BxnLrgNs.js";import{u as St}from"./index-fvr49HQo.js";import{c as _t}from"./index-BdQq_4o_.js";import{E as jt}from"./exceljs.min-DVdwevPV.js";import{s as Ct,p as Et}from"./fileSecurityHelpers-CSk_xi4i.js";import{D as Nt}from"./download-BLrmjuRA.js";import{U as qe}from"./upload-BD4ySa9p.js";import{E as kt}from"./eye-Bh609TOw.js";import{S as Oe}from"./save-0l9K206b.js";import{C as Ce}from"./circle-check-big-DqFW6Yzj.js";import{F as $e}from"./file-spreadsheet-Ci41K4yN.js";import{F as Rt}from"./file-text-CLU78OKC.js";import{C as Fe}from"./circle-alert-GQfJtxRP.js";import{L as Xe}from"./loader-circle-Cneib8HD.js";import{C as Ye}from"./circle-x-CkzBQSmo.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Tt=ft("table",Pt);function At(n,d){return x.useReducer((a,i)=>d[a][i]??a,n)}var ze="ScrollArea",[Ze]=yt(ze),[Lt,ae]=Ze(ze),et=x.forwardRef((n,d)=>{const{__scopeScrollArea:a,type:i="hover",dir:c,scrollHideDelay:f=600,...h}=n,[l,y]=x.useState(null),[s,m]=x.useState(null),[b,_]=x.useState(null),[R,U]=x.useState(null),[I,X]=x.useState(null),[W,G]=x.useState(0),[he,re]=x.useState(0),[se,Z]=x.useState(!1),[L,r]=x.useState(!1),t=Se(d,p=>y(p)),o=St(c);return e.jsx(Lt,{scope:a,type:i,dir:o,scrollHideDelay:f,scrollArea:l,viewport:s,onViewportChange:m,content:b,onContentChange:_,scrollbarX:R,onScrollbarXChange:U,scrollbarXEnabled:se,onScrollbarXEnabledChange:Z,scrollbarY:I,onScrollbarYChange:X,scrollbarYEnabled:L,onScrollbarYEnabledChange:r,onCornerWidthChange:G,onCornerHeightChange:re,children:e.jsx(Ee.div,{dir:o,...h,ref:t,style:{position:"relative","--radix-scroll-area-corner-width":W+"px","--radix-scroll-area-corner-height":he+"px",...n.style}})})});et.displayName=ze;var tt="ScrollAreaViewport",rt=x.forwardRef((n,d)=>{const{__scopeScrollArea:a,children:i,nonce:c,...f}=n,h=ae(tt,a),l=x.useRef(null),y=Se(d,l,h.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),e.jsx(Ee.div,{"data-radix-scroll-area-viewport":"",...f,ref:y,style:{overflowX:h.scrollbarXEnabled?"scroll":"hidden",overflowY:h.scrollbarYEnabled?"scroll":"hidden",...n.style},children:e.jsx("div",{ref:h.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});rt.displayName=tt;var ue="ScrollAreaScrollbar",st=x.forwardRef((n,d)=>{const{forceMount:a,...i}=n,c=ae(ue,n.__scopeScrollArea),{onScrollbarXEnabledChange:f,onScrollbarYEnabledChange:h}=c,l=n.orientation==="horizontal";return x.useEffect(()=>(l?f(!0):h(!0),()=>{l?f(!1):h(!1)}),[l,f,h]),c.type==="hover"?e.jsx(Dt,{...i,ref:d,forceMount:a}):c.type==="scroll"?e.jsx(It,{...i,ref:d,forceMount:a}):c.type==="auto"?e.jsx(nt,{...i,ref:d,forceMount:a}):c.type==="always"?e.jsx(Ue,{...i,ref:d}):null});st.displayName=ue;var Dt=x.forwardRef((n,d)=>{const{forceMount:a,...i}=n,c=ae(ue,n.__scopeScrollArea),[f,h]=x.useState(!1);return x.useEffect(()=>{const l=c.scrollArea;let y=0;if(l){const s=()=>{window.clearTimeout(y),h(!0)},m=()=>{y=window.setTimeout(()=>h(!1),c.scrollHideDelay)};return l.addEventListener("pointerenter",s),l.addEventListener("pointerleave",m),()=>{window.clearTimeout(y),l.removeEventListener("pointerenter",s),l.removeEventListener("pointerleave",m)}}},[c.scrollArea,c.scrollHideDelay]),e.jsx(Pe,{present:a||f,children:e.jsx(nt,{"data-state":f?"visible":"hidden",...i,ref:d})})}),It=x.forwardRef((n,d)=>{const{forceMount:a,...i}=n,c=ae(ue,n.__scopeScrollArea),f=n.orientation==="horizontal",h=Ae(()=>y("SCROLL_END"),100),[l,y]=At("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(l==="idle"){const s=window.setTimeout(()=>y("HIDE"),c.scrollHideDelay);return()=>window.clearTimeout(s)}},[l,c.scrollHideDelay,y]),x.useEffect(()=>{const s=c.viewport,m=f?"scrollLeft":"scrollTop";if(s){let b=s[m];const _=()=>{const R=s[m];b!==R&&(y("SCROLL"),h()),b=R};return s.addEventListener("scroll",_),()=>s.removeEventListener("scroll",_)}},[c.viewport,f,y,h]),e.jsx(Pe,{present:a||l!=="hidden",children:e.jsx(Ue,{"data-state":l==="hidden"?"hidden":"visible",...i,ref:d,onPointerEnter:be(n.onPointerEnter,()=>y("POINTER_ENTER")),onPointerLeave:be(n.onPointerLeave,()=>y("POINTER_LEAVE"))})})}),nt=x.forwardRef((n,d)=>{const a=ae(ue,n.__scopeScrollArea),{forceMount:i,...c}=n,[f,h]=x.useState(!1),l=n.orientation==="horizontal",y=Ae(()=>{if(a.viewport){const s=a.viewport.offsetWidth<a.viewport.scrollWidth,m=a.viewport.offsetHeight<a.viewport.scrollHeight;h(l?s:m)}},10);return we(a.viewport,y),we(a.content,y),e.jsx(Pe,{present:i||f,children:e.jsx(Ue,{"data-state":f?"visible":"hidden",...c,ref:d})})}),Ue=x.forwardRef((n,d)=>{const{orientation:a="vertical",...i}=n,c=ae(ue,n.__scopeScrollArea),f=x.useRef(null),h=x.useRef(0),[l,y]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),s=ct(l.viewport,l.content),m={...i,sizes:l,onSizesChange:y,hasThumb:s>0&&s<1,onThumbChange:_=>f.current=_,onThumbPointerUp:()=>h.current=0,onThumbPointerDown:_=>h.current=_};function b(_,R){return Bt(_,h.current,l,R)}return a==="horizontal"?e.jsx(Ot,{...m,ref:d,onThumbPositionChange:()=>{if(c.viewport&&f.current){const _=c.viewport.scrollLeft,R=Ke(_,l,c.dir);f.current.style.transform=`translate3d(${R}px, 0, 0)`}},onWheelScroll:_=>{c.viewport&&(c.viewport.scrollLeft=_)},onDragScroll:_=>{c.viewport&&(c.viewport.scrollLeft=b(_,c.dir))}}):a==="vertical"?e.jsx(Ft,{...m,ref:d,onThumbPositionChange:()=>{if(c.viewport&&f.current){const _=c.viewport.scrollTop,R=Ke(_,l);f.current.style.transform=`translate3d(0, ${R}px, 0)`}},onWheelScroll:_=>{c.viewport&&(c.viewport.scrollTop=_)},onDragScroll:_=>{c.viewport&&(c.viewport.scrollTop=b(_))}}):null}),Ot=x.forwardRef((n,d)=>{const{sizes:a,onSizesChange:i,...c}=n,f=ae(ue,n.__scopeScrollArea),[h,l]=x.useState(),y=x.useRef(null),s=Se(d,y,f.onScrollbarXChange);return x.useEffect(()=>{y.current&&l(getComputedStyle(y.current))},[y]),e.jsx(it,{"data-orientation":"horizontal",...c,ref:s,sizes:a,style:{bottom:0,left:f.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:f.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Te(a)+"px",...n.style},onThumbPointerDown:m=>n.onThumbPointerDown(m.x),onDragScroll:m=>n.onDragScroll(m.x),onWheelScroll:(m,b)=>{if(f.viewport){const _=f.viewport.scrollLeft+m.deltaX;n.onWheelScroll(_),ut(_,b)&&m.preventDefault()}},onResize:()=>{y.current&&f.viewport&&h&&i({content:f.viewport.scrollWidth,viewport:f.viewport.offsetWidth,scrollbar:{size:y.current.clientWidth,paddingStart:Re(h.paddingLeft),paddingEnd:Re(h.paddingRight)}})}})}),Ft=x.forwardRef((n,d)=>{const{sizes:a,onSizesChange:i,...c}=n,f=ae(ue,n.__scopeScrollArea),[h,l]=x.useState(),y=x.useRef(null),s=Se(d,y,f.onScrollbarYChange);return x.useEffect(()=>{y.current&&l(getComputedStyle(y.current))},[y]),e.jsx(it,{"data-orientation":"vertical",...c,ref:s,sizes:a,style:{top:0,right:f.dir==="ltr"?0:void 0,left:f.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Te(a)+"px",...n.style},onThumbPointerDown:m=>n.onThumbPointerDown(m.y),onDragScroll:m=>n.onDragScroll(m.y),onWheelScroll:(m,b)=>{if(f.viewport){const _=f.viewport.scrollTop+m.deltaY;n.onWheelScroll(_),ut(_,b)&&m.preventDefault()}},onResize:()=>{y.current&&f.viewport&&h&&i({content:f.viewport.scrollHeight,viewport:f.viewport.offsetHeight,scrollbar:{size:y.current.clientHeight,paddingStart:Re(h.paddingTop),paddingEnd:Re(h.paddingBottom)}})}})}),[Mt,at]=Ze(ue),it=x.forwardRef((n,d)=>{const{__scopeScrollArea:a,sizes:i,hasThumb:c,onThumbChange:f,onThumbPointerUp:h,onThumbPointerDown:l,onThumbPositionChange:y,onDragScroll:s,onWheelScroll:m,onResize:b,..._}=n,R=ae(ue,a),[U,I]=x.useState(null),X=Se(d,t=>I(t)),W=x.useRef(null),G=x.useRef(""),he=R.viewport,re=i.content-i.viewport,se=xe(m),Z=xe(y),L=Ae(b,10);function r(t){if(W.current){const o=t.clientX-W.current.left,p=t.clientY-W.current.top;s({x:o,y:p})}}return x.useEffect(()=>{const t=o=>{const p=o.target;(U==null?void 0:U.contains(p))&&se(o,re)};return document.addEventListener("wheel",t,{passive:!1}),()=>document.removeEventListener("wheel",t,{passive:!1})},[he,U,re,se]),x.useEffect(Z,[i,Z]),we(U,L),we(R.content,L),e.jsx(Mt,{scope:a,scrollbar:U,hasThumb:c,onThumbChange:xe(f),onThumbPointerUp:xe(h),onThumbPositionChange:Z,onThumbPointerDown:xe(l),children:e.jsx(Ee.div,{..._,ref:X,style:{position:"absolute",..._.style},onPointerDown:be(n.onPointerDown,t=>{t.button===0&&(t.target.setPointerCapture(t.pointerId),W.current=U.getBoundingClientRect(),G.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",R.viewport&&(R.viewport.style.scrollBehavior="auto"),r(t))}),onPointerMove:be(n.onPointerMove,r),onPointerUp:be(n.onPointerUp,t=>{const o=t.target;o.hasPointerCapture(t.pointerId)&&o.releasePointerCapture(t.pointerId),document.body.style.webkitUserSelect=G.current,R.viewport&&(R.viewport.style.scrollBehavior=""),W.current=null})})})}),ke="ScrollAreaThumb",ot=x.forwardRef((n,d)=>{const{forceMount:a,...i}=n,c=at(ke,n.__scopeScrollArea);return e.jsx(Pe,{present:a||c.hasThumb,children:e.jsx(zt,{ref:d,...i})})}),zt=x.forwardRef((n,d)=>{const{__scopeScrollArea:a,style:i,...c}=n,f=ae(ke,a),h=at(ke,a),{onThumbPositionChange:l}=h,y=Se(d,b=>h.onThumbChange(b)),s=x.useRef(void 0),m=Ae(()=>{s.current&&(s.current(),s.current=void 0)},100);return x.useEffect(()=>{const b=f.viewport;if(b){const _=()=>{if(m(),!s.current){const R=Vt(b,l);s.current=R,l()}};return l(),b.addEventListener("scroll",_),()=>b.removeEventListener("scroll",_)}},[f.viewport,m,l]),e.jsx(Ee.div,{"data-state":h.hasThumb?"visible":"hidden",...c,ref:y,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:be(n.onPointerDownCapture,b=>{const R=b.target.getBoundingClientRect(),U=b.clientX-R.left,I=b.clientY-R.top;h.onThumbPointerDown({x:U,y:I})}),onPointerUp:be(n.onPointerUp,h.onThumbPointerUp)})});ot.displayName=ke;var Be="ScrollAreaCorner",lt=x.forwardRef((n,d)=>{const a=ae(Be,n.__scopeScrollArea),i=!!(a.scrollbarX&&a.scrollbarY);return a.type!=="scroll"&&i?e.jsx(Ut,{...n,ref:d}):null});lt.displayName=Be;var Ut=x.forwardRef((n,d)=>{const{__scopeScrollArea:a,...i}=n,c=ae(Be,a),[f,h]=x.useState(0),[l,y]=x.useState(0),s=!!(f&&l);return we(c.scrollbarX,()=>{var b;const m=((b=c.scrollbarX)==null?void 0:b.offsetHeight)||0;c.onCornerHeightChange(m),y(m)}),we(c.scrollbarY,()=>{var b;const m=((b=c.scrollbarY)==null?void 0:b.offsetWidth)||0;c.onCornerWidthChange(m),h(m)}),s?e.jsx(Ee.div,{...i,ref:d,style:{width:f,height:l,position:"absolute",right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:0,...n.style}}):null});function Re(n){return n?parseInt(n,10):0}function ct(n,d){const a=n/d;return isNaN(a)?0:a}function Te(n){const d=ct(n.viewport,n.content),a=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,i=(n.scrollbar.size-a)*d;return Math.max(i,18)}function Bt(n,d,a,i="ltr"){const c=Te(a),f=c/2,h=d||f,l=c-h,y=a.scrollbar.paddingStart+h,s=a.scrollbar.size-a.scrollbar.paddingEnd-l,m=a.content-a.viewport,b=i==="ltr"?[0,m]:[m*-1,0];return dt([y,s],b)(n)}function Ke(n,d,a="ltr"){const i=Te(d),c=d.scrollbar.paddingStart+d.scrollbar.paddingEnd,f=d.scrollbar.size-c,h=d.content-d.viewport,l=f-i,y=a==="ltr"?[0,h]:[h*-1,0],s=_t(n,y);return dt([0,h],[0,l])(s)}function dt(n,d){return a=>{if(n[0]===n[1]||d[0]===d[1])return d[0];const i=(d[1]-d[0])/(n[1]-n[0]);return d[0]+i*(a-n[0])}}function ut(n,d){return n>0&&n<d}var Vt=(n,d=()=>{})=>{let a={left:n.scrollLeft,top:n.scrollTop},i=0;return(function c(){const f={left:n.scrollLeft,top:n.scrollTop},h=a.left!==f.left,l=a.top!==f.top;(h||l)&&d(),a=f,i=window.requestAnimationFrame(c)})(),()=>window.cancelAnimationFrame(i)};function Ae(n,d){const a=xe(n),i=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(i.current),[]),x.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(a,d)},[a,d])}function we(n,d){const a=xe(d);wt(()=>{let i=0;if(n){const c=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(a)});return c.observe(n),()=>{window.cancelAnimationFrame(i),c.unobserve(n)}}},[n,a])}var Wt=et,Ht=rt,qt=lt;function Me({className:n,children:d,...a}){return e.jsxs(Wt,{"data-slot":"scroll-area",className:Ge("relative",n),...a,children:[e.jsx(Ht,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:d}),e.jsx($t,{}),e.jsx(qt,{})]})}function $t({className:n,orientation:d="vertical",...a}){return e.jsx(st,{"data-slot":"scroll-area-scrollbar",orientation:d,className:Ge("flex touch-none p-px transition-colors select-none",d==="vertical"&&"h-full w-2.5 border-l border-l-transparent",d==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",n),...a,children:e.jsx(ot,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var Ne={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Xt=Ne.exports,Qe;function Yt(){return Qe||(Qe=1,(function(n,d){((a,i)=>{n.exports=i()})(Xt,function a(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},c,f=!i.document&&!!i.postMessage,h=i.IS_PAPA_WORKER||!1,l={},y=0,s={};function m(r){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var o=se(t);o.chunkSize=parseInt(o.chunkSize),t.step||t.chunk||(o.chunkSize=null),this._handle=new I(o),(this._handle.streamer=this)._config=o}).call(this,r),this.parseChunk=function(t,o){var p=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<p){let u=this._config.newline;u||(g=this._config.quoteChar||'"',u=this._handle.guessLineEndings(t,g)),t=[...t.split(u).slice(p)].join(u)}this.isFirstChunk&&L(this._config.beforeFirstChunk)&&(g=this._config.beforeFirstChunk(t))!==void 0&&(t=g),this.isFirstChunk=!1,this._halted=!1;var p=this._partialLine+t,g=(this._partialLine="",this._handle.parse(p,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=g.meta.cursor,p=(this._finished||(this._partialLine=p.substring(t-this._baseIndex),this._baseIndex=t),g&&g.data&&(this._rowCount+=g.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),h)i.postMessage({results:g,workerId:s.WORKER_ID,finished:p});else if(L(this._config.chunk)&&!o){if(this._config.chunk(g,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=g=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(g.data),this._completeResults.errors=this._completeResults.errors.concat(g.errors),this._completeResults.meta=g.meta),this._completed||!p||!L(this._config.complete)||g&&g.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),p||g&&g.meta.paused||this._nextChunk(),g}this._halted=!0},this._sendError=function(t){L(this._config.error)?this._config.error(t):h&&this._config.error&&i.postMessage({workerId:s.WORKER_ID,error:t,finished:!1})}}function b(r){var t;(r=r||{}).chunkSize||(r.chunkSize=s.RemoteChunkSize),m.call(this,r),this._nextChunk=f?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(o){this._input=o,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),f||(t.onload=Z(this._chunkLoaded,this),t.onerror=Z(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!f),this._config.downloadRequestHeaders){var o,p=this._config.downloadRequestHeaders;for(o in p)t.setRequestHeader(o,p[o])}var g;this._config.chunkSize&&(g=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+g));try{t.send(this._config.downloadRequestBody)}catch(u){this._chunkError(u.message)}f&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(o=>(o=o.getResponseHeader("Content-Range"))!==null?parseInt(o.substring(o.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(o){o=t.statusText||o,this._sendError(new Error(o))}}function _(r){(r=r||{}).chunkSize||(r.chunkSize=s.LocalChunkSize),m.call(this,r);var t,o,p=typeof FileReader<"u";this.stream=function(g){this._input=g,o=g.slice||g.webkitSlice||g.mozSlice,p?((t=new FileReader).onload=Z(this._chunkLoaded,this),t.onerror=Z(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var g=this._input,u=(this._config.chunkSize&&(u=Math.min(this._start+this._config.chunkSize,this._input.size),g=o.call(g,this._start,u)),t.readAsText(g,this._config.encoding));p||this._chunkLoaded({target:{result:u}})},this._chunkLoaded=function(g){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(g.target.result)},this._chunkError=function(){this._sendError(t.error)}}function R(r){var t;m.call(this,r=r||{}),this.stream=function(o){return t=o,this._nextChunk()},this._nextChunk=function(){var o,p;if(!this._finished)return o=this._config.chunkSize,t=o?(p=t.substring(0,o),t.substring(o)):(p=t,""),this._finished=!t,this.parseChunk(p)}}function U(r){m.call(this,r=r||{});var t=[],o=!0,p=!1;this.pause=function(){m.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){m.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(g){this._input=g,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){p&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):o=!0},this._streamData=Z(function(g){try{t.push(typeof g=="string"?g:g.toString(this._config.encoding)),o&&(o=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(u){this._streamError(u)}},this),this._streamError=Z(function(g){this._streamCleanUp(),this._sendError(g)},this),this._streamEnd=Z(function(){this._streamCleanUp(),p=!0,this._streamData("")},this),this._streamCleanUp=Z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function I(r){var t,o,p,g,u=Math.pow(2,53),E=-u,F=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,M=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,w=this,N=0,S=0,B=!1,j=!1,P=[],v={data:[],errors:[],meta:{}};function Y(T){return r.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function $(){if(v&&p&&(ne("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),p=!1),r.skipEmptyLines&&(v.data=v.data.filter(function(C){return!Y(C)})),J()){let C=function(q,K){L(r.transformHeader)&&(q=r.transformHeader(q,K)),P.push(q)};if(v)if(Array.isArray(v.data[0])){for(var T=0;J()&&T<v.data.length;T++)v.data[T].forEach(C);v.data.splice(0,1)}else v.data.forEach(C)}function D(C,q){for(var K=r.header?{}:[],O=0;O<C.length;O++){var z=O,A=C[O],A=((ie,k)=>(V=>(r.dynamicTypingFunction&&r.dynamicTyping[V]===void 0&&(r.dynamicTyping[V]=r.dynamicTypingFunction(V)),(r.dynamicTyping[V]||r.dynamicTyping)===!0))(ie)?k==="true"||k==="TRUE"||k!=="false"&&k!=="FALSE"&&((V=>{if(F.test(V)&&(V=parseFloat(V),E<V&&V<u))return 1})(k)?parseFloat(k):M.test(k)?new Date(k):k===""?null:k):k)(z=r.header?O>=P.length?"__parsed_extra":P[O]:z,A=r.transform?r.transform(A,z):A);z==="__parsed_extra"?(K[z]=K[z]||[],K[z].push(A)):K[z]=A}return r.header&&(O>P.length?ne("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+O,S+q):O<P.length&&ne("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+O,S+q)),K}var H;v&&(r.header||r.dynamicTyping||r.transform)&&(H=1,!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(D),H=v.data.length):v.data=D(v.data,0),r.header&&v.meta&&(v.meta.fields=P),S+=H)}function J(){return r.header&&P.length===0}function ne(T,D,H,C){T={type:T,code:D,message:H},C!==void 0&&(T.row=C),v.errors.push(T)}L(r.step)&&(g=r.step,r.step=function(T){v=T,J()?$():($(),v.data.length!==0&&(N+=T.data.length,r.preview&&N>r.preview?o.abort():(v.data=v.data[0],g(v,w))))}),this.parse=function(T,D,H){var C=r.quoteChar||'"',C=(r.newline||(r.newline=this.guessLineEndings(T,C)),p=!1,r.delimiter?L(r.delimiter)&&(r.delimiter=r.delimiter(T),v.meta.delimiter=r.delimiter):((C=((q,K,O,z,A)=>{var ie,k,V,pe;A=A||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var ve=0;ve<A.length;ve++){for(var le,_e=A[ve],ee=0,ce=0,Q=0,te=(V=void 0,new W({comments:z,delimiter:_e,newline:K,preview:10}).parse(q)),fe=0;fe<te.data.length;fe++)O&&Y(te.data[fe])?Q++:(le=te.data[fe].length,ce+=le,V===void 0?V=le:0<le&&(ee+=Math.abs(le-V),V=le));0<te.data.length&&(ce/=te.data.length-Q),(k===void 0||ee<=k)&&(pe===void 0||pe<ce)&&1.99<ce&&(k=ee,ie=_e,pe=ce)}return{successful:!!(r.delimiter=ie),bestDelimiter:ie}})(T,r.newline,r.skipEmptyLines,r.comments,r.delimitersToGuess)).successful?r.delimiter=C.bestDelimiter:(p=!0,r.delimiter=s.DefaultDelimiter),v.meta.delimiter=r.delimiter),se(r));return r.preview&&r.header&&C.preview++,t=T,o=new W(C),v=o.parse(t,D,H),$(),B?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return B},this.pause=function(){B=!0,o.abort(),t=L(r.chunk)?"":t.substring(o.getCharIndex())},this.resume=function(){w.streamer._halted?(B=!1,w.streamer.parseChunk(t,!0)):setTimeout(w.resume,3)},this.aborted=function(){return j},this.abort=function(){j=!0,o.abort(),v.meta.aborted=!0,L(r.complete)&&r.complete(v),t=""},this.guessLineEndings=function(q,C){q=q.substring(0,1048576);var C=new RegExp(X(C)+"([^]*?)"+X(C),"gm"),H=(q=q.replace(C,"")).split("\r"),C=q.split(`
`),q=1<C.length&&C[0].length<H[0].length;if(H.length===1||q)return`
`;for(var K=0,O=0;O<H.length;O++)H[O][0]===`
`&&K++;return K>=H.length/2?`\r
`:"\r"}}function X(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function W(r){var t=(r=r||{}).delimiter,o=r.newline,p=r.comments,g=r.step,u=r.preview,E=r.fastMode,F=null,M=!1,w=r.quoteChar==null?'"':r.quoteChar,N=w;if(r.escapeChar!==void 0&&(N=r.escapeChar),(typeof t!="string"||-1<s.BAD_DELIMITERS.indexOf(t))&&(t=","),p===t)throw new Error("Comment character same as delimiter");p===!0?p="#":(typeof p!="string"||-1<s.BAD_DELIMITERS.indexOf(p))&&(p=!1),o!==`
`&&o!=="\r"&&o!==`\r
`&&(o=`
`);var S=0,B=!1;this.parse=function(j,P,v){if(typeof j!="string")throw new Error("Input must be a string");var Y=j.length,$=t.length,J=o.length,ne=p.length,T=L(g),D=[],H=[],C=[],q=S=0;if(!j)return ee();if(E||E!==!1&&j.indexOf(w)===-1){for(var K=j.split(o),O=0;O<K.length;O++){if(C=K[O],S+=C.length,O!==K.length-1)S+=o.length;else if(v)return ee();if(!p||C.substring(0,ne)!==p){if(T){if(D=[],pe(C.split(t)),ce(),B)return ee()}else pe(C.split(t));if(u&&u<=O)return D=D.slice(0,u),ee(!0)}}return ee()}for(var z=j.indexOf(t,S),A=j.indexOf(o,S),ie=new RegExp(X(N)+X(w),"g"),k=j.indexOf(w,S);;)if(j[S]===w)for(k=S,S++;;){if((k=j.indexOf(w,k+1))===-1)return v||H.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:D.length,index:S}),le();if(k===Y-1)return le(j.substring(S,k).replace(ie,w));if(w===N&&j[k+1]===N)k++;else if(w===N||k===0||j[k-1]!==N){z!==-1&&z<k+1&&(z=j.indexOf(t,k+1));var V=ve((A=A!==-1&&A<k+1?j.indexOf(o,k+1):A)===-1?z:Math.min(z,A));if(j.substr(k+1+V,$)===t){C.push(j.substring(S,k).replace(ie,w)),j[S=k+1+V+$]!==w&&(k=j.indexOf(w,S)),z=j.indexOf(t,S),A=j.indexOf(o,S);break}if(V=ve(A),j.substring(k+1+V,k+1+V+J)===o){if(C.push(j.substring(S,k).replace(ie,w)),_e(k+1+V+J),z=j.indexOf(t,S),k=j.indexOf(w,S),T&&(ce(),B))return ee();if(u&&D.length>=u)return ee(!0);break}H.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:D.length,index:S}),k++}}else if(p&&C.length===0&&j.substring(S,S+ne)===p){if(A===-1)return ee();S=A+J,A=j.indexOf(o,S),z=j.indexOf(t,S)}else if(z!==-1&&(z<A||A===-1))C.push(j.substring(S,z)),S=z+$,z=j.indexOf(t,S);else{if(A===-1)break;if(C.push(j.substring(S,A)),_e(A+J),T&&(ce(),B))return ee();if(u&&D.length>=u)return ee(!0)}return le();function pe(Q){D.push(Q),q=S}function ve(Q){var te=0;return te=Q!==-1&&(Q=j.substring(k+1,Q))&&Q.trim()===""?Q.length:te}function le(Q){return v||(Q===void 0&&(Q=j.substring(S)),C.push(Q),S=Y,pe(C),T&&ce()),ee()}function _e(Q){S=Q,pe(C),C=[],A=j.indexOf(o,S)}function ee(Q){if(r.header&&!P&&D.length&&!M){var te=D[0],fe=Object.create(null),Le=new Set(te);let We=!1;for(let ye=0;ye<te.length;ye++){let de=te[ye];if(fe[de=L(r.transformHeader)?r.transformHeader(de,ye):de]){let je,He=fe[de];for(;je=de+"_"+He,He++,Le.has(je););Le.add(je),te[ye]=je,fe[de]++,We=!0,(F=F===null?{}:F)[je]=de}else fe[de]=1,te[ye]=de;Le.add(de)}We&&console.warn("Duplicate headers found and renamed."),M=!0}return{data:D,errors:H,meta:{delimiter:t,linebreak:o,aborted:B,truncated:!!Q,cursor:q+(P||0),renamedHeaders:F}}}function ce(){g(ee()),D=[],H=[]}},this.abort=function(){B=!0},this.getCharIndex=function(){return S}}function G(r){var t=r.data,o=l[t.workerId],p=!1;if(t.error)o.userError(t.error,t.file);else if(t.results&&t.results.data){var g={abort:function(){p=!0,he(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:re,resume:re};if(L(o.userStep)){for(var u=0;u<t.results.data.length&&(o.userStep({data:t.results.data[u],errors:t.results.errors,meta:t.results.meta},g),!p);u++);delete t.results}else L(o.userChunk)&&(o.userChunk(t.results,g,t.file),delete t.results)}t.finished&&!p&&he(t.workerId,t.results)}function he(r,t){var o=l[r];L(o.userComplete)&&o.userComplete(t),o.terminate(),delete l[r]}function re(){throw new Error("Not implemented.")}function se(r){if(typeof r!="object"||r===null)return r;var t,o=Array.isArray(r)?[]:{};for(t in r)o[t]=se(r[t]);return o}function Z(r,t){return function(){r.apply(t,arguments)}}function L(r){return typeof r=="function"}return s.parse=function(r,t){var o=(t=t||{}).dynamicTyping||!1;if(L(o)&&(t.dynamicTypingFunction=o,o={}),t.dynamicTyping=o,t.transform=!!L(t.transform)&&t.transform,!t.worker||!s.WORKERS_SUPPORTED)return o=null,s.NODE_STREAM_INPUT,typeof r=="string"?(r=(p=>p.charCodeAt(0)!==65279?p:p.slice(1))(r),o=new(t.download?b:R)(t)):r.readable===!0&&L(r.read)&&L(r.on)?o=new U(t):(i.File&&r instanceof File||r instanceof Object)&&(o=new _(t)),o.stream(r);(o=(()=>{var p;return!!s.WORKERS_SUPPORTED&&(p=(()=>{var g=i.URL||i.webkitURL||null,u=a.toString();return s.BLOB_URL||(s.BLOB_URL=g.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",u,")();"],{type:"text/javascript"})))})(),(p=new i.Worker(p)).onmessage=G,p.id=y++,l[p.id]=p)})()).userStep=t.step,o.userChunk=t.chunk,o.userComplete=t.complete,o.userError=t.error,t.step=L(t.step),t.chunk=L(t.chunk),t.complete=L(t.complete),t.error=L(t.error),delete t.worker,o.postMessage({input:r,config:t,workerId:o.id})},s.unparse=function(r,t){var o=!1,p=!0,g=",",u=`\r
`,E='"',F=E+E,M=!1,w=null,N=!1,S=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||s.BAD_DELIMITERS.filter(function(P){return t.delimiter.indexOf(P)!==-1}).length||(g=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(o=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(M=t.skipEmptyLines),typeof t.newline=="string"&&(u=t.newline),typeof t.quoteChar=="string"&&(E=t.quoteChar),typeof t.header=="boolean"&&(p=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");w=t.columns}t.escapeChar!==void 0&&(F=t.escapeChar+E),t.escapeFormulae instanceof RegExp?N=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(N=/^[=+\-@\t\r].*$/)}})(),new RegExp(X(E),"g"));if(typeof r=="string"&&(r=JSON.parse(r)),Array.isArray(r)){if(!r.length||Array.isArray(r[0]))return B(null,r,M);if(typeof r[0]=="object")return B(w||Object.keys(r[0]),r,M)}else if(typeof r=="object")return typeof r.data=="string"&&(r.data=JSON.parse(r.data)),Array.isArray(r.data)&&(r.fields||(r.fields=r.meta&&r.meta.fields||w),r.fields||(r.fields=Array.isArray(r.data[0])?r.fields:typeof r.data[0]=="object"?Object.keys(r.data[0]):[]),Array.isArray(r.data[0])||typeof r.data[0]=="object"||(r.data=[r.data])),B(r.fields||[],r.data||[],M);throw new Error("Unable to serialize unrecognized input");function B(P,v,Y){var $="",J=(typeof P=="string"&&(P=JSON.parse(P)),typeof v=="string"&&(v=JSON.parse(v)),Array.isArray(P)&&0<P.length),ne=!Array.isArray(v[0]);if(J&&p){for(var T=0;T<P.length;T++)0<T&&($+=g),$+=j(P[T],T);0<v.length&&($+=u)}for(var D=0;D<v.length;D++){var H=(J?P:v[D]).length,C=!1,q=J?Object.keys(v[D]).length===0:v[D].length===0;if(Y&&!J&&(C=Y==="greedy"?v[D].join("").trim()==="":v[D].length===1&&v[D][0].length===0),Y==="greedy"&&J){for(var K=[],O=0;O<H;O++){var z=ne?P[O]:O;K.push(v[D][z])}C=K.join("").trim()===""}if(!C){for(var A=0;A<H;A++){0<A&&!q&&($+=g);var ie=J&&ne?P[A]:A;$+=j(v[D][ie],A)}D<v.length-1&&(!Y||0<H&&!q)&&($+=u)}}return $}function j(P,v){var Y,$;return P==null?"":P.constructor===Date?JSON.stringify(P).slice(1,25):($=!1,N&&typeof P=="string"&&N.test(P)&&(P="'"+P,$=!0),Y=P.toString().replace(S,F),($=$||o===!0||typeof o=="function"&&o(P,v)||Array.isArray(o)&&o[v]||((J,ne)=>{for(var T=0;T<ne.length;T++)if(-1<J.indexOf(ne[T]))return!0;return!1})(Y,s.BAD_DELIMITERS)||-1<Y.indexOf(g)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?E+Y+E:Y)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!f&&!!i.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=W,s.ParserHandle=I,s.NetworkStreamer=b,s.FileStreamer=_,s.StringStreamer=R,s.ReadableStreamStreamer=U,i.jQuery&&((c=i.jQuery).fn.parse=function(r){var t=r.config||{},o=[];return this.each(function(u){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var E=0;E<this.files.length;E++)o.push({file:this.files[E],inputElem:this,instanceConfig:c.extend({},t)})}),p(),this;function p(){if(o.length===0)L(r.complete)&&r.complete();else{var u,E,F,M,w=o[0];if(L(r.before)){var N=r.before(w.file,w.inputElem);if(typeof N=="object"){if(N.action==="abort")return u="AbortError",E=w.file,F=w.inputElem,M=N.reason,void(L(r.error)&&r.error({name:u},E,F,M));if(N.action==="skip")return void g();typeof N.config=="object"&&(w.instanceConfig=c.extend(w.instanceConfig,N.config))}else if(N==="skip")return void g()}var S=w.instanceConfig.complete;w.instanceConfig.complete=function(B){L(S)&&S(B,w.file,w.inputElem),g()},s.parse(w.file,w.instanceConfig)}}function g(){o.splice(0,1),p()}}),h&&(i.onmessage=function(r){r=r.data,s.WORKER_ID===void 0&&r&&(s.WORKER_ID=r.workerId),typeof r.input=="string"?i.postMessage({workerId:s.WORKER_ID,results:s.parse(r.input,r.config),finished:!0}):(i.File&&r.input instanceof File||r.input instanceof Object)&&(r=s.parse(r.input,r.config))&&i.postMessage({workerId:s.WORKER_ID,results:r,finished:!0})}),(b.prototype=Object.create(m.prototype)).constructor=b,(_.prototype=Object.create(m.prototype)).constructor=_,(R.prototype=Object.create(R.prototype)).constructor=R,(U.prototype=Object.create(m.prototype)).constructor=U,s})})(Ne)),Ne.exports}var Kt=Yt();const Ve=pt(Kt),ht={name:["name","product_name","gift_name","title"],description:["description","desc","short_description"],longDescription:["long_description","detailed_description","full_description"],category:["category","type","product_type","gift_category"],value:["value","price","amount","gift_value"],retailValue:["retail_value","retail_price","msrp","original_price"],imageUrl:["image_url","image","photo","picture_url"],features:["features","highlights","key_features"],specifications:["specifications","specs","details"],status:["status","product_status","state"],available:["available","is_available","in_stock"],inventoryStatus:["inventory_status","stock_status","availability"],priority:["priority","sort_order","display_order"],quantityLimit:["quantity_limit","max_quantity","limit"],sku:["sku","product_code","item_code"],tags:["tags","labels","keywords"]},Je=["name","category","value"];async function Qt(n){return new Promise((d,a)=>{Ve.parse(n,{header:!0,skipEmptyLines:!0,transformHeader:i=>i.trim().toLowerCase().replace(/\s+/g,"_"),complete:i=>{i.errors.length>0?a(new Error(`CSV parsing errors: ${i.errors.map(c=>c.message).join(", ")}`)):d(i.data)},error:i=>{a(i instanceof Error?i:new Error(String(i)))}})})}async function Jt(n){return new Promise((d,a)=>{Ve.parse(n,{header:!0,skipEmptyLines:!0,delimiter:"|",transformHeader:i=>i.trim().toLowerCase().replace(/\s+/g,"_"),complete:i=>{i.errors.length>0?a(new Error(`Pipe-delimited file parsing errors: ${i.errors.map(c=>c.message).join(", ")}`)):d(i.data)},error:i=>{a(i instanceof Error?i:new Error(String(i)))}})})}async function Gt(n){return new Promise((d,a)=>{const i=new FileReader;i.onload=async c=>{var f;try{const h=(f=c.target)==null?void 0:f.result,l=new jt.Workbook;await l.xlsx.load(h);const y=l.getWorksheet(1);if(!y){a(new Error("No worksheet found in Excel file"));return}const s=[],m=[];y.getRow(1).eachCell((I,X)=>{m[X-1]=String(I.value||"")}),y.eachRow((I,X)=>{if(X===1)return;const W={};I.eachCell((G,he)=>{const re=m[he-1];re&&(W[re]=G.value)}),Object.keys(W).length>0&&s.push(W)});const _=Ct(s),R=Et(n,_,{maxSizeMB:10,allowedExtensions:[".xlsx",".xls"],maxRows:5e4,maxCellLength:5e3});if(!R.isValid){a(new Error(`Security validation failed: ${R.errors.join(", ")}`));return}R.warnings.length>0&&console.warn("File security warnings:",R.warnings);const U=_.map(I=>{const X={};return Object.keys(I).forEach(W=>{const G=W.trim().toLowerCase().replace(/\s+/g,"_");X[G]=I[W]}),X});d(U)}catch(h){a(h instanceof Error?h:new Error(String(h)))}},i.onerror=()=>{a(new Error("Failed to read file"))},i.readAsArrayBuffer(n)})}function Zt(n){const d={};return Object.entries(ht).forEach(([a,i])=>{const c=n.find(f=>i.includes(f.toLowerCase().trim()));c&&(d[a]=c)}),d}function er(n,d){const a=[],i=[];return n.forEach((c,f)=>{const h=f+2,l={};if(Object.entries(d).forEach(([s,m])=>{c[m]!==void 0&&c[m]!==""&&(l[s]=c[m])}),Je.forEach(s=>{l[s]||a.push({row:h,field:s,value:l[s],message:`${s} is required`})}),l.name&&l.name.length<2&&a.push({row:h,field:"name",value:l.name,message:"Name must be at least 2 characters"}),l.name&&l.name.length>200&&a.push({row:h,field:"name",value:l.name,message:"Name must be less than 200 characters"}),l.value!==void 0){const s=parseFloat(String(l.value).replace(/[^0-9.-]/g,""));isNaN(s)||s<0?a.push({row:h,field:"value",value:l.value,message:"Value must be a positive number"}):l.value=s}if(l.retailValue!==void 0&&String(l.retailValue)!==""){const s=parseFloat(String(l.retailValue).replace(/[^0-9.-]/g,""));isNaN(s)||s<0?a.push({row:h,field:"retailValue",value:l.retailValue,message:"Retail value must be a positive number"}):l.retailValue=s}if(l.priority!==void 0&&String(l.priority)!==""){const s=parseInt(String(l.priority));isNaN(s)?a.push({row:h,field:"priority",value:l.priority,message:"Priority must be a number"}):l.priority=s}if(l.quantityLimit!==void 0&&String(l.quantityLimit)!==""){const s=parseInt(String(l.quantityLimit));isNaN(s)||s<1?a.push({row:h,field:"quantityLimit",value:l.quantityLimit,message:"Quantity limit must be a positive number"}):l.quantityLimit=s}if(l.status){const s=["active","inactive","discontinued"],m=String(l.status).toLowerCase();s.includes(m)?l.status=m:a.push({row:h,field:"status",value:l.status,message:`Status must be one of: ${s.join(", ")}`})}else l.status="active";if(l.available!==void 0){const s=String(l.available).toLowerCase();["true","1","yes","y"].includes(s)?l.available=!0:["false","0","no","n"].includes(s)?l.available=!1:a.push({row:h,field:"available",value:l.available,message:"Available must be true/false or yes/no"})}else l.available=!0;if(l.inventoryStatus){const s=["in_stock","low_stock","out_of_stock","pre_order"],m=String(l.inventoryStatus).toLowerCase().replace(/\s+/g,"_");s.includes(m)?l.inventoryStatus=m:a.push({row:h,field:"inventoryStatus",value:l.inventoryStatus,message:`Inventory status must be one of: ${s.join(", ")}`})}else l.inventoryStatus="in_stock";if(l.imageUrl&&l.imageUrl.trim())try{new URL(l.imageUrl)}catch{a.push({row:h,field:"imageUrl",value:l.imageUrl,message:"Image URL must be a valid URL"})}const y=a.filter(s=>s.row===h);(y.length===0||!y.some(s=>Je.includes(s.field)))&&i.push(l)}),{success:a.length===0,totalRows:n.length,successCount:i.length,errorCount:a.length,errors:a,data:i}}function tr(){const n=["name","description","long_description","category","value","retail_value","image_url","features","specifications","status","available","inventory_status","priority","quantity_limit","sku","tags"],d=[["Premium Headphones","High-quality wireless headphones","Experience superior sound quality with these premium wireless headphones featuring noise cancellation and 30-hour battery life.","Electronics","299.99","399.99","https://example.com/headphones.jpg","Noise Cancellation|30hr Battery|Wireless","Color: Black|Weight: 250g|Bluetooth: 5.0","active","true","in_stock","1","5","HDN-001","electronics,audio,wireless"],["Yoga Mat","Eco-friendly yoga mat","Non-slip yoga mat made from sustainable materials, perfect for all types of yoga practice.","Sports & Fitness","45.00","59.99","https://example.com/yoga-mat.jpg","Non-slip|Eco-friendly|6mm Thick","Material: TPE|Size: 72x24 inches|Thickness: 6mm","active","yes","in_stock","2","","YM-002","fitness,yoga,wellness"]];return Ve.unparse({fields:n,data:d})}function rr(){const n=tr(),d=new Blob([n],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),i=URL.createObjectURL(d);a.setAttribute("href",i),a.setAttribute("download","product_import_template.csv"),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function jr(){const n=mt(),{accessToken:d}=gt(),a=x.useRef(null),[i,c]=x.useState("upload"),[f,h]=x.useState(null),[l,y]=x.useState([]),[s,m]=x.useState({}),[b,_]=x.useState(null),[R,U]=x.useState({total:0,successful:0,failed:0,errors:[]}),[I,X]=x.useState(null),[W,G]=x.useState(!1),[he,re]=x.useState(!1),[se,Z]=x.useState(""),L=async u=>{var M,w;const E=(M=u.target.files)==null?void 0:M[0];if(!E)return;const F=(w=E.name.split(".").pop())==null?void 0:w.toLowerCase();if(!["csv","xlsx","xls","txt"].includes(F||"")){oe.error("Invalid file type. Please upload a CSV, Excel, or Pipe Delimited file.");return}h(E),G(!0);try{let N;if(F==="csv"?N=await Qt(E):F==="txt"?N=await Jt(E):N=await Gt(E),N.length===0){oe.error("File is empty"),G(!1);return}y(N);const S=Object.keys(N[0]),B=Zt(S);m(B),oe.success(`File loaded successfully. ${N.length} rows found.`),c("mapping")}catch(N){console.error("File parsing error:",N),oe.error(`Failed to parse file: ${N instanceof Error?N.message:"Unknown error"}`)}finally{G(!1)}},r=(u,E)=>{m(F=>({...F,[u]:E}))},t=()=>{G(!0);try{const u=er(l,s);_(u),u.success?oe.success(`Validation successful! ${u.successCount} products ready to import.`):oe.error(`Validation found ${u.errorCount} errors.`),c("preview")}catch(u){oe.error(`Validation failed: ${u instanceof Error?u.message:"Unknown error"}`)}finally{G(!1)}},o=async()=>{if(!b||!se){oe.error("Please select a site to import products to");return}c("importing"),U({total:0,successful:0,failed:0,errors:[]}),re(!0);try{const u=bt(),E=b.data,F=10;let M=0,w=0;const N=[];for(let S=0;S<E.length;S+=F){const B=E.slice(S,S+F);try{const j=u.supabaseUrl.replace("https://","").split(".")[0],P=await fetch(`https://${j}.supabase.co/functions/v1/make-server-6fcaeea3/admin/products/bulk-import`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u.supabaseAnonKey}`,"X-Access-Token":d||"","X-Environment-ID":u.id},body:JSON.stringify({siteId:se,products:B})}),v=await P.json();P.ok?M+=v.successful||B.length:(w+=B.length,N.push({row:S+1,message:v.error||"Failed to import batch"}))}catch(j){w+=B.length,N.push({row:S+1,message:j instanceof Error?j.message:"Unknown error"})}U({total:E.length,successful:M,failed:w,errors:N})}X({successful:M,failed:w,errors:N}),c("complete"),w===0?oe.success(`Successfully imported ${M} products!`):oe.warning(`Imported ${M} products, ${w} failed.`)}catch(u){oe.error(`Import failed: ${u instanceof Error?u.message:"Unknown error"}`),c("preview")}finally{re(!1)}},p=()=>{h(null),y([]),m({}),_(null),U({total:0,successful:0,failed:0,errors:[]}),X(null),c("upload"),a.current&&(a.current.value="")},g=()=>l.length===0?[]:Object.keys(l[0]);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(me,{variant:"ghost",size:"sm",onClick:()=>n("/admin/gifts"),children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Back to Products"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bulk Product Import"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Import products from CSV or Excel files"})]})]}),e.jsxs(me,{variant:"outline",size:"sm",onClick:rr,children:[e.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Download Template"]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"flex items-center justify-between",children:[{key:"upload",label:"Upload File",icon:qe},{key:"mapping",label:"Map Fields",icon:xt},{key:"preview",label:"Preview & Validate",icon:kt},{key:"importing",label:"Import",icon:Oe},{key:"complete",label:"Complete",icon:Ce}].map((u,E,F)=>{const M=i===u.key,w=F.findIndex(S=>S.key===i)>E,N=u.icon;return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`
                      w-10 h-10 rounded-full flex items-center justify-center
                      ${M?"bg-[#D91C81] text-white":w?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}
                    `,children:e.jsx(N,{className:"w-5 h-5"})}),e.jsx("span",{className:`text-sm font-medium ${M?"text-[#D91C81]":w?"text-green-600":"text-gray-500"}`,children:u.label})]}),E<F.length-1&&e.jsx("div",{className:`flex-1 h-1 mx-4 ${w?"bg-green-500":"bg-gray-200"}`})]},u.key)})})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i==="upload"&&e.jsx(ge,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gradient-to-br from-[#D91C81] to-[#B71569] rounded-full flex items-center justify-center mb-6",children:e.jsx(qe,{className:"w-12 h-12 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Upload Product Data"}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-2xl mx-auto",children:"Upload a CSV or Excel file containing your product data. Make sure your file includes required fields: name, category, and value."}),e.jsx("input",{ref:a,type:"file",accept:".csv,.xlsx,.xls,.txt",onChange:L,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"inline-flex items-center gap-2 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-8 py-4 rounded-lg font-semibold cursor-pointer hover:shadow-lg transition-all",children:[e.jsx($e,{className:"w-5 h-5"}),W?"Processing...":"Choose File"]}),f&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg inline-block",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-blue-900",children:f.name}),e.jsxs("p",{className:"text-sm text-blue-600",children:[(f.size/1024).toFixed(2)," KB"]})]})]})}),e.jsxs("div",{className:"mt-12 grid md:grid-cols-3 gap-6 text-left",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx($e,{className:"w-8 h-8 text-[#D91C81] mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Supported Formats"}),e.jsx("p",{className:"text-sm text-gray-600",children:"CSV, XLSX, XLS, TXT files"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx(Ce,{className:"w-8 h-8 text-green-600 mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Auto-Mapping"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automatically detects column headers"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx(Fe,{className:"w-8 h-8 text-[#00B4CC] mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Validation"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Validates data before importing"})]})]})]})}),i==="mapping"&&e.jsxs(ge,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Map Your Fields"}),e.jsx("p",{className:"text-gray-600",children:"Match your file columns to product fields. Required fields are marked with *"})]}),e.jsx("div",{className:"space-y-4 mb-6",children:Object.entries(ht).map(([u,E])=>{const F=["name","category","value"].includes(u),M=s[u];return e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 items-center p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"font-medium text-gray-900",children:[u.replace(/([A-Z])/g," $1").trim(),F&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Suggested: ",E.join(", ")]})]}),e.jsxs("select",{value:M||"",onChange:w=>r(u,w.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"",children:"-- Not Mapped --"}),g().map(w=>e.jsx("option",{value:w,children:w},w))]})]},u)})}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200",children:[e.jsx(me,{variant:"outline",onClick:p,children:"Cancel"}),e.jsx(me,{onClick:t,disabled:!s.name||!s.category||!s.value||W,className:"bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white",children:W?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"w-4 h-4 mr-2 animate-spin"}),"Validating..."]}):e.jsxs(e.Fragment,{children:["Continue to Preview",e.jsx(De,{className:"w-4 h-4 ml-2 rotate-180"})]})})]})]}),i==="preview"&&b&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ge,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(Tt,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:b.totalRows}),e.jsx("p",{className:"text-sm text-blue-600",children:"Total Rows"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(Ce,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:b.successCount}),e.jsx("p",{className:"text-sm text-green-600",children:"Valid Products"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx(Ye,{className:"w-8 h-8 text-red-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:b.errorCount}),e.jsx("p",{className:"text-sm text-red-600",children:"Errors Found"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx(Oe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:b.success?"Ready":"Review"}),e.jsx("p",{className:"text-sm text-purple-600",children:"Import Status"})]})]})}),b.errors.length>0&&e.jsxs(ge,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-red-500"}),"Validation Errors (",b.errors.length,")"]}),e.jsx(Me,{className:"h-64",children:e.jsxs("div",{className:"space-y-2",children:[b.errors.slice(0,50).map((u,E)=>e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs(Ie,{variant:"destructive",className:"text-xs",children:["Row ",u.row]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:u.field}),e.jsx("p",{className:"text-xs text-red-600",children:u.message}),u.value&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Value: ",String(u.value)]})]})]})},E)),b.errors.length>50&&e.jsxs("p",{className:"text-sm text-gray-600 text-center py-2",children:["... and ",b.errors.length-50," more errors"]})]})})]}),e.jsxs(ge,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:["Data Preview (",b.data.length," products)"]}),e.jsxs(Me,{className:"h-96",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Value"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Inventory"})]})}),e.jsx("tbody",{children:b.data.slice(0,100).map((u,E)=>e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2",children:u.name}),e.jsx("td",{className:"px-4 py-2",children:u.category}),e.jsxs("td",{className:"px-4 py-2",children:["$",u.value.toFixed(2)]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(Ie,{variant:u.status==="active"?"default":"secondary",children:u.status})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(Ie,{variant:u.inventoryStatus==="in_stock"?"default":"secondary",children:u.inventoryStatus})})]},E))})]}),b.data.length>100&&e.jsxs("p",{className:"text-sm text-gray-600 text-center py-4",children:["Showing first 100 of ",b.data.length," products"]})]})]}),e.jsxs(ge,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Select Target Site"}),e.jsxs("select",{value:se,onChange:u=>Z(u.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"",children:"-- Select a Site --"}),e.jsx("option",{value:"site1",children:"Site 1 - Main Catalog"}),e.jsx("option",{value:"site2",children:"Site 2 - Premium Gifts"}),e.jsx("option",{value:"site3",children:"Site 3 - Employee Rewards"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(me,{variant:"outline",onClick:()=>c("mapping"),children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Back to Mapping"]}),e.jsxs(me,{onClick:o,disabled:b.successCount===0||!se,className:"bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white",children:["Import ",b.successCount," Products",e.jsx(Oe,{className:"w-4 h-4 ml-2"})]})]})]}),i==="importing"&&e.jsx(ge,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Xe,{className:"w-16 h-16 text-[#D91C81] mx-auto mb-6 animate-spin"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Importing Products..."}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Please wait while we import your products. This may take a few moments."}),e.jsx(vt,{value:R.successful/R.total*100,className:"mb-4"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[R.successful," of ",R.total," complete"]})]})}),i==="complete"&&I&&e.jsx(ge,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`mx-auto w-24 h-24 rounded-full flex items-center justify-center mb-6 ${I.failed===0?"bg-gradient-to-br from-green-500 to-emerald-600":"bg-gradient-to-br from-yellow-500 to-orange-600"}`,children:I.failed===0?e.jsx(Ce,{className:"w-12 h-12 text-white"}):e.jsx(Fe,{className:"w-12 h-12 text-white"})}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Import ",I.failed===0?"Complete!":"Completed with Errors"]}),e.jsxs("p",{className:"text-gray-600 mb-8",children:[I.successful," products imported successfully",I.failed>0&&`, ${I.failed} failed`]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 max-w-2xl mx-auto mb-8",children:[e.jsxs("div",{className:"p-6 bg-green-50 rounded-lg",children:[e.jsx(Ce,{className:"w-8 h-8 text-green-600 mx-auto mb-3"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:I.successful}),e.jsx("p",{className:"text-sm text-green-600",children:"Successful"})]}),e.jsxs("div",{className:"p-6 bg-red-50 rounded-lg",children:[e.jsx(Ye,{className:"w-8 h-8 text-red-600 mx-auto mb-3"}),e.jsx("p",{className:"text-3xl font-bold text-red-900",children:I.failed}),e.jsx("p",{className:"text-sm text-red-600",children:"Failed"})]})]}),I.errors.length>0&&e.jsxs("div",{className:"mb-8 text-left max-w-2xl mx-auto",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Import Errors:"}),e.jsx(Me,{className:"h-48",children:e.jsx("div",{className:"space-y-2",children:I.errors.map((u,E)=>e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-900",children:[e.jsxs("span",{className:"font-medium",children:["Row ",u.row,":"]})," ",u.message]})},E))})})]}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx(me,{variant:"outline",onClick:p,children:"Import More Products"}),e.jsx(me,{onClick:()=>n("/admin/gifts"),className:"bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white",children:"View Products"})]})]})})]})]})}export{jr as ProductBulkImport};
