import{as as ie,r as o,j as e,C as r,a7 as ne,S as ce,Y as de,t as g}from"./index-DAep3-17.js";import{C as m,d as x}from"./card-D7HVS59i.js";import{I as n}from"./input-E3LMlGJB.js";import{L as a}from"./label-D7rDMfrx.js";import{B as y}from"./badge-CKAfVDe6.js";import{D as P,a as D,b as F,c as B,d as L,e as M}from"./dialog-DxmycFb0.js";import{T as f}from"./textarea-vcSPiHlY.js";import{S as z,a as G,b as A,c as I,d as h}from"./select-Cs6HLM73.js";import{E as U}from"./EmailContentEditor-D365qBQR.js";import{P as q}from"./plus-U3aaopYz.js";import{C as oe}from"./circle-alert-BJpcJige.js";import{F as w}from"./file-text-FCbbDMlz.js";import{M as $}from"./mail-BlQiYOtl.js";import{M as O}from"./message-square-CBRy7rY0.js";import{B as R}from"./bell-D3QIRPHg.js";import{F as me}from"./funnel-Brfssaa5.js";import{C as xe}from"./clock-Cklh_US9.js";import{E as he}from"./eye-BXXJW7Ry.js";import{S as ue}from"./square-pen-Bj3YdsC1.js";import{C as je}from"./copy-CQOI8jQv.js";import{T as pe}from"./trash-2-orf3MXe6.js";import{C as ge}from"./chevron-up-DF2_RBoF.js";import{C as Q}from"./circle-check-big-Dewj6UrC.js";import"./index-GxwXKa5n.js";import"./index-BBIAgE77.js";import"./index-Dxauqy8w.js";import"./index-CH-6Jnw9.js";import"./index-NQBsc09o.js";import"./index-CE6KxwT7.js";import"./index-7D9TSwIG.js";import"./index-BdQq_4o_.js";import"./index-b2qZ5oZ4.js";import"./index-D_kBqr1b.js";import"./index-BxUISvPR.js";import"./index-CcwUd-PA.js";import"./index-C8gtVD-n.js";import"./code-CskcP2fb.js";function ss(){var V,_;const{globalTemplates:u,refreshGlobalTemplates:H,seedGlobalTemplates:Y,isLoadingGlobal:S}=ie(),[v,J]=o.useState(""),[T,K]=o.useState("all"),[W,X]=o.useState(null),[j,k]=o.useState({open:!1,template:null}),[p,b]=o.useState({open:!1,template:null}),[Z,N]=o.useState(!1),[l,c]=o.useState({name:"",description:"",defaultSubject:"",defaultHtmlContent:"",defaultTextContent:"",defaultPushTitle:"",defaultPushBody:"",defaultSmsContent:""}),[t,i]=o.useState({type:"",name:"",description:"",category:"transactional",defaultSubject:"",defaultHtmlContent:"",defaultTextContent:"",defaultPushTitle:"",defaultPushBody:"",defaultSmsContent:"",variables:[]});o.useEffect(()=>{H()},[]);const E=u.filter(s=>{const d=v===""||s.name.toLowerCase().includes(v.toLowerCase())||s.description.toLowerCase().includes(v.toLowerCase())||s.type.toLowerCase().includes(v.toLowerCase()),C=T==="all"||s.category===T;return d&&C}),ee=s=>{k({open:!0,template:s})},se=s=>{b({open:!0,template:s}),c({name:s.name,description:s.description,defaultSubject:s.defaultSubject,defaultHtmlContent:s.defaultHtmlContent,defaultTextContent:s.defaultTextContent,defaultPushTitle:s.defaultPushTitle,defaultPushBody:s.defaultPushBody,defaultSmsContent:s.defaultSmsContent})},te=s=>{g.success(`Template "${s.name}" duplicated`)},ae=s=>{if(s.isSystem){g.error("System templates cannot be deleted");return}g.success(`Template "${s.name}" deleted`)},le=s=>{switch(s){case"transactional":return e.jsx($,{className:"w-4 h-4"});case"marketing":return e.jsx(O,{className:"w-4 h-4"});case"system":return e.jsx(R,{className:"w-4 h-4"});default:return e.jsx(w,{className:"w-4 h-4"})}},re=s=>{switch(s){case"transactional":return"bg-blue-100 text-blue-700";case"marketing":return"bg-purple-100 text-purple-700";case"system":return"bg-gray-100 text-gray-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Global Template Library"}),e.jsx("p",{className:"text-gray-600",children:"Manage master email, SMS, and push notification templates used across all sites"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",onClick:H,disabled:S,className:"hover:bg-gray-50",children:[e.jsx(ne,{className:`w-4 h-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]}),u.length===0&&e.jsxs(r,{onClick:Y,disabled:S,className:"bg-[#D91C81] hover:bg-[#B01566] text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Seed Templates"]})]})]}),e.jsx(m,{className:"border-blue-200 bg-blue-50",children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Global templates"})," are master templates that serve as defaults for all sites. Sites can customize these templates to fit their specific needs, but changes here will update the defaults for new site configurations."]},"info-1"),e.jsxs("p",{className:"text-sm text-gray-600",children:["Templates marked as ",e.jsx(y,{variant:"secondary",className:"text-xs",children:"System"})," are core templates required for platform functionality and cannot be deleted."]},"info-2")]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Templates"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.length})]}),e.jsx(w,{className:"w-8 h-8 text-[#D91C81]"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Transactional"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.filter(s=>s.category==="transactional").length})]}),e.jsx($,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Marketing"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.filter(s=>s.category==="marketing").length})]}),e.jsx(O,{className:"w-8 h-8 text-purple-600"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.filter(s=>s.isSystem).length})]}),e.jsx(R,{className:"w-8 h-8 text-gray-600"})]})})})]}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(n,{placeholder:"Search templates by name, type, or description...",value:v,onChange:s=>J(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"sm:w-48",children:e.jsxs(z,{value:T,onValueChange:K,children:[e.jsxs(G,{children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),e.jsx(A,{placeholder:"Category"})]}),e.jsxs(I,{children:[e.jsx(h,{value:"all",children:"All Categories"}),e.jsx(h,{value:"transactional",children:"Transactional"}),e.jsx(h,{value:"marketing",children:"Marketing"}),e.jsx(h,{value:"system",children:"System"})]})]})}),e.jsxs(r,{className:"bg-[#D91C81] hover:bg-[#B01566] text-white",onClick:()=>N(!0),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"New Template"]})]})})}),e.jsx("div",{className:"space-y-4",children:E.length===0?e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filters"})]})})}):E.map(s=>{const d=W===s.id;return e.jsx(m,{className:"hover:shadow-md transition-shadow",children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs(y,{className:re(s.category),children:[le(s.category),e.jsx("span",{className:"ml-1.5 capitalize",children:s.category})]}),s.isSystem&&e.jsx(y,{variant:"secondary",className:"text-xs",children:"System"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),"Type: ",e.jsx("span",{className:"font-medium",children:s.type})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),"Updated: ",new Date(s.updatedAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>ee(s),className:"hover:bg-gray-50",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>se(s),className:"hover:bg-gray-50",children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>te(s),className:"hover:bg-gray-50",children:e.jsx(je,{className:"w-4 h-4"})}),!s.isSystem&&e.jsx(r,{variant:"outline",size:"sm",onClick:()=>ae(s),className:"hover:bg-red-50 hover:text-red-600 hover:border-red-200",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>X(d?null:s.id),children:d?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(de,{className:"w-4 h-4"})})]})]}),d&&e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Default Subject Line"}),e.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded border",children:s.defaultSubject})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Push Notification"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded border space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Title:"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.defaultPushTitle}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Body:"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.defaultPushBody})]})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"SMS Content"}),e.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded border",children:s.defaultSmsContent})]})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Available Variables"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.variables.map(C=>e.jsx(y,{variant:"outline",className:"text-xs font-mono bg-white",children:`{{${C.key}}}`},C.key))})]})]})]})})},s.id)})}),e.jsx(P,{open:j.open,onOpenChange:s=>k({open:s,template:null}),children:e.jsxs(D,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(F,{children:[e.jsxs(B,{children:["Template Preview: ",(V=j.template)==null?void 0:V.name]}),e.jsx(L,{children:"Preview of the HTML email content. Variables shown with example values."})]}),j.template&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold mb-2 block",children:"Subject Line"}),e.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded border",children:j.template.defaultSubject})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold mb-2 block",children:"HTML Content"}),e.jsx("div",{className:"border rounded p-4 bg-white",dangerouslySetInnerHTML:{__html:j.template.defaultHtmlContent}})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-semibold mb-2 block",children:"Plain Text Version"}),e.jsx("pre",{className:"text-xs bg-gray-50 p-3 rounded border whitespace-pre-wrap",children:j.template.defaultTextContent})]})]}),e.jsx(M,{children:e.jsx(r,{variant:"outline",onClick:()=>k({open:!1,template:null}),children:"Close"})})]})}),e.jsx(P,{open:p.open,onOpenChange:s=>b({open:s,template:null}),children:e.jsxs(D,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(F,{children:[e.jsxs(B,{children:["Edit Template: ",(_=p.template)==null?void 0:_.name]}),e.jsx(L,{children:"Update the master template. Sites using this template can override these defaults."})]}),p.template&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-name",children:"Template Name"}),e.jsx(n,{id:"edit-name",value:l.name,onChange:s=>c({...l,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-type",children:"Type"}),e.jsx(n,{id:"edit-type",defaultValue:p.template.type,disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-description",children:"Description"}),e.jsx(f,{id:"edit-description",value:l.description,onChange:s=>c({...l,description:s.target.value}),rows:2})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-subject",children:"Default Subject Line"}),e.jsx(n,{id:"edit-subject",value:l.defaultSubject,onChange:s=>c({...l,defaultSubject:s.target.value})})]}),e.jsx(U,{content:l.defaultHtmlContent,onChange:s=>c({...l,defaultHtmlContent:s}),label:"HTML Content",availableVariables:p.template.variables.map(s=>s.key)}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-text",children:"Plain Text Content"}),e.jsx(f,{id:"edit-text",value:l.defaultTextContent,onChange:s=>c({...l,defaultTextContent:s.target.value}),rows:4,className:"font-mono text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-push-title",children:"Push Notification Title"}),e.jsx(n,{id:"edit-push-title",value:l.defaultPushTitle,onChange:s=>c({...l,defaultPushTitle:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-push-body",children:"Push Notification Body"}),e.jsx(n,{id:"edit-push-body",value:l.defaultPushBody,onChange:s=>c({...l,defaultPushBody:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-sms",children:"SMS Content"}),e.jsx(f,{id:"edit-sms",value:l.defaultSmsContent,onChange:s=>c({...l,defaultSmsContent:s.target.value}),rows:2})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:e.jsx("strong",{children:"Available Variables:"})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:p.template.variables.map(s=>e.jsx(y,{variant:"outline",className:"text-xs font-mono",children:`{{${s.key}}}`},s.key))})]})]}),e.jsxs(M,{children:[e.jsx(r,{variant:"outline",onClick:()=>b({open:!1,template:null}),children:"Cancel"}),e.jsxs(r,{className:"bg-[#D91C81] hover:bg-[#B01566] text-white",onClick:()=>{g.success("Template updated successfully"),b({open:!1,template:null})},children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(P,{open:Z,onOpenChange:N,children:e.jsxs(D,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(F,{children:[e.jsx(B,{children:"Create New Global Template"}),e.jsx(L,{children:"Create a new master template that can be used across all sites"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-type",children:"Template Type *"}),e.jsx(n,{id:"create-type",value:t.type,onChange:s=>i({...t,type:s.target.value}),placeholder:"e.g., custom_notification"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Unique identifier for this template type"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-category",children:"Category *"}),e.jsxs(z,{value:t.category,onValueChange:s=>i({...t,category:s}),children:[e.jsx(G,{id:"create-category",children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(h,{value:"transactional",children:"Transactional"}),e.jsx(h,{value:"marketing",children:"Marketing"}),e.jsx(h,{value:"system",children:"System"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-name",children:"Template Name *"}),e.jsx(n,{id:"create-name",value:t.name,onChange:s=>i({...t,name:s.target.value}),placeholder:"e.g., Custom Notification Template"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-description",children:"Description *"}),e.jsx(f,{id:"create-description",value:t.description,onChange:s=>i({...t,description:s.target.value}),rows:2,placeholder:"Brief description of when this template is used..."})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-subject",children:"Default Subject Line *"}),e.jsx(n,{id:"create-subject",value:t.defaultSubject,onChange:s=>i({...t,defaultSubject:s.target.value}),placeholder:"e.g., Important Update from {{company_name}}"})]}),e.jsx(U,{content:t.defaultHtmlContent,onChange:s=>i({...t,defaultHtmlContent:s}),label:"HTML Content *",availableVariables:t.variables}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-text",children:"Plain Text Content *"}),e.jsx(f,{id:"create-text",value:t.defaultTextContent,onChange:s=>i({...t,defaultTextContent:s.target.value}),rows:4,className:"font-mono text-xs",placeholder:"Plain text version for email clients that don't support HTML..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-push-title",children:"Push Notification Title"}),e.jsx(n,{id:"create-push-title",value:t.defaultPushTitle,onChange:s=>i({...t,defaultPushTitle:s.target.value}),placeholder:"e.g., New Update Available"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-push-body",children:"Push Notification Body"}),e.jsx(n,{id:"create-push-body",value:t.defaultPushBody,onChange:s=>i({...t,defaultPushBody:s.target.value}),placeholder:"e.g., Check out the latest updates..."})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-sms",children:"SMS Content"}),e.jsx(f,{id:"create-sms",value:t.defaultSmsContent,onChange:s=>i({...t,defaultSmsContent:s.target.value}),rows:2,placeholder:"SMS message (keep it short, 160 characters max)",maxLength:160}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.defaultSmsContent.length,"/160 characters"]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"create-variables",children:"Variables (comma-separated)"}),e.jsx(n,{id:"create-variables",value:t.variables.join(", "),onChange:s=>i({...t,variables:s.target.value.split(",").map(d=>d.trim()).filter(d=>d)}),placeholder:"e.g., recipient_name, company_name, order_id"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["These variables can be used in your content with ","{{"," variable_name ","}}"," syntax"]})]})]}),e.jsxs(M,{children:[e.jsx(r,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsxs(r,{className:"bg-[#D91C81] hover:bg-[#B01566] text-white",onClick:()=>{if(!t.type||!t.name||!t.defaultSubject){g.error("Please fill in all required fields");return}g.success("Template created successfully"),N(!1),i({type:"",name:"",description:"",category:"transactional",defaultSubject:"",defaultHtmlContent:"",defaultTextContent:"",defaultPushTitle:"",defaultPushBody:"",defaultSmsContent:"",variables:[]})},children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Create Template"]})]})]})})]})}export{ss as default};
