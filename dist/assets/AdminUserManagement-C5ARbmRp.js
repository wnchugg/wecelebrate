import{a3 as re,r as n,j as e,S as te,w as h,p as j,l as b}from"./index-dV4Uttrq.js";import{u as le}from"./useDateFormat-DXMDXoB8.js";import{C as E}from"./circle-alert-DNo9lQw-.js";import{P as ie}from"./plus-DUZUgypq.js";import{S as g}from"./shield-C30kT5RY.js";import{E as ne}from"./eye-CnbqyKZE.js";import{S as z}from"./square-pen-BiMIh-Tu.js";import{C as X}from"./circle-check-big-BTbhA0uw.js";import{L}from"./loader-circle-BpaB5MSO.js";import{M as oe}from"./mail-HBGoXm34.js";import{K as de}from"./key-DTxr6Nxn.js";import{T as ce}from"./trash-2-B2VV2ZDP.js";import{C as B}from"./circle-x-CrdKUO8e.js";const f={super_admin:{name:"Super Admin",color:"text-purple-600 bg-purple-100 border-purple-200",icon:g,permissions:["Full system access","Create, edit, delete all sites","Manage admin users and roles","Access all orders and reports","Configure global settings","Manage gift catalog"]},site_manager:{name:"Site Manager",color:"text-blue-600 bg-blue-100 border-blue-200",icon:g,permissions:["Create and manage assigned sites","Configure site settings","Manage site access controls","View and manage orders","Assign products to sites","Cannot manage admin users"]},content_editor:{name:"Content Editor",color:"text-green-600 bg-green-100 border-green-200",icon:z,permissions:["Edit site content and branding","Manage email templates","Update product descriptions","View orders (read-only)","Cannot change access controls","Cannot delete sites"]},viewer:{name:"Viewer",color:"text-gray-600 bg-gray-100 border-gray-200",icon:ne,permissions:["Read-only access","View sites and configurations","View orders and reports","Cannot make any changes","Cannot access user management"]}};function Ce(){const{adminUser:u,accessToken:x}=re(),{formatDate:V}=le(),[U,J]=n.useState(""),[T,K]=n.useState(""),[$,Y]=n.useState(""),[G,w]=n.useState(!1),[l,v]=n.useState(null),[H,N]=n.useState(!1),[C,A]=n.useState(null),[y,k]=n.useState(""),[q,S]=n.useState(""),[M,P]=n.useState(!1),[F,R]=n.useState(!0),[t,c]=n.useState(!1),[p,_]=n.useState([]),[I,d]=n.useState(null),[a,o]=n.useState({username:"",email:"",role:"viewer",status:"active",clientAccess:"all",siteAccess:"all",requirePasswordChange:!1,password:"",confirmPassword:""});n.useEffect(()=>{l&&o({username:l.username,email:l.email,role:l.role,status:l.status,clientAccess:l.clientAccess,siteAccess:l.siteAccess,requirePasswordChange:l.requirePasswordChange,password:"",confirmPassword:""})},[l]);const D=async()=>{R(!0),d(null);try{const s=await fetch(`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users`,{headers:{Authorization:`Bearer ${j}`,"X-Access-Token":x||"","X-Environment-ID":"development"}});if(!s.ok){const i=await s.json().catch(()=>({error:"Unknown error"}));if(s.status===403){b.log("[Admin Users] User is not a super_admin in admin_users table"),d('You need to be added as a super_admin in the Admin User Management system. Please create your admin user account first using the "Add Admin User" button.'),_([]),R(!1);return}throw new Error(i.error||"Failed to fetch admin users")}const r=await s.json();_(r.users||[])}catch(s){b.error("Error fetching admin users:",s),d(s.message)}finally{R(!1)}};n.useEffect(()=>{(u==null?void 0:u.role)==="super_admin"&&x&&D()},[u,x]);const Q=async()=>{if(!a.username||!a.email||!a.role){alert("Please fill in all required fields");return}if(!l){if(!a.password||!a.confirmPassword){alert("Password and confirmation are required for new users");return}if(a.password!==a.confirmPassword){alert("Passwords do not match");return}if(a.password.length<8){alert("Password must be at least 8 characters long");return}}c(!0),d(null);try{const s=l?`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users/${l.id}`:`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users`,r=l?"PUT":"POST",i={username:a.username,email:a.email,role:a.role,status:a.status,clientAccess:a.clientAccess,siteAccess:a.siteAccess,requirePasswordChange:a.requirePasswordChange};l||(i.password=a.password);const m=await fetch(s,{method:r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`,"X-Access-Token":x||"","X-Environment-ID":"development"},body:JSON.stringify(i)});if(!m.ok){const ae=await m.json();throw new Error(ae.error||`Failed to ${l?"update":"create"} admin user`)}alert(`Admin user ${l?"updated":"created"} successfully!`),w(!1),v(null),o({username:"",email:"",role:"viewer",status:"active",clientAccess:"all",siteAccess:"all",requirePasswordChange:!1,password:"",confirmPassword:""}),await D()}catch(s){b.error("Error saving admin user:",s),d(s.message),alert(`Error: ${s.message}`)}finally{c(!1)}},W=async s=>{if(confirm(`Are you sure you want to delete the admin user "${s.username}"? This action cannot be undone.`)){c(!0),d(null);try{const r=await fetch(`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${j}`,"X-Access-Token":x||"","X-Environment-ID":"development"}});if(!r.ok){const i=await r.json();throw new Error(i.error||"Failed to delete admin user")}alert("Admin user deleted successfully!"),await D()}catch(r){b.error("Error deleting admin user:",r),d(r.message),alert(`Error: ${r.message}`)}finally{c(!1)}}},Z=async(s,r)=>{if(confirm(`Are you sure you want to change ${s.username}'s status to ${r}?`)){c(!0),d(null);try{const i=await fetch(`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`,"X-Access-Token":x||"","X-Environment-ID":"development"},body:JSON.stringify({status:r})});if(!i.ok){const m=await i.json();throw new Error(m.error||"Failed to update status")}alert(`User status updated to ${r} successfully!`),await D()}catch(i){b.error("Error updating user status:",i),d(i.message),alert(`Error: ${i.message}`)}finally{c(!1)}}},ee=async()=>{if(C){if(!y||!q){alert("Please enter and confirm the new password");return}if(y!==q){alert("Passwords do not match");return}if(y.length<8){alert("Password must be at least 8 characters long");return}c(!0),d(null);try{const s=await fetch(`https://${h}.supabase.co/functions/v1/make-server-6fcaeea3/admin-users/${C.id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`,"X-Access-Token":x||"","X-Environment-ID":"development"},body:JSON.stringify({newPassword:y,requireChangeOnNextLogin:M})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Failed to reset password")}alert("Password reset successfully!"),N(!1),A(null),k(""),S(""),P(!1)}catch(s){b.error("Error resetting password:",s),d(s.message),alert(`Error: ${s.message}`)}finally{c(!1)}}};if((u==null?void 0:u.role)!=="super_admin")return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-red-800",children:"You do not have permission to access Admin User Management. This feature requires Super Admin privileges."})]})]})})});const O=p.filter(s=>{const r=s.username.toLowerCase().includes(U.toLowerCase())||s.email.toLowerCase().includes(U.toLowerCase()),i=!T||s.role===T,m=!$||s.status===$;return r&&i&&m}),se=s=>V(s,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin User Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage HALO employee access to the admin platform"})]}),e.jsxs("button",{onClick:()=>w(!0),disabled:t,className:"inline-flex items-center gap-2 bg-[#D91C81] text-white px-4 py-2.5 rounded-lg font-semibold hover:bg-[#B71569] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ie,{className:"w-5 h-5"}),"Add Admin User"]})]}),I&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-orange-900",children:"Getting Started"}),e.jsx("p",{className:"text-orange-800 text-sm",children:I}),p.length===0&&e.jsx("p",{className:"text-orange-800 text-sm mt-2",children:'Click the "Add Admin User" button above to create the first super admin account in the system.'})]})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(g,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Admin Roles & Permissions"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(f).map(([s,r])=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold border mb-3 ${r.color}`,children:[e.jsx(r.icon,{className:"w-3 h-3"}),r.name]}),e.jsx("ul",{className:"space-y-1.5",children:r.permissions.map((i,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs text-gray-600",children:[e.jsx(X,{className:"w-3 h-3 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i})]},m))})]},s))})]}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by username or email...",value:U,onChange:s=>J(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsxs("select",{value:T,onChange:s=>K(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"site_manager",children:"Site Manager"}),e.jsx("option",{value:"content_editor",children:"Content Editor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsxs("select",{value:$,onChange:s=>Y(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Admin Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.filter(s=>s.status==="active").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Super Admins"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:p.filter(s=>s.role==="super_admin").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Site Managers"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.filter(s=>s.role==="site_manager").length})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:F?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(L,{className:"w-8 h-8 text-[#D91C81] animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading admin users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Site Access"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:O.map(s=>{const r=f[s.role]||{name:"Unknown Role",color:"text-gray-600 bg-gray-100 border-gray-200",icon:E};return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:s.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.username}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3"}),s.email]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold border ${r.color}`,children:[e.jsx(r.icon,{className:"w-3 h-3"}),r.name,!f[s.role]&&e.jsxs("span",{className:"text-xs opacity-70",children:["(",s.role,")"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.siteAccess==="all"?e.jsxs("span",{className:"flex items-center gap-1 text-purple-600 font-medium",children:[e.jsx(g,{className:"w-4 h-4"}),"All Sites"]}):Array.isArray(s.siteAccess)?e.jsxs("span",{className:"text-gray-600",children:[s.siteAccess.length," site",s.siteAccess.length!==1?"s":""]}):e.jsx("span",{className:"text-gray-400",children:"Not configured"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:s.status,onChange:i=>Z(s,i.target.value),disabled:t,className:`px-3 py-1.5 text-xs font-semibold rounded-full border cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed ${s.status==="active"?"bg-green-100 text-green-800 border-green-200 hover:bg-green-200":"bg-gray-100 text-gray-800 border-gray-200 hover:bg-gray-200"}`,children:[e.jsx("option",{value:"active",children:"✓ Active"}),e.jsx("option",{value:"inactive",children:"✕ Inactive"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-600",children:s.lastLogin?se(s.lastLogin):"Never"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(s),disabled:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Edit User",children:e.jsx(z,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:()=>{A(s),N(!0)},disabled:t,className:"p-2 hover:bg-blue-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Reset Password",children:e.jsx(de,{className:"w-4 h-4 text-blue-600"})}),e.jsx("button",{onClick:()=>W(s),disabled:t,className:"p-2 hover:bg-red-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete User",children:e.jsx(ce,{className:"w-4 h-4 text-red-600"})})]})})]},s.id)})})]})}),O.length===0&&!F&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(g,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No admin users found matching your filters."})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(g,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Security Best Practices"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-800",children:[e.jsx("li",{children:"Regularly review admin user access and permissions"}),e.jsx("li",{children:"Deactivate accounts for employees who leave the company"}),e.jsx("li",{children:"Use the principle of least privilege - grant only necessary permissions"}),e.jsx("li",{children:"Enforce strong password policies and MFA for all admin accounts"}),e.jsx("li",{children:"Audit admin activity logs regularly for suspicious behavior"})]})]})]})}),(G||l)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l?"Edit Admin User":"Add New Admin User"}),e.jsx("button",{onClick:()=>{w(!1),v(null),o({username:"",email:"",role:"viewer",status:"active",clientAccess:"all",siteAccess:"all",requirePasswordChange:!1,password:"",confirmPassword:""})},disabled:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(B,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-purple-600"}),"Account Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username *"}),e.jsx("input",{type:"text",value:a.username,onChange:s=>o({...a,username:s.target.value}),placeholder:"john.doe",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>o({...a,email:s.target.value}),placeholder:"john.doe@halobranded.com",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",required:!0})]})]}),!l&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e.jsx("input",{type:"password",value:a.password,onChange:s=>o({...a,password:s.target.value}),placeholder:"••••••••",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),e.jsx("input",{type:"password",value:a.confirmPassword,onChange:s=>o({...a,confirmPassword:s.target.value}),placeholder:"••••••••",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Role & Permissions"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Role *"}),e.jsxs("select",{value:a.role,onChange:s=>o({...a,role:s.target.value}),disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"viewer",children:"Viewer - Read-only access"}),e.jsx("option",{value:"content_editor",children:"Content Editor - Edit site content"}),e.jsx("option",{value:"site_manager",children:"Site Manager - Manage assigned sites"}),e.jsx("option",{value:"super_admin",children:"Super Admin - Full system access"})]})]}),a.role&&f[a.role]&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:[f[a.role].name," Permissions:"]}),e.jsx("ul",{className:"space-y-1.5",children:f[a.role].permissions.map((s,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs text-gray-600",children:[e.jsx(X,{className:"w-3 h-3 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:s})]},r))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Client Access"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Access Level *"}),e.jsxs("select",{value:a.clientAccess==="all"?"all":"specific",onChange:s=>o({...a,clientAccess:s.target.value==="all"?"all":[]}),disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"all",children:"All Clients (Full Access)"}),e.jsx("option",{value:"specific",children:"Specific Clients Only"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:a.clientAccess==="all"?"This user will have access to all current and future clients and their sites.":"This user will only have access to clients you specifically assign."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Site Access"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Site Access Level *"}),e.jsxs("select",{value:a.siteAccess==="all"?"all":"specific",onChange:s=>o({...a,siteAccess:s.target.value==="all"?"all":[]}),disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"all",children:"All Sites (Full Access)"}),e.jsx("option",{value:"specific",children:"Specific Sites Only"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:a.siteAccess==="all"?"This user will have access to all current and future sites.":"This user will only have access to sites you specifically assign."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Account Status"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsxs("select",{value:a.status,onChange:s=>o({...a,status:s.target.value}),disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"active",children:"Active - Can log in and access system"}),e.jsx("option",{value:"inactive",children:"Inactive - Cannot log in"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"requirePasswordChange",checked:a.requirePasswordChange,onChange:s=>o({...a,requirePasswordChange:s.target.checked}),disabled:t,className:"mt-1 w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-pink-100 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"requirePasswordChange",className:"block text-sm font-medium text-gray-900 cursor-pointer",children:"Require password change on next login"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:l?"User will be prompted to create a new password on their next login":"User will be required to change their password immediately after first login"})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-900",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Security Reminder"}),e.jsx("p",{className:"text-yellow-800",children:l?"Changes to user permissions will take effect immediately upon saving.":"The new admin user will be created with the specified credentials. Make sure the email address is correct."})]})]})})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{w(!1),v(null),o({username:"",email:"",role:"viewer",status:"active",clientAccess:"all",siteAccess:"all",requirePasswordChange:!1,password:"",confirmPassword:""})},disabled:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsxs("button",{onClick:Q,disabled:t,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg font-semibold hover:bg-[#B71569] transition-all disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[t&&e.jsx(L,{className:"w-4 h-4 animate-spin"}),l?"Save Changes":"Create Admin User"]})]})]})}),H&&C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-xl",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Reset Password"}),e.jsx("button",{onClick:()=>{N(!1),A(null),k(""),S(""),P(!1)},disabled:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(B,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Reset password for ",e.jsx("span",{className:"font-semibold text-gray-900",children:C.username})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password *"}),e.jsx("input",{type:"password",value:y,onChange:s=>k(s.target.value),placeholder:"••••••••",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password *"}),e.jsx("input",{type:"password",value:q,onChange:s=>S(s.target.value),placeholder:"••••••••",disabled:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"requireChangeOnNextLogin",checked:M,onChange:s=>P(s.target.checked),disabled:t,className:"mt-1 w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-pink-100 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("label",{htmlFor:"requireChangeOnNextLogin",className:"block text-sm font-medium text-gray-900 cursor-pointer",children:"Require password change on next login"})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsx("p",{className:"text-xs text-yellow-800",children:"The user will need to use this new password on their next login."})})]}),e.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3 rounded-b-xl",children:[e.jsx("button",{onClick:()=>{N(!1),A(null),k(""),S(""),P(!1)},disabled:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsxs("button",{onClick:ee,disabled:t,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg font-semibold hover:bg-[#B71569] transition-all disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:[t&&e.jsx(L,{className:"w-4 h-4 animate-spin"}),"Reset Password"]})]})]})})]})}export{Ce as AdminUserManagement};
