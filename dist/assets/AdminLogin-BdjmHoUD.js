import{u as B,a0 as P,l,j as e,r as i,U as D,L as F}from"./index-BKvtyMRF.js";import{E as $,A as M}from"./Alert-Cmb7T1bE.js";import{B as z,c as I,l as f,s as R,a as U,v as _}from"./frontendSecurity-C9rtggYB.js";import{s as u,a as T}from"./errorHandling-D_CdsDrI.js";import{p as q}from"./apiErrors-Br52ABxq.js";import{C as O}from"./circle-alert-DcZKv8iA.js";import{L as v}from"./loader-circle-D1bgJAn0.js";import{S as N}from"./shield-CQ-UNb8F.js";import{M as H}from"./mail-CHFpKMdT.js";import{L as V}from"./lock-BdA3E3RK.js";import{E as W}from"./eye-off-CB6FcNVX.js";import{E as G}from"./eye-CRSarQ70.js";import"./badge-fCMJuODf.js";import"./circle-check-big-BvCQpXTh.js";import"./info-lUgU3iMD.js";import"./circle-x-CltkxQeE.js";function me(){const g=B();let p;try{p=P()}catch(s){return l.error("[AdminLogin] Failed to access AdminContext:",s),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[e.jsx(O,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Configuration Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The admin system is not properly initialized. Please refresh the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-[#D91C81] text-white rounded-lg hover:bg-[#B71569] transition-colors",children:"Refresh Page"})]})})}const{adminLogin:C,isAdminAuthenticated:b,isLoading:x}=p,[t,L]=i.useState(""),[d,A]=i.useState(""),[c,E]=i.useState(!1),[m,w]=i.useState(!1),[j,n]=i.useState(""),[a,h]=i.useState({});i.useEffect(()=>{b&&!x&&(l.info("[AdminLogin] User already authenticated, redirecting to dashboard"),g("/admin/dashboard"))},[b,x,g]);const S=()=>{const s={};return t.trim()?t.includes("@")?_(t)||(s.identifier="Please enter a valid email address"):t.length<3&&(s.identifier="Username must be at least 3 characters"):s.identifier="Email or username is required",d?d.length<8&&(s.password="Password must be at least 8 characters"):s.password="Password is required",h(s),Object.keys(s).length===0},k=async s=>{s.preventDefault(),n(""),l.info("[AdminLogin] Attempting login",{identifier:t.substring(0,3)+"***"});const y=I("admin_login",5,3e5);if(!y.allowed){const r=Math.ceil((y.retryAfter??0)/6e4),o=`Too many login attempts. Please try again in ${r} minute${r!==1?"s":""}.`;n(o),u(o),f({type:"rate_limit",details:`Admin login rate limit exceeded for ${t}`,severity:"medium"});return}if(S()){w(!0);try{const r=R(t.trim().toLowerCase());await C(r,d)?(l.info("[AdminLogin] Login successful"),U("admin_login"),T("Welcome back! Redirecting to dashboard...")):(l.warn("[AdminLogin] Login returned false"),n("Invalid email/username or password"),u("Login failed"),f({type:"auth_failure",details:`Failed admin login attempt for ${r}`,severity:"medium"}))}catch(r){l.error("[AdminLogin] Login error:",r);const o=q(r);n(o),u(r),f({type:"auth_failure",details:`Admin login exception: ${o}`,severity:"high"})}finally{w(!1)}}};return x?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-12 h-12 text-white animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Checking authentication..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center p-6",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx($,{})}),e.jsx("div",{className:"fixed top-4 left-4 z-50",children:e.jsx(z,{})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 md:p-12 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#D91C81] to-[#B71569] rounded-full mb-4",children:e.jsx(N,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to manage your platform"})]}),j&&e.jsx(M,{variant:"error",title:"Login Failed",message:j,className:"mb-6"}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identifier",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email or Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:t.includes("@")?e.jsx(H,{className:"h-5 w-5 text-gray-400"}):e.jsx(D,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"identifier",type:"text",value:t,onChange:s=>{L(s.target.value),h({...a,identifier:void 0}),n("")},placeholder:"admin@example.com",autoComplete:"username",disabled:m,className:`w-full pl-12 pr-4 py-3 border ${a.identifier?"border-red-300":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent transition-all disabled:bg-gray-100 disabled:cursor-not-allowed`})]}),a.identifier&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:a.identifier})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(V,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",type:c?"text":"password",value:d,onChange:s=>{A(s.target.value),h({...a,password:void 0}),n("")},placeholder:"••••••••",autoComplete:"current-password",disabled:m,className:`w-full pl-12 pr-12 py-3 border ${a.password?"border-red-300":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent transition-all disabled:bg-gray-100 disabled:cursor-not-allowed`}),e.jsx("button",{type:"button",onClick:()=>E(!c),disabled:m,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed","aria-label":c?"Hide password":"Show password",children:c?e.jsx(W,{className:"h-5 w-5"}):e.jsx(G,{className:"h-5 w-5"})})]}),a.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:a.password})]}),e.jsx("button",{type:"submit",disabled:m||!t||!d,className:"w-full bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white py-3 px-4 rounded-lg font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-none flex items-center justify-center gap-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-5 h-5"}),"Sign In"]})}),e.jsx("div",{className:"text-center",children:e.jsx(F,{to:"/admin/forgot-password",className:"text-sm text-[#D91C81] hover:text-[#B71569] font-medium transition-colors",children:"Forgot your password?"})})]})]})]})}export{me as default};
