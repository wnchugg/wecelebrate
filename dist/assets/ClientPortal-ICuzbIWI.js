import{u as S,o as A,c as B,r,t as v,j as e,L as n,B as m,A as $,g as R,p as y}from"./index-dV4Uttrq.js";import{u as P}from"./useDateFormat-DXMDXoB8.js";import{L as z}from"./loader-circle-BpaB5MSO.js";import{L as F}from"./lock-BmdpVemy.js";import{M}from"./map-pin-RXUS_5Nj.js";import{U}from"./users-DibFapgP.js";import{C as X}from"./calendar-BSj-0Q_N.js";import{E as T}from"./external-link-C7ZxDanW.js";function J(){const x=S(),[h]=A(),{t:g}=B(),{formatShortDate:w}=P(),[i,C]=r.useState([]),[t,D]=r.useState(null),[k,l]=r.useState(!0),[u,o]=r.useState(null),c=h.get("token")||"";return r.useEffect(()=>{if(!c){v.error(g("notification.error.loginRequired")),x("/admin/login");return}(async()=>{var f,p;try{l(!0),o(null);const a=R(),j=await fetch(`${a.supabaseUrl}/functions/v1/make-server-6fcaeea3/v2/clients`,{headers:{Authorization:`Bearer ${y}`,"X-Access-Token":c,"X-Environment-ID":a.id}});if(!j.ok)throw new Error("Failed to fetch client data");const N=await j.json(),d=((f=N.data)==null?void 0:f.find(L=>L.status==="active"))||((p=N.data)==null?void 0:p[0]);if(!d){o("No client found for your account"),l(!1);return}D(d);const b=await fetch(`${a.supabaseUrl}/functions/v1/make-server-6fcaeea3/v2/sites?client_id=${d.id}`,{headers:{Authorization:`Bearer ${y}`,"X-Access-Token":c,"X-Environment-ID":a.id}});if(!b.ok)throw new Error("Failed to fetch sites");const E=await b.json();C(E.data||[])}catch(a){console.error("Error fetching client data:",a),o(a.message||"Failed to load client data"),v.error(g("notification.error.failedToLoadSites"))}finally{l(!1)}})()},[h,x]),k?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(z,{className:"w-16 h-16 text-[#D91C81] animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your portal..."})]})}):u&&!t?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:u}),e.jsx(n,{to:"/admin/login",className:"inline-flex items-center gap-2 px-6 py-3 bg-[#D91C81] text-white rounded-lg font-semibold hover:bg-[#B71569] transition-colors",children:"Return to Login"})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Client Portal"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Welcome back",t?`, ${t.name}`:""]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{to:"/admin/dashboard",className:"text-gray-600 hover:text-[#D91C81] transition-colors font-medium",children:"Admin Dashboard"}),e.jsx(n,{to:"/admin/logout",className:"px-4 py-2 text-gray-600 hover:text-[#D91C81] transition-colors font-medium",children:"Logout"})]})]})})}),t&&e.jsx("section",{className:"bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center flex-shrink-0",children:e.jsx(m,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:t.name}),t.description&&e.jsx("p",{className:"text-white/90 text-lg mb-3",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[t.contactEmail&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-75",children:"Contact:"}),e.jsx("span",{className:"font-medium",children:t.contactEmail})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-75",children:"Sites:"}),e.jsx("span",{className:"font-medium",children:i.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-75",children:"Status:"}),e.jsx("span",{className:"px-2 py-1 bg-white/20 rounded-full font-medium text-xs uppercase",children:t.status})]})]})]})]})})}),e.jsxs("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Sites"}),e.jsx("p",{className:"text-gray-600",children:"Manage and access all sites under your organization"})]}),i.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(m,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Sites Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"No sites have been configured for your organization yet."}),e.jsxs(n,{to:"/admin/sites",className:"inline-flex items-center gap-2 px-6 py-3 bg-[#D91C81] text-white rounded-lg font-semibold hover:bg-[#B71569] transition-colors",children:["Manage Sites",e.jsx($,{className:"w-5 h-5"})]})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>e.jsx(n,{to:`/site/${s.id}`,className:"group bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden border-2 border-transparent hover:border-[#D91C81]",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-[#D91C81]/10 to-[#1B2A5E]/10 rounded-xl flex items-center justify-center mb-4 group-hover:from-[#D91C81]/20 group-hover:to-[#1B2A5E]/20 transition-colors",children:e.jsx(m,{className:"w-7 h-7 text-[#D91C81]"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2 group-hover:text-[#D91C81] transition-colors",children:s.name}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(M,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.location})]}),s.employeeCount!==void 0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(U,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{children:[s.employeeCount," employees"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(X,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{children:["Created ",w(new Date(s.createdAt))]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${s.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.status}),e.jsx(T,{className:"w-5 h-5 text-gray-400 group-hover:text-[#D91C81] transition-colors"})]})]})},s.id))})]})]})}export{J as default};
