import{r as x,g as le,a2 as Ne,j as e,L as G,D as p,w as d,p as g,C as u,a5 as M,T as L,ad as w,t as b}from"./index-CYlZQa06.js";import{T as ve,a as ye,b as C,c as T}from"./tabs-BiVPtTZq.js";import{C as D,a as E,b as S,c as A,d as $}from"./card-BPM0EqmW.js";import{B as oe}from"./badge-9JH8fCUp.js";import{A as P}from"./activity-B7tbWUwn.js";import{T as ke}from"./test-tube-diagonal-CP2zWgcH.js";import{F as ce}from"./file-text-DqnWOcoQ.js";import{S as v}from"./shield-_WEmX3g3.js";import{S as z}from"./server-CljMEZvi.js";import{C as N}from"./circle-check-big-CFCg4-e0.js";import{C as f}from"./circle-x-DjoPwhUG.js";import{C as de}from"./circle-alert-cB5UyqMQ.js";import"./index-DFx17Zj6.js";import"./index-4AbBDogP.js";import"./index-CPBgqh-3.js";import"./index-BXDtpjth.js";import"./index-Bsi2C2ro.js";import"./index-DGQlNnP0.js";import"./index-DW32q5jf.js";function He(){var _,Q,Z,ee,se,ae,te,re,ne,ie;const[xe,me]=x.useState("data"),[I,W]=x.useState(!1),[R,q]=x.useState(!1),[y,B]=x.useState(!1),[m,he]=x.useState(null),[o,pe]=x.useState(null),[we,Ce]=x.useState(!1),[Te,De]=x.useState(null),[s,F]=x.useState(null),[U,H]=x.useState(!1),[K,V]=x.useState(!1),c=le(),Y=Ne(),ge=`https://${d}.supabase.co/functions/v1/make-server-6fcaeea3`,je=async()=>{H(!0),F(null);try{const a=w(),r=le(),l={timestamp:new Date().toISOString(),environment:r.id,tokenExists:!!a};if(a){try{const n=a.split(".");if(n.length===3){const i=JSON.parse(atob(n[0])),t=JSON.parse(atob(n[1]));l.tokenInfo={algorithm:i.alg,type:i.typ,userId:t.userId,email:t.email,username:t.username,role:t.role,environment:t.environment,issuedAt:new Date((t.iat||0)*1e3).toISOString(),expiresAt:new Date((t.exp||0)*1e3).toISOString(),expired:t.exp<Math.floor(Date.now()/1e3),timeLeft:t.exp?Math.round((t.exp*1e3-Date.now())/1e3/60):0}}}catch(n){l.decodeError=n.message}try{const i=await(await fetch(`${ge}/debug/verify-jwt`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`,"X-Environment-ID":r.id},body:JSON.stringify({token:a})})).json();l.backendVerification=i}catch(n){l.backendVerificationError=n.message}}else l.message="No access token found in sessionStorage",l.action="Please log in to get a token";F(l)}catch(a){F({error:a.message})}finally{H(!1)}},be=async()=>{W(!0);const a={timestamp:new Date().toISOString(),figmaMakeConfig:{projectId:d,publicAnonKey:g.substring(0,20)+"...",url:`https://${d}.supabase.co`},currentEnvironment:c,allEnvironments:Y,connectionTests:[]},r=`https://${d}.supabase.co/functions/v1/make-server-6fcaeea3/health`;try{const t=await fetch(r,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}});a.connectionTests.push({name:"Figma Make Project (from /utils/supabase/info.tsx)",projectId:d,url:r,status:t.status,ok:t.ok,data:t.ok?await t.json():await t.text()})}catch(t){a.connectionTests.push({name:"Figma Make Project (from /utils/supabase/info.tsx)",projectId:d,url:r,status:"error",ok:!1,error:t.message})}const l=c.supabaseUrl.match(/https:\/\/([^.]+)\.supabase\.co/),n=l?l[1]:"",i=`${c.supabaseUrl}/functions/v1/make-server-6fcaeea3/health`;try{const t=await fetch(i,{headers:{Authorization:`Bearer ${c.supabaseAnonKey}`,"Content-Type":"application/json"}});a.connectionTests.push({name:`Current Environment (${c.name})`,projectId:n,url:i,status:t.status,ok:t.ok,data:t.ok?await t.json():await t.text()})}catch(t){a.connectionTests.push({name:`Current Environment (${c.name})`,projectId:n,url:i,status:"error",ok:!1,error:t.message})}he(a),W(!1)},J=async()=>{q(!0);const a=w(),r=`https://${d}.supabase.co/functions/v1/make-server-6fcaeea3`,l={environment:{projectId:d,baseUrl:r,hasToken:!!a,token:a?`${a.substring(0,20)}...`:"No token"},endpoints:{}},n=[{name:"Health Check",url:`${r}/health`,method:"GET",requiresAuth:!1},{name:"Get Clients",url:`${r}/v2/clients`,method:"GET",requiresAuth:!0},{name:"Get Sites",url:`${r}/v2/sites`,method:"GET",requiresAuth:!0},{name:"Get Gifts",url:`${r}/gifts`,method:"GET",requiresAuth:!0},{name:"Check Admin",url:`${r}/debug/check-admin-users`,method:"GET",requiresAuth:!1}];for(const i of n)try{const t={"Content-Type":"application/json"};i.requiresAuth&&a?(t["X-Access-Token"]=a,t.Authorization=`Bearer ${g}`):t.Authorization=`Bearer ${g}`;const h=await fetch(i.url,{method:i.method,headers:t});let j=null,O=null,k="";try{k=await h.text(),k&&(j=JSON.parse(k))}catch(ue){O=`JSON parse error: ${ue.message}`,j={raw:k,parseError:O}}l.endpoints[i.name]={status:h.status,ok:h.ok,data:j,error:O}}catch(t){l.endpoints[i.name]={status:0,ok:!1,data:null,error:t.message}}pe(l),q(!1)},X=async()=>{B(!0);const a=w(),r=`https://${d}.supabase.co/functions/v1/make-server-6fcaeea3`;if(!a){b.error("You must be logged in as an admin to reseed the database"),B(!1);return}const l={"Content-Type":"application/json","X-Access-Token":a,Authorization:`Bearer ${g}`};try{const n=await fetch(`${r}/dev/reseed`,{method:"POST",headers:l}),i=await n.json();if(n.ok){try{localStorage.removeItem("admin_selected_site_id"),console.log("Cleared stale site selection from localStorage")}catch(t){console.warn("Failed to clear localStorage:",t)}b.success("Database reseeded successfully! Page will reload..."),await J(),setTimeout(()=>{window.location.reload()},1500)}else console.error("Reseed failed:",i),b.error(`Failed to reseed: ${i.error||"Unknown error"}`)}catch(n){console.error("Reseed error:",n),b.error(`Network error: ${n.message}`)}finally{B(!1)}},fe=async()=>{if(!confirm("‚ö†Ô∏è WARNING: This will delete ALL data from the database. Are you sure?"))return;V(!0);const a=w(),r=`https://${d}.supabase.co/functions/v1/make-server-6fcaeea3`;if(!a){b.error("You must be logged in as an admin to clear the database"),V(!1);return}const l={"Content-Type":"application/json","X-Access-Token":a,Authorization:`Bearer ${g}`};try{const n=["client","clients","site","sites","gift","gifts","employee","employees","order","orders","admin","admins","role","roles","celebration","celebrations"];let i=0;for(const t of n)try{const h=await fetch(`${r}/admin/database/prefix/${t}`,{method:"DELETE",headers:l}),j=await h.json();h.ok&&j.success&&(i+=j.deleted||0,console.log(`Deleted ${j.deleted} records with prefix: ${t}`))}catch(h){console.error(`Failed to delete prefix ${t}:`,h)}b.success(`Successfully cleared ${i} records from the database`),await J()}catch(n){console.error("Clear error:",n),b.error(`Failed to clear database: ${n.message}`)}finally{V(!1)}};return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"w-8 h-8 text-[#D91C81]"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Developer Tools"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Environment management, connection testing, and data diagnostics"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(G,{to:"/admin/testing-dashboard",className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border-2 border-emerald-200 rounded-xl p-4 hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ke,{className:"w-6 h-6 text-emerald-600"}),e.jsx("h3",{className:"font-bold text-gray-900 group-hover:text-emerald-600 transition-colors",children:"Testing Dashboard"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"View live test results and CI/CD status"})]}),e.jsxs(G,{to:"/admin/development-documentation",className:"bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-xl p-4 hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ce,{className:"w-6 h-6 text-blue-600"}),e.jsx("h3",{className:"font-bold text-gray-900 group-hover:text-blue-600 transition-colors",children:"Documentation"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Technical docs and architecture guides"})]}),e.jsxs(G,{to:"/admin/test-data-reference",className:"bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-xl p-4 hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(v,{className:"w-6 h-6 text-purple-600"}),e.jsx("h3",{className:"font-bold text-gray-900 group-hover:text-purple-600 transition-colors",children:"Test Data"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sample data and test credentials"})]})]}),e.jsxs(ve,{value:xe,onValueChange:me,className:"space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-2",children:e.jsxs(ye,{className:"grid grid-cols-4 w-full gap-2",children:[e.jsxs(C,{value:"environments",className:"flex items-center gap-2 data-[state=active]:bg-[#D91C81] data-[state=active]:text-white",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"Environments"})]}),e.jsxs(C,{value:"connection",className:"flex items-center gap-2 data-[state=active]:bg-[#D91C81] data-[state=active]:text-white",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Connection Test"})]}),e.jsxs(C,{value:"data",className:"flex items-center gap-2 data-[state=active]:bg-[#D91C81] data-[state=active]:text-white",children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{children:"Data Diagnostic"})]}),e.jsxs(C,{value:"jwt",className:"flex items-center gap-2 data-[state=active]:bg-[#D91C81] data-[state=active]:text-white",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:"JWT Token"})]})]})}),e.jsx(T,{value:"environments",className:"space-y-6",children:e.jsxs(D,{children:[e.jsxs(E,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-[#D91C81]"}),"Environment Configuration"]}),e.jsx(A,{children:"View and manage deployment environments"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Current Selected Environment"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-700 font-semibold",children:"Name:"}),e.jsxs("span",{className:"text-blue-900",children:[c.name," (",c.id,")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-700 font-semibold",children:"URL:"}),e.jsx("code",{className:"text-blue-900 bg-white px-2 py-1 rounded font-mono text-xs break-all",children:c.supabaseUrl})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-700 font-semibold",children:"Anon Key:"}),e.jsxs("code",{className:"text-blue-900 bg-white px-2 py-1 rounded font-mono text-xs",children:[c.supabaseAnonKey.substring(0,40),"..."]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Available Environments"}),e.jsx("div",{className:"space-y-3",children:Y.map(a=>e.jsxs("div",{className:`p-4 border rounded-lg ${a.id===c.id?"border-[#D91C81] bg-pink-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:a.name}),a.id===c.id&&e.jsx(oe,{className:"bg-[#D91C81] text-white",children:"Active"})]}),e.jsx(oe,{variant:"outline",children:a.id})]}),e.jsx("div",{className:"text-xs text-gray-600 space-y-1 font-mono",children:e.jsxs("div",{className:"truncate",children:["URL: ",a.supabaseUrl]})})]},a.id))})]}),e.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-3 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5"}),"Figma Make Configuration"]}),e.jsxs("div",{className:"space-y-2 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-purple-700 font-semibold",children:"File:"}),e.jsx("code",{className:"text-purple-900",children:"/utils/supabase/info.tsx"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-purple-700 font-semibold",children:"Project ID:"}),e.jsx("code",{className:"text-purple-900 bg-white px-2 py-1 rounded",children:d})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-purple-700 font-semibold",children:"URL:"}),e.jsxs("code",{className:"text-purple-900 bg-white px-2 py-1 rounded",children:["https://",d,".supabase.co"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-purple-700 font-semibold",children:"Anon Key:"}),e.jsxs("code",{className:"text-purple-900 bg-white px-2 py-1 rounded",children:[g.substring(0,40),"..."]})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-white border border-purple-300 rounded",children:e.jsxs("p",{className:"text-xs text-purple-800",children:[e.jsx("strong",{children:"‚ö†Ô∏è Important:"})," This is the ",e.jsx("strong",{children:"hardcoded"})," configuration in Figma Make. All backend API calls use this project by default unless overridden by the environment selector."]})})]})]})]})}),e.jsx(T,{value:"connection",className:"space-y-6",children:e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-blue-600"}),"Backend Connection Diagnostics"]}),e.jsx(A,{children:"Comprehensive environment and connection testing"})]}),e.jsxs(u,{onClick:be,disabled:I,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${I?"animate-spin":""}`}),I?"Testing...":"Run Test"]})]})}),e.jsxs($,{className:"space-y-6",children:[m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Connection Test Results"}),m.connectionTests.map((a,r)=>e.jsx("div",{className:`p-4 border rounded-lg ${a.ok?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[a.ok?e.jsx(N,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:a.name}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Project:"}),e.jsx("code",{className:"text-gray-900",children:a.projectId})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"URL:"}),e.jsx("code",{className:"text-gray-900 text-xs break-all",children:a.url})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Status:"}),e.jsx("code",{className:`${a.ok?"text-green-700":"text-red-700"} font-bold`,children:a.status})]}),a.data&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Response:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto max-h-48",children:typeof a.data=="string"?a.data:JSON.stringify(a.data,null,2)})]}),a.error&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-red-700 font-semibold",children:"Error:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto text-red-900",children:a.error})]})]})]})]})},r))]}),e.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsxs("h4",{className:"font-bold text-amber-900 mb-2 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Analysis & Recommendations"]}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-900",children:[m.figmaMakeConfig.projectId!==((_=m.currentEnvironment.supabaseUrl.match(/https:\/\/([^.]+)\.supabase\.co/))==null?void 0:_[1])&&e.jsxs("div",{className:"p-3 bg-white rounded border border-amber-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:"‚ö†Ô∏è Configuration Mismatch Detected"}),e.jsxs("p",{className:"text-xs",children:["Figma Make is configured to use project ",e.jsx("code",{className:"bg-amber-100 px-1 rounded",children:m.figmaMakeConfig.projectId})," ","but your environment selector is pointing to a different project."]})]}),!m.connectionTests[0].ok&&e.jsxs("div",{className:"p-3 bg-white rounded border border-red-300",children:[e.jsx("p",{className:"font-semibold mb-1 text-red-900",children:"‚ùå Figma Make Project Not Connected"}),e.jsxs("p",{className:"text-xs text-red-800",children:["Deploy the Edge Function to project ",e.jsx("code",{className:"bg-red-100 px-1 rounded",children:m.figmaMakeConfig.projectId})]})]}),m.connectionTests[0].ok&&e.jsxs("div",{className:"p-3 bg-white rounded border border-green-300",children:[e.jsx("p",{className:"font-semibold mb-1 text-green-900",children:"‚úÖ Figma Make Project Connected"}),e.jsxs("p",{className:"text-xs text-green-800",children:["The Edge Function is deployed and responding on project ",m.figmaMakeConfig.projectId,"."]})]})]})]})]}),!m&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(z,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:'Click "Run Test" to test backend connections'})]})]})]})}),e.jsx(T,{value:"data",className:"space-y-6",children:e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-[#D91C81]"}),"Data Diagnostic"]}),e.jsx(A,{children:"Check backend connectivity and data availability"})]}),e.jsxs(u,{onClick:J,disabled:R,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${R?"animate-spin":""}`}),R?"Running...":"Run Diagnostic"]})]})}),e.jsxs($,{className:"space-y-6",children:[o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Environment"}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Project ID:"})," ",o.environment.projectId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Base URL:"})," ",o.environment.baseUrl]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Has Auth Token:"})," ",o.environment.hasToken?"‚úÖ Yes":"‚ùå No"]}),o.environment.hasToken&&e.jsxs("div",{children:[e.jsx("strong",{children:"Token:"})," ",o.environment.token]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Endpoint Tests"}),e.jsx("div",{className:"space-y-4",children:Object.entries(o.endpoints).map(([a,r])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[r.ok?e.jsx(N,{className:"w-5 h-5 text-green-600"}):e.jsx(f,{className:"w-5 h-5 text-red-600"}),a]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.ok?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.status||"Network Error"})]}),r.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-2",children:e.jsxs("p",{className:"text-sm text-red-800",children:[e.jsx("strong",{children:"Error:"})," ",r.error]})}),r.data&&e.jsx("div",{className:"bg-gray-50 rounded p-3 overflow-auto max-h-96",children:e.jsx("pre",{className:"text-xs",children:JSON.stringify(r.data,null,2)})})]},a))})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Quick Diagnosis"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[!o.environment.hasToken&&e.jsx("p",{children:"‚ö†Ô∏è No auth token found. Please log in to admin first."}),((Q=o.endpoints["Health Check"])==null?void 0:Q.ok)===!1&&e.jsx("p",{children:"‚ùå Backend is not responding. The function may not be deployed."}),((Z=o.endpoints["Health Check"])==null?void 0:Z.ok)&&!((ee=o.endpoints["Get Clients"])!=null&&ee.ok)&&e.jsx("p",{children:"‚ö†Ô∏è Backend is running but authentication is failing. Check your credentials."}),((te=(ae=(se=o.endpoints["Get Clients"])==null?void 0:se.data)==null?void 0:ae.clients)==null?void 0:te.length)===0&&e.jsx("p",{children:"‚ö†Ô∏è Backend is working but database is empty. Run the reseed endpoint."}),((ie=(ne=(re=o.endpoints["Get Clients"])==null?void 0:re.data)==null?void 0:ne.clients)==null?void 0:ie.length)>0&&e.jsxs("p",{children:["‚úÖ Backend is working and has ",o.endpoints["Get Clients"].data.clients.length," clients!"]})]})]})]})}),e.jsx("div",{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ce,{className:"w-6 h-6 text-cyan-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-cyan-900 mb-2",children:"‚ÑπÔ∏è About the 11 Migrated Resources"}),e.jsxs("p",{className:"text-sm text-cyan-800 mb-3",children:["Your backend supports ",e.jsx("strong",{children:"11 different resource types"})," with full CRUD operations:"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 text-xs mb-3",children:[e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"1. Clients"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"2. Sites"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"3. Gifts"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"4. Orders"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"5. Employees"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"6. Admin Users"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"7. Roles"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"8. Access Groups"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"9. Celebrations"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"10. Email Templates"}),e.jsx("div",{className:"bg-white rounded px-2 py-1 border border-cyan-200",children:"11. Brands"})]}),e.jsxs("p",{className:"text-sm text-cyan-800",children:["The seed data creates ",e.jsx("strong",{children:"4 sample clients"})," along with associated sites, gifts, and other data."]})]})]})}),e.jsxs("div",{className:"flex justify-center gap-4 pt-4",children:[e.jsx(u,{onClick:fe,disabled:K,size:"lg",variant:"outline",className:"border-red-500 text-red-600 hover:bg-red-50 hover:text-red-700 font-semibold shadow-lg",children:K?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 mr-2 animate-pulse"}),"Clearing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Clear All Data"]})}),e.jsx(u,{onClick:X,disabled:y,size:"lg",className:"bg-gradient-to-r from-[#D91C81] to-[#B01669] hover:from-[#B01669] hover:to-[#8B1352] text-white font-semibold shadow-lg",children:y?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-5 h-5 mr-2 animate-spin"}),"Reseeding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-5 h-5 mr-2"}),"Reseed Database with Test Data"]})})]})]}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 border-2 border-[#D91C81] rounded-xl p-8 text-center",children:[e.jsx(p,{className:"w-16 h-16 text-[#D91C81] mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Seed Test Data"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"Click below to populate the database with sample clients, sites, gifts, employees, and test data."}),e.jsx(u,{onClick:X,disabled:y,size:"lg",className:"bg-gradient-to-r from-[#D91C81] to-[#B01669] hover:from-[#B01669] hover:to-[#8B1352] text-white font-bold shadow-xl text-lg px-8 py-6 h-auto",children:y?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-6 h-6 mr-3 animate-spin"}),"Seeding Database..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-6 h-6 mr-3"}),"üéâ Seed Test Data Now"]})}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"This will create 4 clients, 7 sites, and all supporting test data"})]}),e.jsxs("div",{className:"text-center py-8 text-gray-500 border-t",children:[e.jsx(de,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:'Or click "Run Diagnostic" above to check existing data first'})]})]})]})]})}),e.jsx(T,{value:"jwt",className:"space-y-6",children:e.jsxs(D,{children:[e.jsxs(E,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-[#D91C81]"}),"JWT Token Diagnostic"]}),e.jsx(A,{children:"Check the validity and details of the JWT token"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(u,{onClick:je,disabled:U,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(M,{className:`w-4 h-4 mr-2 ${U?"animate-spin":""}`}),U?"Checking...":"Run Diagnostic"]})}),s&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"JWT Diagnostic Results"}),e.jsx("div",{className:`p-4 border rounded-lg ${s.tokenExists?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.tokenExists?e.jsx(N,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"JWT Token Status"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Token Exists:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenExists?"Yes":"No"})]}),s.tokenExists&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Algorithm:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.algorithm})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Type:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.type})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"User ID:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.userId})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Email:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Username:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.username})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Role:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.role})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Environment:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.environment})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Issued At:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.issuedAt})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Expires At:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.expiresAt})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Expired:"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.expired?"Yes":"No"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Time Left (minutes):"}),e.jsx("code",{className:"text-gray-900",children:s.tokenInfo.timeLeft})]})]})]})]})]})}),s.backendVerification&&e.jsx("div",{className:`p-4 border rounded-lg ${s.backendVerification.verified?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.backendVerification.verified?e.jsx(N,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"Backend Verification"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Message:"}),e.jsx("code",{className:`${s.backendVerification.verified?"text-green-700":"text-red-700"} font-bold`,children:s.backendVerification.message})]}),s.backendVerification.decoded&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Decoded Token:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto max-h-48",children:JSON.stringify(s.backendVerification.decoded,null,2)})]}),s.backendVerification.verifyError&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-red-700 font-semibold",children:"Verification Error:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto text-red-900",children:s.backendVerification.verifyError})]}),s.backendVerification.verifiedPayload&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-green-700 font-semibold",children:"Verified Payload:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto",children:JSON.stringify(s.backendVerification.verifiedPayload,null,2)})]})]})]})]})}),s.backendVerificationError&&e.jsx("div",{className:"p-4 border rounded-lg bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"Backend Verification Error"}),e.jsx("div",{className:"space-y-1 text-sm",children:e.jsxs("p",{className:"text-red-800",children:["Failed to call backend verification endpoint: ",s.backendVerificationError]})})]})]})}),s.healthCheck&&e.jsx("div",{className:`p-4 border rounded-lg ${s.healthCheck.ok?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.healthCheck.ok?e.jsx(N,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"Health Check"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Status:"}),e.jsx("code",{className:`${s.healthCheck.ok?"text-green-700":"text-red-700"} font-bold`,children:s.healthCheck.status})]}),s.healthCheck.data&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Response:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto max-h-48",children:typeof s.healthCheck.data=="string"?s.healthCheck.data:JSON.stringify(s.healthCheck.data,null,2)})]}),s.healthCheck.error&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-red-700 font-semibold",children:"Error:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto text-red-900",children:s.healthCheck.error})]})]})]})]})}),s.protectedEndpoint&&e.jsx("div",{className:`p-4 border rounded-lg ${s.protectedEndpoint.ok?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.protectedEndpoint.ok?e.jsx(N,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(f,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"Protected Endpoint"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Status:"}),e.jsx("code",{className:`${s.protectedEndpoint.ok?"text-green-700":"text-red-700"} font-bold`,children:s.protectedEndpoint.status})]}),s.protectedEndpoint.data&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Response:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto max-h-48",children:typeof s.protectedEndpoint.data=="string"?s.protectedEndpoint.data:JSON.stringify(s.protectedEndpoint.data,null,2)})]}),s.protectedEndpoint.error&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-red-700 font-semibold",children:"Error:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs overflow-auto text-red-900",children:s.protectedEndpoint.error})]})]})]})]})})]})}),!s&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(v,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:'Click "Run Diagnostic" to check JWT token details'})]})]})]})})]})]})}export{He as DeveloperTools,He as default};
