import{h as P,u as R,a0 as M,w as ne,r as a,j as e,X as re,W as m,a5 as w,y as z,G as v,f as h,B as I,D as W,a6 as oe,a7 as le,a8 as ce,N as de,a9 as me,aa as he,ab as xe}from"./index-o4gpx1In.js";import{D as fe}from"./DeploymentEnvironmentSelector-CZJQg9vf.js";import{L,A as ge}from"./layout-dashboard-D0li_3uv.js";import{F as U}from"./folder-open-D1jRL6ek.js";import{B as ue}from"./bell-DyragHaS.js";import{S as pe}from"./shopping-cart-CTiWwgHQ.js";import{U as H}from"./users-BcVQ6wgG.js";import{C as X}from"./chart-column-CYBxF3km.js";import{G as be}from"./gift-4Bm6fXqj.js";import{G as je}from"./git-branch-CBiuZLIV.js";import{P as we}from"./panels-top-left-BzMLaiVx.js";import{M as O}from"./mail-qbw95uc6.js";import{S as N}from"./shield-Bpl7O2Ou.js";import{F as y}from"./file-text-CrnoVonQ.js";import{W as ve}from"./wrench-CmLSeQHU.js";import{A as Ne}from"./activity-Cw-Sm8QH.js";import{T as ye}from"./test-tube-diagonal-DjEIxaff.js";import{L as Ce}from"./loader-circle-DEMR-8fp.js";import"./server-CpAJWXWF.js";const Se="https://figma-alpha-api.s3.us-west-2.amazonaws.com/images/212120daf4ca7893a2036877eb5d3cdd4c0ad83f.png",T=[{name:"Dashboard",href:"/admin/client-dashboard",icon:L},{name:"Client Settings",href:"/admin/clients",icon:z},{name:"Employee Management",href:"/admin/employees",icon:H},{name:"Reports",href:"/admin/reports",icon:X},{name:"All Clients",href:"/admin/clients",icon:I}],F=[{name:"Gift Catalog",href:"/admin/gifts",icon:be},{name:"Catalog Management",href:"/admin/catalogs",icon:U},{name:"Catalog Migration",href:"/admin/catalogs/migrate",icon:je},{name:"Home Page Editor",href:"/admin/home-editor",icon:we},{name:"Global Template Library",href:"/admin/global-template-library",icon:O},{name:"Email Service Test",href:"/admin/email-service-test",icon:O},{name:"ERP Integrations",href:"/admin/erp",icon:W},{name:"Analytics",href:"/admin/analytics",icon:X},{name:"Admin Users",href:"/admin/user-management",icon:N},{name:"RBAC Overview",href:"/admin/rbac-overview",icon:N},{name:"Roles",href:"/admin/roles",icon:N},{name:"Access Groups",href:"/admin/access-groups",icon:H},{name:"Import/Export Settings",href:"/admin/import-export-settings",icon:ge},{name:"Application Documentation",href:"/admin/application-documentation",icon:y}],G=[{name:"Admin Dashboard",href:"/admin/system-dashboard",icon:L},{name:"Developer Tools",href:"/admin/developer-tools",icon:Ne},{name:"Testing Dashboard",href:"/admin/testing-dashboard",icon:ye},{name:"Test Data Reference",href:"/admin/test-data-reference",icon:y},{name:"Development Documentation",href:"/admin/development-documentation",icon:y},{name:"Audit Logs",href:"/admin/audit-logs",icon:y}],$=[{name:"Site Dashboard",href:"/admin/dashboard",icon:L},{name:"Site Configuration",href:"/admin/site-configuration",icon:z},{name:"Site Catalog",href:"/admin/site-catalog-configuration",icon:U},{name:"Notifications",href:"/admin/email-notification-configuration",icon:ue},{name:"Order Management",href:"/admin/orders",icon:pe},{name:"All Sites",href:"/admin/sites",icon:v}];function De(){var B;const n=P(),C=R(),{adminUser:c,adminLogout:_}=M(),{currentSite:r,currentClient:o,sites:S,clients:D,setCurrentSite:q,setCurrentClient:Ae,getClientById:J,isLoading:K}=ne(),[x,f]=a.useState(!1),[l,d]=a.useState(!1),[ke,Le]=a.useState(!1),[A,Q]=a.useState("all"),[g,V]=a.useState(!0),[u,Y]=a.useState(!0),[p,Z]=a.useState(!0),[b,ee]=a.useState(!1),k=a.useRef(null),te=()=>f(!x),se=()=>{_(),C("/admin/login")},j=t=>n.pathname===t||n.pathname.startsWith(t+"/"),ae=t=>{q(t),d(!1)};a.useEffect(()=>{const t=s=>{s.key==="Escape"&&(l?d(!1):x&&f(!1))};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[l,x]),a.useEffect(()=>{const t=s=>{k.current&&!k.current.contains(s.target)&&d(!1)};if(l)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[l]);const E=A==="all"?S:S.filter(t=>t.clientId===A),ie=[...T,...F,...G,...$];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[x&&e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 z-40 lg:hidden",onClick:()=>f(!1)}),e.jsx("aside",{"aria-label":"Admin navigation",className:`fixed inset-y-0 left-0 z-50 w-64 bg-[#1B2A5E] transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${x?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Se,alt:"HALO Logo",className:"h-8 w-auto object-contain",style:{filter:"brightness(0) invert(1)"}}),e.jsx("span",{className:"text-white text-sm font-semibold",children:"Admin"})]}),e.jsx("button",{onClick:()=>f(!1),className:"lg:hidden text-white hover:text-white/80 transition-colors","aria-label":"Close sidebar",children:e.jsx(re,{className:"w-6 h-6"})})]}),e.jsxs("nav",{className:"flex-1 px-3 py-4 overflow-y-auto",children:[r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>V(!g),className:"w-full flex items-center justify-between px-4 mb-2 hover:bg-white/5 rounded-lg py-2 transition-colors group","aria-expanded":g,children:[e.jsx("h3",{className:"text-xs font-semibold text-white uppercase tracking-wider",children:"Site Settings"}),g?e.jsx(m,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"}):e.jsx(w,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${g?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("nav",{className:"px-2 space-y-1 mb-4",children:$.map(t=>{const s=j(t.href);return e.jsxs(h,{to:t.href,"aria-current":s?"page":void 0,className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-[#1B2A5E] ${s?"bg-[#D91C81] text-white":"text-white hover:bg-white/10"}`,children:[e.jsx(t.icon,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:t.name})]},t.name)})})}),e.jsx("div",{className:"my-3 border-t border-white/10"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-3 mb-4 bg-[#D91C81]/20 rounded-lg border border-[#D91C81]/30",children:[e.jsx("p",{className:"text-xs font-semibold text-white mb-1",children:"No Site Selected"}),e.jsx("p",{className:"text-xs text-white/80",children:'Click "Select Site" in the top-right to choose a site and access site-specific settings.'})]}),e.jsx("div",{className:"my-3 border-t border-white/10"})]}),e.jsxs("button",{onClick:()=>Y(!u),className:"w-full flex items-center justify-between px-4 mb-2 hover:bg-white/5 rounded-lg py-2 transition-colors group","aria-expanded":u,children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("h3",{className:"text-xs font-semibold text-white uppercase tracking-wider",children:"Client Settings"}),o&&e.jsx("span",{className:"text-xs text-white/60 mt-0.5 normal-case",children:o.name})]}),u?e.jsx(m,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"}):e.jsx(w,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${u?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("nav",{className:"px-2 space-y-1 mb-4",children:T.map(t=>{const s=t.name==="Client Settings"&&o?`/admin/clients/${o.id}`:t.href;let i;return t.name==="All Clients"?i=n.pathname==="/admin/clients":t.name==="Client Settings"?i=/^\/admin\/clients\/[^/]+/.test(n.pathname):i=j(s),e.jsxs(h,{to:s,"aria-current":i?"page":void 0,className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-[#1B2A5E] ${i?"bg-[#D91C81] text-white":"text-white hover:bg-white/10"}`,children:[e.jsx(t.icon,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:t.name})]},t.name)})})}),e.jsx("div",{className:"my-3 border-t border-white/10"}),e.jsxs("button",{onClick:()=>Z(!p),className:"w-full flex items-center justify-between px-4 mb-2 hover:bg-white/5 rounded-lg py-2 transition-colors group","aria-expanded":p,children:[e.jsx("h3",{className:"text-xs font-semibold text-white uppercase tracking-wider",children:"Global Settings"}),p?e.jsx(m,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"}):e.jsx(w,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${p?"max-h-[800px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("nav",{className:"px-2 space-y-1 mb-4",children:F.map(t=>{const s=j(t.href);return e.jsxs(h,{to:t.href,"aria-current":s?"page":void 0,className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-[#1B2A5E] ${s?"bg-[#D91C81] text-white":"text-white hover:bg-white/10"}`,children:[e.jsx(t.icon,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:t.name})]},t.name)})})}),e.jsx("div",{className:"my-3 border-t border-white/10"}),e.jsxs("button",{onClick:()=>ee(!b),className:"w-full flex items-center justify-between px-4 mb-2 hover:bg-white/5 rounded-lg py-2 transition-colors group","aria-expanded":b,children:[e.jsxs("h3",{className:"text-xs font-semibold text-white uppercase tracking-wider flex items-center gap-2",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),"Developer Tools"]}),b?e.jsx(m,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"}):e.jsx(w,{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${b?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("nav",{className:"px-2 space-y-1 mb-4",children:G.map(t=>{const s=j(t.href);return e.jsxs(h,{to:t.href,"aria-current":s?"page":void 0,className:`flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-[#1B2A5E] ${s?"bg-[#D91C81] text-white":"text-white hover:bg-white/10"}`,children:[e.jsx(t.icon,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:t.name})]},t.name)})})})]}),e.jsx("div",{className:"px-6 py-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#D91C81] rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium text-sm truncate",children:c==null?void 0:c.username}),e.jsx("p",{className:"text-white/60 text-xs capitalize",children:c==null?void 0:c.role.replace("_"," ")})]})]})}),e.jsx("div",{className:"p-3 border-t border-white/10",children:e.jsxs("button",{onClick:se,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Logout"})]})})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsxs("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 h-16 flex items-center px-4 lg:px-8",children:[e.jsx("button",{onClick:te,className:"lg:hidden mr-4 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Open sidebar",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:((B=ie.find(t=>t.href===n.pathname))==null?void 0:B.name)||"Admin Panel"}),e.jsx(fe,{variant:"header"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative",ref:k,children:[e.jsx("button",{onClick:()=>d(!l),"aria-label":"Select site","aria-expanded":l,"aria-haspopup":"listbox",className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white rounded-lg hover:shadow-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#D91C81] focus:ring-offset-2",children:K?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-semibold hidden sm:inline",children:"Loading..."})]}):r&&o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-white text-xs font-bold",style:{color:r.branding.primaryColor},"aria-hidden":"true",children:o.name.substring(0,2).toUpperCase()}),e.jsxs("div",{className:"hidden sm:flex flex-col items-start",children:[e.jsx("span",{className:"text-xs font-medium opacity-90",children:o.name}),e.jsx("span",{className:"text-sm font-bold",children:r.name})]}),e.jsx(m,{className:"w-4 h-4 ml-1","aria-hidden":"true"})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-semibold hidden sm:inline",children:"Select Site"}),e.jsx(m,{className:"w-4 h-4","aria-hidden":"true"})]})}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1),"aria-hidden":"true"}),e.jsxs("div",{role:"listbox","aria-label":"Available sites",className:"absolute right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 max-h-[32rem] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-[#D91C81] to-[#B71569]",children:[e.jsx("p",{className:"text-sm font-bold text-white",children:"Site Selection"}),e.jsx("p",{className:"text-xs text-white/80 mt-1",children:"Choose a client and site to manage"})]}),D.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("label",{htmlFor:"client-filter",className:"block text-xs font-semibold text-gray-700 mb-2",children:"Filter by Client"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsxs("select",{id:"client-filter",value:A,onChange:t=>Q(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 transition-all outline-none",children:[e.jsxs("option",{value:"all",children:["All Clients (",D.length,")"]}),D.map(t=>{const s=S.filter(i=>i.clientId===t.id).length;return e.jsxs("option",{value:t.id,children:[t.name," (",s," ",s===1?"site":"sites",")"]},t.id)})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:E.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"No sites available"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-3",children:"Create a site or seed test data"}),e.jsxs(h,{to:"/admin/developer-tools",className:"inline-flex items-center gap-2 text-xs px-3 py-1.5 bg-[#D91C81] text-white rounded-lg hover:bg-[#B01669] transition-colors",children:[e.jsx(W,{className:"w-3 h-3"}),"Seed Test Data"]})]}):e.jsx("div",{className:"space-y-1",children:E.map(t=>{const s=J(t.clientId),i=(r==null?void 0:r.id)===t.id;return e.jsxs("button",{role:"option","aria-selected":i,onClick:()=>ae(t),className:`w-full flex items-center gap-3 p-3 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#D91C81] focus:ring-inset ${i?"bg-gradient-to-r from-pink-50 to-purple-50 border-2 border-[#D91C81] shadow-sm":"hover:bg-gray-50 border-2 border-transparent"}`,children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold flex-shrink-0 shadow-sm",style:{backgroundColor:t.branding.primaryColor},"aria-hidden":"true",children:s?s.name.substring(0,2).toUpperCase():"NA"}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm truncate",children:t.name}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:(s==null?void 0:s.name)||"Unknown Client"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${t.status==="active"?"bg-green-100 text-green-700":t.status==="inactive"?"bg-gray-100 text-gray-700":"bg-yellow-100 text-yellow-700"}`,children:t.status}),e.jsx("span",{className:"text-xs text-gray-500",children:t.domain})]})]}),i&&e.jsx("div",{className:"w-2 h-2 bg-[#D91C81] rounded-full animate-pulse","aria-label":"Currently selected"})]},t.id)})})}),e.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:e.jsxs(h,{to:"/admin/sites",onClick:()=>d(!1),className:"flex items-center justify-center gap-2 w-full p-2.5 text-sm font-bold text-white bg-gradient-to-r from-[#D91C81] to-[#B71569] hover:shadow-lg rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#D91C81] focus:ring-offset-2",children:[e.jsx(v,{className:"w-4 h-4","aria-hidden":"true"}),"Manage All Sites"]})})]})]})]})})]})]}),e.jsx("main",{className:"p-4 lg:p-8",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(ce,{})})})]})]})}function Ke(){const{isAdminAuthenticated:n,isLoading:C}=M();return R(),P(),C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"w-12 h-12 animate-spin text-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Loading..."})]})}):n?e.jsx(me,{children:e.jsx(he,{children:e.jsx(xe,{children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading..."})]})}),children:e.jsx(De,{})})})})}):e.jsx(de,{to:"/admin/login",replace:!0})}export{Ke as AdminLayoutWrapper};
