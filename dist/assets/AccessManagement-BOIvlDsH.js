const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/proxyLoginApi-DESkGZiP.js","assets/supabase-CKmDi08e.js","assets/index-BO2tctDo.js","assets/index-dV4Uttrq.js","assets/index-DmH8kKeQ.css","assets/index-DS1l-0-y.js","assets/index-Bnc4558u.js","assets/exceljs.min-YwBJtYY3.js","assets/fileSecurityHelpers-CSk_xi4i.js","assets/dialog-BOcbCdZI.js","assets/index-Ttf8ZMtO.js","assets/index-C8MzEdCL.js","assets/index-DJFIPDZ_.js","assets/index-faiGe14u.js","assets/badge-hStN7-Ju.js","assets/tabs-DGJXxrgD.js","assets/index-DYppfwNE.js","assets/index-DS-6jgr9.js","assets/alert-DuWbj2LH.js","assets/users-DibFapgP.js","assets/upload-BBB967fQ.js","assets/download-CZmMXIZR.js","assets/file-spreadsheet-CMZQL9uR.js","assets/circle-check-big-BTbhA0uw.js","assets/circle-x-CrdKUO8e.js","assets/circle-alert-DNo9lQw-.js","assets/file-text-DnvqV_SC.js","assets/loader-circle-BpaB5MSO.js","assets/square-pen-BiMIh-Tu.js","assets/key-DTxr6Nxn.js","assets/eye-off-DmeI3nVv.js","assets/eye-CnbqyKZE.js","assets/plus-DUZUgypq.js","assets/mail-HBGoXm34.js","assets/trash-2-B2VV2ZDP.js","assets/id-card-BpLNM96h.js","assets/credit-card-UgC4ysmM.js"])))=>i.map(i=>d[i]);
import{m as Me,r as u,j as e,C as f,t as p,l as M,am as Ue,g as be,w as Re,c as $e,S as Y,U as Be,X as we,a7 as Te,q as Oe,G as Ve,a1 as ze}from"./index-dV4Uttrq.js";import{E as xe}from"./exceljs.min-YwBJtYY3.js";import{s as Je,p as Xe}from"./fileSecurityHelpers-CSk_xi4i.js";import{D as We,a as qe,b as Ge,c as Ze,d as He,e as Qe}from"./dialog-BOcbCdZI.js";import{B as K}from"./badge-hStN7-Ju.js";import{T as Ye,a as Ke,b as ge,c as fe}from"./tabs-DGJXxrgD.js";import{A as te,b as re}from"./alert-DuWbj2LH.js";import{U as Ne}from"./users-DibFapgP.js";import{U as z}from"./upload-BBB967fQ.js";import{D as ee}from"./download-CZmMXIZR.js";import{F as es}from"./file-spreadsheet-CMZQL9uR.js";import{C as ss}from"./circle-check-big-BTbhA0uw.js";import{C as as}from"./circle-x-CrdKUO8e.js";import{C as le}from"./circle-alert-DNo9lQw-.js";import{F as ts}from"./file-text-DnvqV_SC.js";import{L as ie}from"./loader-circle-BpaB5MSO.js";import{S as se}from"./square-pen-BiMIh-Tu.js";import{K as rs}from"./key-DTxr6Nxn.js";import{E as ls}from"./eye-off-DmeI3nVv.js";import{E as is}from"./eye-CnbqyKZE.js";import{s as U}from"./supabase-CKmDi08e.js";import{P as ce}from"./plus-DUZUgypq.js";import{M as ye}from"./mail-HBGoXm34.js";import{T as me}from"./trash-2-B2VV2ZDP.js";import{I as os}from"./id-card-BpLNM96h.js";import{C as ns}from"./credit-card-UgC4ysmM.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],cs=Me("user-check",ds);function ms({open:a,onClose:t,validationType:s,onImport:l}){const[i,n]=u.useState(!1),[d,g]=u.useState([]),[y,h]=u.useState({valid:0,errors:0,duplicates:0}),N=u.useRef(null),k=async o=>{var A;const w=(A=o.target.files)==null?void 0:A[0];if(w){n(!0);try{const L=await w.arrayBuffer(),R=new xe.Workbook;await R.xlsx.load(L);let v=R.getWorksheet(1).getSheetValues();v=Je(v);const I=Xe(w,v,{maxSizeMB:5,allowedExtensions:[".csv",".xlsx",".xls"],maxRows:1e4,maxCellLength:500});if(!I.isValid){p.error(`Security validation failed: ${I.errors.join(", ")}`),M.error("File security check failed:",I.errors);return}I.warnings.length>0&&M.warn("File security warnings:",I.warnings);const P=v.slice(1).filter(x=>Array.isArray(x)&&x.length>0).map((x,ne)=>{const F=x,j={id:`temp-${ne}`,email:F[1]||"",employeeId:F[2]||"",firstName:F[3]||"",lastName:F[4]||"",department:F[5]||"",serialCard:F[6]||"",status:"valid"};return(s==="email"||s==="magicLink")&&(!j.email||!m(j.email))&&(j.status="error",j.errorMessage="Invalid or missing email address"),s==="employeeId"&&(j.employeeId||(j.status="error",j.errorMessage="Missing employee ID"),(!j.email||!m(j.email))&&(j.status="error",j.errorMessage="Invalid or missing email address")),s==="serialCard"&&(j.serialCard||(j.status="error",j.errorMessage="Missing serial card number")),j}),O=new Set,$=new Set,q=new Set;P.forEach(x=>{x.email&&O.has(x.email.toLowerCase())?(x.status="duplicate",x.errorMessage="Duplicate email address"):x.email&&O.add(x.email.toLowerCase()),x.employeeId&&$.has(x.employeeId)?(x.status="duplicate",x.errorMessage="Duplicate employee ID"):x.employeeId&&$.add(x.employeeId),x.serialCard&&q.has(x.serialCard)?(x.status="duplicate",x.errorMessage="Duplicate serial card"):x.serialCard&&q.add(x.serialCard)});const G=P.filter(x=>x.status==="valid").length,oe=P.filter(x=>x.status==="error").length,Z=P.filter(x=>x.status==="duplicate").length;g(P),h({valid:G,errors:oe,duplicates:Z}),p.success(`Processed ${P.length} records`)}catch(L){M.error("Import error:",L),p.error("Failed to process file. Please check the format.")}finally{n(!1)}}},m=o=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o),D=()=>{const o=d.filter(w=>w.status==="valid");l(o),p.success(`Imported ${o.length} employee records`),E()},E=()=>{g([]),h({valid:0,errors:0,duplicates:0}),N.current&&(N.current.value=""),t()},W=async()=>{let o=[];s==="email"||s==="magicLink"?o=[{Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]:s==="employeeId"?o=[{"Employee ID":"EMP001",Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{"Employee ID":"EMP002",Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]:s==="serialCard"&&(o=[{"Serial Card":"CARD-ABC123XYZ",Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{"Serial Card":"CARD-DEF456UVW",Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]);try{const w=new xe.Workbook,A=w.addWorksheet("Employees");if(o.length>0){const v=Object.keys(o[0]);A.addRow(v),o.forEach(P=>{A.addRow(Object.values(P))});const I=A.getRow(1);I.font={bold:!0},I.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD91C81"}}}const L=await w.xlsx.writeBuffer(),R=new Blob([L],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),b=document.createElement("a");b.href=URL.createObjectURL(R),b.download=`employee_import_template_${s}.xlsx`,b.click(),p.success("Template downloaded")}catch(w){M.error("Template download error:",w),p.error("Failed to download template")}},S=()=>{switch(s){case"email":return"Email Address";case"employeeId":return"Employee ID";case"serialCard":return"Serial Card";case"magicLink":return"Email Address";default:return"Identifier"}};return e.jsx(We,{open:a,onOpenChange:E,children:e.jsxs(qe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ge,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-[#D91C81]"}),"Import Employee Data"]}),e.jsxs(He,{children:["Upload a CSV or Excel file to import employee records for ",S()," validation"]})]}),e.jsxs(Ye,{defaultValue:"upload",className:"mt-4",children:[e.jsxs(Ke,{className:"grid w-full grid-cols-2",children:[e.jsx(ge,{value:"upload",children:"Upload File"}),e.jsx(ge,{value:"instructions",children:"Instructions"})]}),e.jsxs(fe,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-[#D91C81] transition-colors",children:[e.jsx("input",{ref:N,type:"file",accept:".csv,.xlsx,.xls",onChange:k,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-sm text-gray-600",children:"CSV, XLSX, or XLS files (max 5MB)"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:W,className:"flex-1",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>{var o;return(o=N.current)==null?void 0:o.click()},className:"flex-1",children:[e.jsx(es,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ss,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-semibold text-green-900",children:"Valid Records"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:y.valid})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-sm font-semibold text-red-900",children:"Errors"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:y.errors})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"text-sm font-semibold text-yellow-900",children:"Duplicates"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:y.duplicates})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Preview (",d.length," records)"]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Status"}),s!=="email"&&s!=="magicLink"&&e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:S()}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Department"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.slice(0,100).map((o,w)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-2",children:[o.status==="valid"&&e.jsx(K,{className:"bg-green-100 text-green-800",children:"Valid"}),o.status==="error"&&e.jsx(K,{className:"bg-red-100 text-red-800",children:"Error"}),o.status==="duplicate"&&e.jsx(K,{className:"bg-yellow-100 text-yellow-800",children:"Duplicate"})]}),s==="employeeId"&&e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:o.employeeId}),s==="serialCard"&&e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:o.serialCard}),e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:o.email}),e.jsxs("td",{className:"px-4 py-2",children:[o.firstName," ",o.lastName]}),e.jsx("td",{className:"px-4 py-2",children:o.department})]},w))})]})}),d.length>100&&e.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-t border-gray-200 text-sm text-gray-600",children:["Showing first 100 of ",d.length," records"]})]}),y.errors>0&&e.jsxs(te,{children:[e.jsx(le,{className:"h-4 w-4"}),e.jsxs(re,{children:[y.errors," record(s) have validation errors and will not be imported.",y.duplicates>0&&` ${y.duplicates} duplicate(s) detected.`]})]})]})]}),e.jsxs(fe,{value:"instructions",className:"space-y-4",children:[e.jsxs(te,{children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx(re,{children:"Follow these guidelines to ensure successful import"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Required Columns"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[s==="email"||s==="magicLink"?e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (required)"]}):null,s==="employeeId"?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Employee ID"})," - Unique employee identifier (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (required)"]})]}):null,s==="serialCard"?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Serial Card"})," - Unique card number (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (optional but recommended)"]})]}):null]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Optional Columns"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"First Name"})," - Employee first name"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Last Name"})," - Employee last name"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Department"})," - Department or team name"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"File Format"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:"Supported formats: CSV, XLSX, XLS"}),e.jsx("li",{children:"First row must contain column headers"}),e.jsx("li",{children:"Column names are case-insensitive"}),e.jsx("li",{children:"Maximum file size: 5MB"}),e.jsx("li",{children:"Recommended maximum: 10,000 records per file"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Validation Rules"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:"Email addresses must be valid format"}),e.jsx("li",{children:"Duplicate entries within the file will be flagged"}),e.jsx("li",{children:"All required fields must have values"}),e.jsx("li",{children:"Empty rows will be skipped"})]})]})]})]})]}),e.jsxs(Qe,{children:[e.jsx(f,{variant:"outline",onClick:E,children:"Cancel"}),d.length>0&&y.valid>0&&e.jsx(f,{onClick:D,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Import ",y.valid," Records"]})})]})]})})}function xs(){const t=be().supabaseUrl.match(/https:\/\/([^.]+)\.supabase\.co/);return`https://${t?t[1]:Re}.supabase.co/functions/v1/make-server-6fcaeea3`}async function X(a,t={}){const l=`${xs()}${a}`,i=Ue();if(!i)throw new Error("Authentication required");const n={"Content-Type":"application/json","X-Access-Token":i,Authorization:`Bearer ${i}`,...t.headers||{}},d=be();n["X-Environment-ID"]=d.id;const g=await fetch(l,{...t,headers:n}),y=await g.json();if(!g.ok)throw new Error(y.error||`Request failed with status ${g.status}`);return y}async function us(a){return(await X(`/v2/employees?site_id=${a}`)).data}async function hs(a,t){return(await X("/v2/employees",{method:"POST",body:JSON.stringify({site_id:a,...t})})).data}async function ps(a,t,s){return(await X(`/v2/employees/${a}`,{method:"PUT",body:JSON.stringify({site_id:t,...s})})).data}async function gs(a,t){await X(`/v2/employees/${a}`,{method:"DELETE"})}async function fs(a,t){const s=await X("/v2/employees/bulk-import",{method:"POST",body:JSON.stringify({site_id:a,employees:t})});return{imported:s.imported,errors:s.errors,employees:s.employees}}function ue(){const{currentLanguage:a}=$e(),t=a.code,s=(i,n,d)=>["ja","zh","zh-TW","ko"].includes(t)?d?`${n} ${d} ${i}`:`${n} ${i}`:d?`${i} ${d} ${n}`:`${i} ${n}`;return{formatFullName:s,formatFormalName:(i,n,d)=>{const g=s(i,n);return d?`${d} ${g}`:g}}}function ys({users:a,loading:t,onEditUser:s,onSetPassword:l,onProxyLogin:i,hasProxyPermission:n}){const[d,g]=u.useState(""),{formatFullName:y}=ue(),h=a.filter(m=>{var E;const D=d.toLowerCase();return m.email.toLowerCase().includes(D)||m.firstName.toLowerCase().includes(D)||m.lastName.toLowerCase().includes(D)||((E=m.employeeId)==null?void 0:E.toLowerCase().includes(D))}),N=m=>{switch(m){case"admin":return"bg-red-100 text-red-800 border-red-200";case"manager":return"bg-blue-100 text-blue-800 border-blue-200";case"employee":return"bg-green-100 text-green-800 border-green-200";case"viewer":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},k=m=>{switch(m){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-gray-100 text-gray-800 border-gray-200";case"suspended":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users by name, email, or employee ID...",value:d,onChange:m=>g(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),t?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"w-8 h-8 text-[#D91C81] animate-spin"})}):h.length===0?e.jsxs("div",{className:"text-center py-12 border border-gray-200 rounded-lg",children:[e.jsx(Be,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No users found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:d?`No users matching "${d}"`:"Users will appear here when added"})]}):e.jsx("div",{className:"space-y-2",children:h.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[#D91C81] to-purple-600 flex items-center justify-center text-white font-semibold",children:[m.firstName[0],m.lastName[0]]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:y(m.firstName,m.lastName)}),e.jsx("p",{className:"text-sm text-gray-600",children:m.email}),e.jsxs("div",{className:"flex gap-2 mt-1 flex-wrap",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${N(m.role)}`,children:m.role}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${k(m.status)}`,children:m.status}),m.employeeId&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full border bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",m.employeeId]}),m.forcePasswordReset&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full border bg-amber-100 text-amber-800 border-amber-200",children:"Password Reset Required"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>s(m),className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),"Edit"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>l(m),className:"flex items-center gap-1",children:[e.jsx(rs,{className:"w-4 h-4"}),"Set Password"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>i(m),disabled:!n,className:"flex items-center gap-1",title:n?"Login as this user":"You do not have permission to proxy login",children:[e.jsx(cs,{className:"w-4 h-4"}),"Login As"]})]})]},m.id))}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600",children:e.jsxs("p",{children:[h.length," user",h.length!==1?"s":"",d&&` matching "${d}"`]})})]})}function js({open:a,user:t,onClose:s,onSave:l}){const[i,n]=u.useState({firstName:"",lastName:"",email:"",employeeId:"",role:"employee",status:"active"}),[d,g]=u.useState(!1);u.useEffect(()=>{t&&n({firstName:t.firstName,lastName:t.lastName,email:t.email,employeeId:t.employeeId||"",role:t.role,status:t.status})},[t]);const y=async()=>{if(t){g(!0);try{await l(t.id,i),s()}catch(h){console.error("Failed to save user:",h)}finally{g(!1)}}};return!a||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(we,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.firstName,onChange:h=>n({...i,firstName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"John"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.lastName,onChange:h=>n({...i,lastName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"Doe"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:i.email,onChange:h=>n({...i,email:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"john.doe@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),e.jsx("input",{type:"text",value:i.employeeId,onChange:h=>n({...i,employeeId:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"EMP-001"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.role,onChange:h=>n({...i,role:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Determines user permissions and access level"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.status,onChange:h=>n({...i,status:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active users can login, inactive users cannot"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:s,disabled:d,className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void y(),disabled:d||!i.firstName||!i.lastName||!i.email,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:d?"Saving...":"Save Changes"})]})]})})}function ae(a){const t=[];let s=0;a.length<12?t.push("Password must be at least 12 characters long"):(s+=20,a.length>=16&&(s+=10),a.length>=20&&(s+=10)),/[A-Z]/.test(a)?s+=15:t.push("Password must contain at least one uppercase letter"),/[a-z]/.test(a)?s+=15:t.push("Password must contain at least one lowercase letter"),/[0-9]/.test(a)?s+=15:t.push("Password must contain at least one number"),/[^A-Za-z0-9]/.test(a)?s+=15:t.push("Password must contain at least one special character");const l=[/^password/i,/^admin/i,/^welcome/i,/^qwerty/i,/123456/,/^abc/i];for(const d of l)if(d.test(a)){t.push("Password contains common patterns. Please choose a more unique password"),s-=20;break}/(.)\1{2,}/.test(a)&&(t.push("Password contains too many repeated characters"),s-=10),/abc|bcd|cde|def|123|234|345|456/i.test(a)&&(t.push("Password contains sequential characters"),s-=10),new Set(a).size>=a.length*.7&&(s+=10),s=Math.max(0,Math.min(100,s));let n;return s<40?n="weak":s<60?n="fair":s<80?n="good":n="strong",{valid:t.length===0,errors:t,strength:n,score:s}}function je(a=16){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s="abcdefghijklmnopqrstuvwxyz",l="0123456789",i="!@#$%^&*()_+-=[]{}|;:,.<>?",n=t+s+l+i;let d="";d+=t[Math.floor(Math.random()*t.length)],d+=s[Math.floor(Math.random()*s.length)],d+=l[Math.floor(Math.random()*l.length)],d+=i[Math.floor(Math.random()*i.length)];for(let g=d.length;g<a;g++)d+=n[Math.floor(Math.random()*n.length)];return d.split("").sort(()=>Math.random()-.5).join("")}function bs(a){switch(a){case"weak":return"text-red-600";case"fair":return"text-orange-600";case"good":return"text-yellow-600";case"strong":return"text-green-600"}}function ws(a){switch(a){case"weak":return"bg-red-500";case"fair":return"bg-orange-500";case"good":return"bg-yellow-500";case"strong":return"bg-green-500"}}function Ns({password:a,showErrors:t=!0}){const[s,l]=u.useState(ae(""));return u.useEffect(()=>{l(ae(a||""))},[a]),a?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Password Strength:"}),e.jsx("span",{className:`font-semibold ${bs(s.strength)}`,children:s.strength.charAt(0).toUpperCase()+s.strength.slice(1)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${ws(s.strength)}`,style:{width:`${s.score}%`}})})]}),t&&s.errors.length>0&&e.jsx("div",{className:"space-y-1",children:s.errors.map((i,n)=>e.jsxs("p",{className:"text-sm text-red-600 flex items-start gap-1",children:[e.jsx("span",{className:"text-red-500 mt-0.5",children:"â€¢"}),e.jsx("span",{children:i})]},n))}),s.valid&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Password meets all requirements"]})]}):null}function vs({open:a,user:t,onClose:s,onSetPassword:l}){const[i,n]=u.useState(""),[d,g]=u.useState(!0),[y,h]=u.useState(!1),[N,k]=u.useState(!1),{formatFullName:m}=ue();u.useEffect(()=>{a&&(n(je(16)),g(!0),h(!1))},[a]);const D=()=>{n(je(16)),h(!0)},E=async()=>{if(!(!t||!i)){k(!0);try{await l(t.id,i,d),s()}catch(o){console.error("Failed to set password:",o)}finally{k(!1)}}},S=ae(i).valid;return!a||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Set Temporary Password"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["For ",m(t.firstName,t.lastName)]})]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(we,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Temporary Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",value:i,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 pr-20 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none font-mono text-sm",placeholder:"Enter password"}),e.jsx("button",{type:"button",onClick:()=>h(!y),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded transition-colors",children:y?e.jsx(ls,{className:"w-4 h-4 text-gray-500"}):e.jsx(is,{className:"w-4 h-4 text-gray-500"})})]}),i&&e.jsx("div",{className:"mt-3",children:e.jsx(Ns,{password:i,showErrors:!0})})]}),e.jsxs(f,{variant:"outline",onClick:D,className:"w-full flex items-center justify-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Generate Random Password"]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"forceReset",checked:d,onChange:o=>g(o.target.checked),className:"mt-0.5 w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"forceReset",className:"text-sm text-gray-700 cursor-pointer",children:"Force user to reset password on next login"})]}),e.jsxs(te,{variant:"default",className:"bg-blue-50 border-blue-200",children:[e.jsx(le,{className:"w-4 h-4 text-blue-600"}),e.jsxs(re,{className:"text-sm text-blue-900",children:["The temporary password will be sent to the user's email address (",t.email,").",d&&" They will be required to change it on their first login."]})]}),!d&&e.jsxs(te,{variant:"default",className:"bg-amber-50 border-amber-200",children:[e.jsx(le,{className:"w-4 h-4 text-amber-600"}),e.jsx(re,{className:"text-sm text-amber-900",children:"For security, it's recommended to force password reset on first login."})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:s,disabled:N,className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void E(),disabled:N||!S,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:N?"Setting Password...":"Set Password"})]})]})})}async function he(a){try{M.info("[auditLogService] Creating audit log",{eventType:a.eventType,userId:a.userId,siteId:a.siteId});const t=a.ipAddress||await ks(),s=a.userAgent||navigator.userAgent,{error:l}=await U.from("audit_logs").insert({event_type:a.eventType,user_id:a.userId,site_id:a.siteId,target_user_id:a.targetUserId,ip_address:t,user_agent:s,details:a.details||{},severity:a.severity||"medium",created_at:new Date().toISOString()});l?M.error("[auditLogService] Error creating audit log:",l):M.info("[auditLogService] Audit log created successfully")}catch(t){M.error("[auditLogService] Exception creating audit log:",t)}}async function Cs(a,t,s,l){await he({eventType:"user_edited",userId:a,targetUserId:t,siteId:s,details:{changes:l,timestamp:new Date().toISOString()},severity:"low"})}async function aa(a,t,s,l){await he({eventType:"proxy_login_started",userId:a,targetUserId:t,siteId:s,details:{sessionId:l,timestamp:new Date().toISOString()},severity:"high"})}async function ta(a,t,s,l,i){await he({eventType:"proxy_login_ended",userId:a,targetUserId:t,siteId:s,details:{sessionId:l,duration:i,timestamp:new Date().toISOString()},severity:"medium"})}async function ks(){try{return"client-side"}catch{return"unknown"}}async function J(a){try{const{data:{user:t}}=await U.auth.getUser();if(!t)return!1;const{data:s,error:l}=await U.rpc("admin_user_has_permission",{p_admin_user_id:t.id,p_permission:a});return l?(console.error("Error checking permission:",l),!1):s===!0}catch(t){return console.error("Error checking permission:",t),!1}}async function Ds(a){const{data:t,error:s}=await U.from("site_users").select("*").eq("site_id",a).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching users:",s),new Error("Failed to fetch users");return t.map(l=>({id:l.id,email:l.email,firstName:l.first_name,lastName:l.last_name,employeeId:l.employee_id,role:l.role,status:l.status,forcePasswordReset:l.force_password_reset||!1,lastLogin:l.last_login?new Date(l.last_login):void 0,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),metadata:l.metadata}))}async function Es(a){const t=await J("user_edit"),s=await J("user_management");if(!t&&!s)throw new Error("Insufficient permissions: user_edit or user_management permission required");const l={updated_at:new Date().toISOString()};a.firstName!==void 0&&(l.first_name=a.firstName),a.lastName!==void 0&&(l.last_name=a.lastName),a.email!==void 0&&(l.email=a.email),a.employeeId!==void 0&&(l.employee_id=a.employeeId),a.role!==void 0&&(l.role=a.role),a.status!==void 0&&(l.status=a.status);const{error:i}=await U.from("site_users").update(l).eq("id",a.userId);if(i)throw console.error("Error updating user:",i),new Error("Failed to update user");const{data:{user:n}}=await U.auth.getUser();n&&a.siteId&&await Cs(n.id,a.userId,a.siteId,l)}async function Ss(a){const t=await J("user_password_set"),s=await J("user_management");if(!t&&!s)throw new Error("Insufficient permissions: user_password_set or user_management permission required");const{data:{session:l}}=await U.auth.getSession();if(!l)throw new Error("Not authenticated");const i=await fetch(`${U.supabaseUrl}/functions/v1/make-server-6fcaeea3/password-management/set`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`},body:JSON.stringify({userId:a.userId,siteId:a.siteId,temporaryPassword:a.temporaryPassword,forcePasswordReset:a.forcePasswordReset,sendEmail:a.sendEmail,expiresInHours:48})});if(!i.ok){const n=await i.json();throw new Error(n.error||"Failed to set password")}}function Is({mode:a="simple",validationMethod:t="email"}){const{currentSite:s,currentClient:l,updateSite:i}=Oe(),{formatFullName:n}=ue(),[d,g]=u.useState(!1),[y,h]=u.useState(!1),[N,k]=u.useState(null),[m,D]=u.useState([]),[E,W]=u.useState([]),[S,o]=u.useState(!1),[w,A]=u.useState(""),[L,R]=u.useState(""),[b,v]=u.useState({email:"",employeeId:"",serialCard:"",name:"",department:""}),[I,P]=u.useState([]),[O,$]=u.useState(null),[q,G]=u.useState(!1),[oe,Z]=u.useState(!1),[x,ne]=u.useState(!1);u.useEffect(()=>{(async()=>{const c=await J("proxy_login");ne(c)})()},[]),u.useEffect(()=>{if(s!=null&&s.id){a==="advanced"?F():j();const r=s.settings.allowedDomains;R(r?r.join(", "):"")}},[s==null?void 0:s.id,a]);const F=async()=>{if(s!=null&&s.id){o(!0);try{const r=await Ds(s.id);P(r)}catch(r){console.error("Failed to load users:",r),p.error("Failed to load users")}finally{o(!1)}}},j=async()=>{if(s!=null&&s.id){o(!0);try{const r=await us(s.id);W(r)}catch(r){console.error("Failed to load employees:",r),r instanceof Error&&!r.message.includes("PGRST116")&&p.error("Failed to load employees")}finally{o(!1)}}},ve=async()=>{if(s!=null&&s.id){if(!b.email&&!b.employeeId&&!b.serialCard){p.error("Please provide at least one identifier (email, employee ID, or serial card)");return}o(!0);try{await hs(s.id,b),p.success("Employee added successfully"),h(!1),v({email:"",employeeId:"",serialCard:"",name:"",department:""}),await j()}catch(r){console.error("Failed to add employee:",r),p.error("Failed to add employee")}finally{o(!1)}}},Ce=async()=>{if(!(!(s!=null&&s.id)||!N)){o(!0);try{await ps(N.id,s.id,b),p.success("Employee updated successfully"),k(null),v({email:"",employeeId:"",serialCard:"",name:"",department:""}),await j()}catch(r){console.error("Failed to update employee:",r),p.error("Failed to update employee")}finally{o(!1)}}},ke=async r=>{if(s!=null&&s.id&&confirm("Are you sure you want to deactivate this employee?")){o(!0);try{await gs(r,s.id),p.success("Employee deactivated successfully"),await j()}catch(c){console.error("Failed to delete employee:",c),p.error("Failed to delete employee")}finally{o(!1)}}},De=async r=>{if(s!=null&&s.id){o(!0);try{const c=await fs(s.id,r);D(r),p.success(`Successfully imported ${c.imported} employees`),c.errors&&c.errors.length>0&&p.warning(`${c.errors.length} records had errors`),await j()}catch(c){console.error("Failed to import employees:",c),p.error("Failed to import employees")}finally{o(!1)}}},Ee=async()=>{if(s!=null&&s.id){o(!0);try{const r=L.split(",").map(c=>c.trim()).filter(c=>c.length>0);await i(s.id,{settings:{...s.settings,allowedDomains:r}}),p.success("Allowed domains saved successfully")}catch(r){console.error("Failed to save allowed domains:",r),p.error("Failed to save allowed domains")}finally{o(!1)}}},Se=r=>{$(r),G(!0)},Ie=r=>{$(r),Z(!0)},Pe=async r=>{if(s!=null&&s.id)try{o(!0);const{createProxySession:c}=await ze(async()=>{const{createProxySession:B}=await import("./proxyLoginApi-DESkGZiP.js");return{createProxySession:B}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36])),C=await c({adminId:"",employeeId:r.id,siteId:s.id,durationMinutes:30});localStorage.setItem("proxy_session_token",C.token);const _=`${window.location.origin}/site/${s.slug}`;window.open(_,"_blank"),p.success(`Proxy session created for ${n(r.firstName,r.lastName)}`)}catch(c){console.error("Failed to create proxy session:",c),p.error("Failed to create proxy session")}finally{o(!1)}},Fe=async(r,c)=>{if(s!=null&&s.id)try{await Es({userId:r,siteId:s.id,firstName:c.firstName,lastName:c.lastName,email:c.email,employeeId:c.employeeId,role:c.role,status:c.status}),p.success("User updated successfully"),await F()}catch(C){throw console.error("Failed to update user:",C),p.error("Failed to update user"),C}},_e=async(r,c,C)=>{if(s!=null&&s.id)try{await Ss({userId:r,siteId:s.id,temporaryPassword:c,forcePasswordReset:C,sendEmail:!0}),p.success("Password set successfully. Email sent to user."),await F()}catch(_){throw console.error("Failed to set password:",_),p.error("Failed to set password"),_}},Ae=r=>{k(r),v({email:r.email||"",employeeId:r.employeeId||"",serialCard:r.serialCard||"",name:r.name||"",department:r.department||""})},H=E.filter(r=>{var C,_,B,Q,T;const c=w.toLowerCase();return((C=r.email)==null?void 0:C.toLowerCase().includes(c))||((_=r.employeeId)==null?void 0:_.toLowerCase().includes(c))||((B=r.serialCard)==null?void 0:B.toLowerCase().includes(c))||((Q=r.name)==null?void 0:Q.toLowerCase().includes(c))||((T=r.department)==null?void 0:T.toLowerCase().includes(c))}),de=()=>{const r=t;let c=[],C=[];switch(r){case"email":c=["Email Address","First Name","Last Name","Department"],C=[["john.doe@company.com","John","Doe","Engineering"],["jane.smith@company.com","Jane","Smith","Marketing"]];break;case"employeeId":c=["Employee ID","First Name","Last Name","Department"],C=[["EMP-001","John","Doe","Engineering"],["EMP-002","Jane","Smith","Marketing"]];break;case"serialCard":c=["Card Number","Employee Name","Department","Status"],C=[["CARD-ABC123XYZ","John Doe","Engineering","Active"],["CARD-DEF456UVW","Jane Smith","Marketing","Active"]];break;default:c=["Identifier","Name"],C=[["sample@email.com","Sample User"]]}const _=new xe.Workbook,B=_.addWorksheet("Template");B.addRow(c),C.forEach(T=>B.addRow(T));const Q=`${r}_import_template.xlsx`;_.xlsx.writeBuffer().then(T=>{const Le=new Blob([new Uint8Array(T)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),pe=window.URL.createObjectURL(Le),V=document.createElement("a");V.href=pe,V.download=Q,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(pe)}),p.success("Template downloaded successfully")};return!s||!l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ve,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Please select a site to manage access"})]}):e.jsxs("div",{className:"space-y-6",children:[t==="email"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Authorized Email Addresses"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[m.length," employee",m.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:de,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>g(!0),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",onClick:()=>h(!0),children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Add Email"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Allowed Domains (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"e.g., company.com, business.org",value:L,onChange:r=>R(r.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"}),e.jsx(f,{onClick:()=>void Ee(),disabled:S,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:"Save"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Comma-separated list of allowed email domains"})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search email addresses...",value:w,onChange:r=>A(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"w-8 h-8 text-[#D91C81] animate-spin"})}):H.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ye,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No employees found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add employees to manage access"})]}):e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:H.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm block",children:r.email}),r.name&&e.jsx("span",{className:"text-xs text-gray-500",children:r.name})]}),r.status==="inactive"&&e.jsx(K,{variant:"secondary",className:"text-xs",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",onClick:()=>Ae(r),children:e.jsx(se,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",onClick:()=>void ke(r.id),children:e.jsx(me,{className:"w-4 h-4 text-red-600"})})]})]},r.id))})}),e.jsx("div",{className:"mt-4 flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[H.length," employee",H.length!==1?"s":"",w&&` matching "${w}"`]})})]}),t==="employeeId"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Authorized Employee IDs"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[m.length," employee",m.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:de,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>g(!0),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Add Employee ID"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search employee IDs...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:["EMP-001","EMP-002","EMP-003","EMP-004","EMP-005"].map((r,c)=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm font-semibold",children:r})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(se,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(me,{className:"w-4 h-4 text-red-600"})})]})]},c))})})]}),t==="serialCard"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Serial Card Numbers"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[m.length," card",m.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:de,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>g(!0),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Generate Cards"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search serial numbers...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:["CARD-ABC123XYZ","CARD-DEF456UVW","CARD-GHI789RST","CARD-JKL012MNO","CARD-PQR345JKL"].map((r,c)=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ns,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm font-semibold",children:r}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full border border-green-200",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(se,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(me,{className:"w-4 h-4 text-red-600"})})]})]},c))})})]}),a==="advanced"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-[#D91C81]"}),"User Management"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage employee accounts, passwords, and permissions"})]})}),e.jsx(ys,{users:I,loading:S,onEditUser:Se,onSetPassword:Ie,onProxyLogin:Pe,hasProxyPermission:x})]}),e.jsx(ms,{open:d,onClose:()=>g(!1),validationType:t,onImport:r=>void De(r)}),(y||N)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:N?"Edit Employee":"Add Employee"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",t==="email"&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:b.email,onChange:r=>v({...b,email:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"john.doe@company.com"})]}),t==="employeeId"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b.employeeId,onChange:r=>v({...b,employeeId:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"EMP-001"})]}),t==="serialCard"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Serial Card ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b.serialCard,onChange:r=>v({...b,serialCard:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"CARD-ABC123XYZ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:b.name,onChange:r=>v({...b,name:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:b.department,onChange:r=>v({...b,department:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"Engineering"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:()=>{h(!1),k(null),v({email:"",employeeId:"",serialCard:"",name:"",department:""})},className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void(N?Ce():ve()),disabled:S,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:S?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):N?"Update":"Add"})]})]})}),e.jsx(js,{open:q,user:O,onClose:()=>{G(!1),$(null)},onSave:Fe}),e.jsx(vs,{open:oe,user:O,onClose:()=>{Z(!1),$(null)},onSetPassword:_e})]})}const ra=Object.freeze(Object.defineProperty({__proto__:null,AccessManagement:Is},Symbol.toStringTag,{value:"Module"}));export{ra as A,ta as a,J as h,aa as l};
