import{a as L,u as Q,I as T,r as o,c as A,j as e,n as I,y as G,J as w,A as B,t as f,g as O,k as P,l as F}from"./index-BKvtyMRF.js";import{L as M}from"./Logo-Dq8kqtFl.js";import{M as $}from"./minus-BLHI6CfD.js";import{P as q}from"./plus-BXSBUVwV.js";const z={maxQuantity:5};function K(){const{giftId:n}=L(),l=Q(),{selectedGift:r,quantity:u,selectGift:v,setQuantity:D}=T(),[c,d]=o.useState(1),{t:s}=A(),[a,S]=o.useState(null),[k,p]=o.useState(!0),[j,x]=o.useState(null),m=z.maxQuantity;if(o.useEffect(()=>{(async()=>{if(!n){l("/gift-selection");return}p(!0),x(null);try{const t=sessionStorage.getItem("employee_session");if(!t){f.error("Session expired. Please log in again."),l("/access");return}const g=O(),E=P(g),N=await fetch(`${E}/public/gifts/${n}`,{headers:{Authorization:`Bearer ${g.supabaseAnonKey}`,"X-Environment-ID":g.id,"X-Session-Token":t}}),h=await N.json();if(!N.ok)throw new Error(h.error||"Failed to load gift");h.gift?S(h.gift):(x("Gift not found"),f.error("Gift not found"),setTimeout(()=>l("/gift-selection"),2e3))}catch(t){F.error("Failed to load gift:",t),x(t instanceof Error?t.message:"Failed to load gift details"),f.error(t instanceof Error?t.message:"Failed to load gift"),setTimeout(()=>l("/gift-selection"),2e3)}finally{p(!1)}})()},[n,l]),o.useEffect(()=>{(r==null?void 0:r.id)===n?d(u):d(1)},[r,n,u]),!a)return null;const b=i=>{const t=c+i;t>=1&&t<=m&&d(t)},C=()=>{v(a),D(c),l("/shipping")},y=(r==null?void 0:r.id)===n;return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:s("common.loading")})]})}):j?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg font-bold mb-4",children:j}),e.jsx("p",{className:"text-gray-600",children:s("common.redirecting")})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>l("/gift-selection"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":s("common.back"),children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx("div",{className:"h-8 w-[88px]",children:e.jsx(M,{})})]}),e.jsx(G,{})]})})}),e.jsx("div",{className:"py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-lg",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"relative h-96 md:h-full bg-gray-100",children:[e.jsx("img",{src:a.image||"https://images.unsplash.com/photo-1513104890138-7c749659a591?w=800&q=80",alt:a.name,className:"w-full h-full object-cover"}),y&&e.jsxs("div",{className:"absolute top-6 right-6 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-4 py-2 rounded-full font-semibold flex items-center gap-2 shadow-lg",children:[e.jsx(w,{className:"w-5 h-5"}),s("giftDetail.currentlySelected")]})]}),e.jsxs("div",{className:"p-8 md:p-12 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"inline-block bg-pink-100 text-[#D91C81] px-4 py-2 rounded-full text-sm font-semibold",children:a.category})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:a.name}),e.jsx("p",{className:"text-lg text-gray-600 leading-relaxed mb-8",children:a.description}),e.jsxs("div",{className:"mb-8 border-t border-gray-200 pt-8",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:s("giftDetail.selectQuantity")}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:()=>b(-1),disabled:c<=1,className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center hover:bg-gray-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx($,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"text-center min-w-[80px]",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900",children:c}),e.jsx("div",{className:"text-sm text-gray-500",children:s(c===1?"giftDetail.item":"giftDetail.items")})]}),e.jsx("button",{onClick:()=>b(1),disabled:c>=m,className:"w-12 h-12 bg-gradient-to-r from-[#D91C81] to-[#B71569] rounded-xl flex items-center justify-center hover:shadow-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx(q,{className:"w-5 h-5 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:[s("giftDetail.maximumPerOrder")," ",m," ",s("giftDetail.items")," ",s("giftDetail.perOrder")]})]})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsxs("button",{onClick:C,className:"w-full flex items-center justify-center gap-3 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-8 py-4 rounded-xl font-bold text-lg transition-all",style:{boxShadow:"0 4px 12px rgba(217, 28, 129, 0.3)"},onMouseEnter:i=>i.currentTarget.style.boxShadow="0 6px 16px rgba(217, 28, 129, 0.4)",onMouseLeave:i=>i.currentTarget.style.boxShadow="0 4px 12px rgba(217, 28, 129, 0.3)",children:[s(y?"giftDetail.updateSelection":"giftDetail.selectThisGift"),e.jsx(B,{className:"w-6 h-6"})]}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:s("giftDetail.reviewNotice")})]})]})]})}),e.jsxs("div",{className:"mt-8 grid md:grid-cols-2 gap-8",children:[a.features&&a.features.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:s("giftDetail.features")}),e.jsx("ul",{className:"space-y-3",children:a.features.map((i,t)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(w,{className:"w-5 h-5 text-[#D91C81] flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:i})]},t))})]}),a.specifications&&Object.keys(a.specifications).length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:s("giftDetail.specifications")}),e.jsx("dl",{className:"space-y-3",children:Object.entries(a.specifications).map(([i,t])=>e.jsxs("div",{className:"flex justify-between gap-4 py-2 border-b border-gray-100 last:border-0",children:[e.jsx("dt",{className:"font-semibold text-gray-700",children:i}),e.jsx("dd",{className:"text-gray-600 text-right",children:String(t)})]},i))})]})]}),e.jsxs("div",{className:"mt-8 bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("giftDetail.description")}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.longDescription})]}),e.jsxs("div",{className:"mt-8 bg-cyan-50 border border-cyan-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-[#1B2A5E] mb-2",children:s("giftDetail.giftInfoTitle")}),e.jsx("p",{className:"text-sm text-gray-700",children:s("giftDetail.giftInfoDesc")})]})]})})]})}export{K as GiftDetail};
