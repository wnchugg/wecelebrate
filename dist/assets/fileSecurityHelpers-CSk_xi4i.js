function d(t,n=10){const o=n*1024*1024;return t.size<=o}function h(t,n,o){var s;const e=(s=t.name.split(".").pop())==null?void 0:s.toLowerCase();return!(!e||!n.includes(`.${e}`))}function x(t){const n=["__proto__","constructor","prototype"],o=Object.create(null);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){if(n.includes(e.toLowerCase())){console.warn(`Security: Removed dangerous key "${e}" from imported data`);continue}o[e]=t[e]}return o}function y(t){return t.map(n=>x(n))}function w(t,n=1e4){if(t.length>n)return!1;const o=[/(.)\1{100,}/,/(\w+\s+){100,}/];for(const e of o)if(e.test(t))return!1;return!0}function g(t,n,o={}){const e=[],s=[],l=o.maxSizeMB??10;d(t,l)||e.push(`File size exceeds ${l}MB limit`);const c=o.allowedExtensions??[".csv",".xlsx",".xls"];h(t,c)||e.push(`File type not allowed. Allowed types: ${c.join(", ")}`);const a=o.maxRows??1e4;n.length>a&&e.push(`Too many rows (${n.length}). Maximum: ${a}`),n.length===0&&e.push("File contains no data");const r=o.maxCellLength??5e3;let u=0;for(let i=0;i<Math.min(n.length,100);i++){const f=n[i];for(const p in f){const m=String(f[p]??"");if(m.length>r&&(u++,u===1&&s.push(`Some cells exceed ${r} character limit`)),!w(m,r)){e.push(`Suspicious content detected in row ${i+1}, column ${p}`);break}}if(e.length>0)break}return{isValid:e.length===0,errors:e,warnings:s}}export{g as p,y as s};
