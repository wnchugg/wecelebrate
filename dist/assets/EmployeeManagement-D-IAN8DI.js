import{r as o,j as e,C as y,X as ne,a6 as O,l as J,a7 as K,t as W,g as Le,w as Oe,p as G,D as ye,x as He,T as qe,B as ae,q as _e,S as Be}from"./index-DAep3-17.js";import{C as S,d as T}from"./card-D7HVS59i.js";import{B as F}from"./badge-CKAfVDe6.js";import{a as B,s as A}from"./errorHandling-61HatLcx.js";import{F as he}from"./file-text-FCbbDMlz.js";import{D as je}from"./download-C6Tum4sE.js";import{U as re}from"./upload-CPOO72Jy.js";import{C as V}from"./circle-check-big-Dewj6UrC.js";import{C as fe}from"./circle-alert-BJpcJige.js";import{I as C}from"./input-E3LMlGJB.js";import{L as h}from"./label-D7rDMfrx.js";import{S as z}from"./switch-B0fN3YBd.js";import{S as ve}from"./server-DNuz2ksB.js";import{T as ze}from"./test-tube-DOrr7Vz8.js";import{C as Ne}from"./circle-x-BFN1fzT3.js";import{F as Ke}from"./folder-open-BHQpFKRy.js";import{C as be}from"./clock-Cklh_US9.js";import{S as we}from"./save-VFQGZXXm.js";import{P as Z}from"./plus-U3aaopYz.js";import{A as We}from"./activity-C0ryOwxX.js";import{C as pe}from"./calendar-R6FbzVZU.js";import{D as Je,a as Ve,b as Xe,c as Ge,e as Ye}from"./dialog-DxmycFb0.js";import{M as ee}from"./map-pin-BnvXFQRp.js";import{S as Qe}from"./square-pen-Bj3YdsC1.js";import{T as Ze}from"./trash-2-orf3MXe6.js";import{U as Q}from"./users-BInxthQ2.js";import"./index-GxwXKa5n.js";import"./index-BBIAgE77.js";import"./index-CH-6Jnw9.js";import"./index-C8gtVD-n.js";import"./index-CcwUd-PA.js";import"./index-Dxauqy8w.js";import"./index-NQBsc09o.js";import"./index-CE6KxwT7.js";import"./index-7D9TSwIG.js";function es({client:i,onUploadComplete:b}){var M,D;const[n,d]=o.useState(!1),[w,$]=o.useState(null),[I,H]=o.useState(null),E=o.useRef(null),j=()=>{const r=["email,employeeId,name,department,country,region,location,serialCard","john.doe@company.com,EMP001,John Doe,Engineering,USA,West,San Francisco,CARD12345","jane.smith@company.com,EMP002,Jane Smith,Marketing,USA,East,New York,CARD12346","alex.johnson@company.com,EMP003,Alex Johnson,Sales,Canada,Central,Toronto,CARD12347"].join(`
`),g=new Blob([r],{type:"text/csv"}),m=URL.createObjectURL(g),L=document.createElement("a");L.href=m,L.download="employee_import_template.csv",L.click(),URL.revokeObjectURL(m),B("Template downloaded successfully")},f=r=>{const g=r.split(`
`).filter(v=>v.trim());if(g.length===0)return[];const m=g[0].split(",").map(v=>v.trim().toLowerCase()),L=[];for(let v=1;v<g.length;v++){if(!g[v].trim())continue;const _=g[v].split(",").map(P=>P.trim()),a={};m.forEach((P,k)=>{_[k]&&(a[P]=_[k])}),a.employeeid&&!a.employeeId&&(a.employeeId=a.employeeid),a.serialcard&&!a.serialCard&&(a.serialCard=a.serialcard),L.push(a)}return L},R=r=>{var m;const g=(m=r.target.files)==null?void 0:m[0];g&&(H(g),$(null))},q=async()=>{if(I){d(!0),$(null);try{const r=await I.text(),g=f(r);if(g.length===0){A("No valid employees found in CSV","Please check the file format");return}const m=await O(`/clients/${i.id}/employees/import`,{method:"POST",body:JSON.stringify({employees:g})});$(m),m.errors&&m.errors.length>0?A(`Imported ${m.imported} employees with ${m.errors.length} errors`,"Check the results below"):B(`Successfully imported ${m.imported} employees`),b()}catch(r){A("Import failed",r instanceof Error?r.message:"Unknown error")}finally{d(!1)}}},u=()=>{H(null),$(null),E.current&&(E.current.value="")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx(he,{className:"w-5 h-5 text-[#D91C81] mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"How to Upload Employee Data"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:"Download the CSV template below"}),e.jsx("li",{children:"Fill in your employee data following the template format"}),e.jsx("li",{children:"Include these required fields: email, employeeId, name"}),e.jsx("li",{children:"Optional fields for site mapping: department, country, region, location"}),e.jsx("li",{children:"Upload the completed CSV file"}),e.jsx("li",{children:"Review the import results and configure site mapping rules if needed"})]})]})]}),e.jsxs(y,{onClick:j,variant:"outline",className:"gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),"Download CSV Template"]})]})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Upload Employee CSV File"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-[#D91C81] transition-colors",children:[e.jsx("input",{ref:E,type:"file",accept:".csv",onChange:R,className:"hidden",id:"employee-csv-upload"}),e.jsxs("label",{htmlFor:"employee-csv-upload",className:"cursor-pointer",children:[e.jsx(re,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-gray-600",children:"CSV files only (Max 10MB)"})]})]}),I&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:I.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[(I.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsx(y,{onClick:q,disabled:!I||n,className:"w-full bg-[#D91C81] hover:bg-[#B01669] text-white",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Import Employees"]})})]})]})}),w&&e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Import Results"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(V,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-green-900",children:"Imported"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:w.imported})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(V,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-blue-900",children:"Updated"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:w.updated})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-900",children:"Skipped"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.skipped})]}),e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ne,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-xs font-medium text-red-900",children:"Errors"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:((M=w.errors)==null?void 0:M.length)||0})]})]}),w.errors&&w.errors.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Error Details:"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:w.errors.map((r,g)=>e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-sm",children:[e.jsxs("span",{className:"font-medium text-red-900",children:["Row ",r.row,":"]})," ",e.jsxs("span",{className:"text-red-700",children:[r.field," - ",r.message]})]},g))})]}),w.success&&!((D=w.errors)!=null&&D.length)&&e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Import completed successfully!"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"All employees have been imported. You can now configure site mapping rules to automatically assign employees to sites."})]})]})})]})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"CSV Field Reference"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Field Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Required"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Example"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"email"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-red-100 text-red-800 text-xs",children:"Required"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Employee email address"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"john.doe@company.com"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"employeeId"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-red-100 text-red-800 text-xs",children:"Required"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Unique employee identifier"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"EMP001"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"name"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-red-100 text-red-800 text-xs",children:"Required"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Full name"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"John Doe"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"department"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Department name (for mapping)"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Engineering"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"country"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Country (for mapping)"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"USA"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"region"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Region (for mapping)"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"West"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"location"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Office location (for mapping)"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"San Francisco"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:"serialCard"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"Serial card number for validation"}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:"CARD12345"})]})]})]})})]})})]})}function ss({client:i,onConfigUpdated:b}){const[n,d]=o.useState({clientId:i.id,enabled:!1,host:"",port:22,username:"",authMethod:"password",remotePath:"/employee-data",filePattern:"employees-*.csv",schedule:{enabled:!1,frequency:"daily",time:"02:00"},processing:{archivePath:"/employee-data/archive",deleteAfterImport:!1,notifyOnSuccess:!0,notifyOnFailure:!0},status:"inactive"}),[w,$]=o.useState(!0),[I,H]=o.useState(!1),[E,j]=o.useState(!1),[f,R]=o.useState(null);o.useEffect(()=>{q()},[i.id]);const q=async()=>{$(!0);try{const r=await O(`/clients/${i.id}/sftp-config`);r.config&&d(r.config)}catch{J.log("No SFTP config found, using defaults")}finally{$(!1)}},u=async()=>{try{H(!0),await O(`/erp/connections/${i.id}/sftp-config`,{method:"PUT",body:JSON.stringify(n)}),W.success("SFTP configuration saved successfully"),b(),q()}catch(r){W.error(`Failed to save configuration: ${r instanceof Error?r.message:"Unknown error"}`)}finally{H(!1)}},M=async()=>{try{j(!0),R(null);const r=await O(`/erp/connections/${i.id}/sftp-test`,{method:"POST"});R(r),r.success?W.success("SFTP connection successful!"):W.error(`Connection failed: ${r.message}`)}catch(r){R({success:!1,message:r instanceof Error?r.message:"Unknown error"}),W.error(`Test failed: ${r instanceof Error?r.message:"Unknown error"}`)}finally{j(!1)}},D=async()=>{try{W.info("Starting SFTP sync..."),await O(`/erp/connections/${i.id}/sync`,{method:"POST",body:JSON.stringify({method:"sftp"})}),b()}catch(r){W.error(`Sync failed: ${r instanceof Error?r.message:"Unknown error"}`)}};return w?e.jsx(S,{children:e.jsxs(T,{className:"p-12 text-center",children:[e.jsx(K,{className:"w-8 h-8 animate-spin text-[#D91C81] mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading configuration..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"w-6 h-6 text-[#D91C81] mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"SFTP Automated Import"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure automated employee data imports from your SFTP server"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{checked:n.enabled,onCheckedChange:r=>d({...n,enabled:r})}),e.jsx(F,{className:n.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:n.enabled?"Enabled":"Disabled"})]})]})})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Connection Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"host",children:"SFTP Host"}),e.jsx(C,{id:"host",value:n.host,onChange:r=>d({...n,host:r.target.value}),placeholder:"sftp.example.com"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"port",children:"Port"}),e.jsx(C,{id:"port",type:"number",value:n.port,onChange:r=>d({...n,port:parseInt(r.target.value)||22})})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"username",children:"Username"}),e.jsx(C,{id:"username",value:n.username,onChange:r=>d({...n,username:r.target.value}),placeholder:"sftp-user"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"authMethod",children:"Authentication Method"}),e.jsxs("select",{id:"authMethod",value:n.authMethod,onChange:r=>d({...n,authMethod:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"password",children:"Password"}),e.jsx("option",{value:"key",children:"Private Key"})]})]}),n.authMethod==="password"?e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(C,{id:"password",type:"password",value:n.password||"",onChange:r=>d({...n,password:r.target.value}),placeholder:"••••••••"})]}):e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(h,{htmlFor:"privateKey",children:"Private Key"}),e.jsx("textarea",{id:"privateKey",value:n.privateKey||"",onChange:r=>d({...n,privateKey:r.target.value}),placeholder:"-----BEGIN RSA PRIVATE KEY-----",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none font-mono text-sm",rows:6})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(y,{onClick:M,variant:"outline",disabled:E||!n.host||!n.username,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"w-4 h-4"}),"Test Connection"]})})}),f&&e.jsxs("div",{className:`mt-4 p-4 rounded-lg flex items-start gap-3 ${f.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[f.success?e.jsx(V,{className:"w-5 h-5 text-green-600 mt-0.5"}):e.jsx(Ne,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${f.success?"text-green-900":"text-red-900"}`,children:f.success?"Connection Successful":"Connection Failed"}),e.jsx("p",{className:`text-xs mt-1 ${f.success?"text-green-700":"text-red-700"}`,children:f.message})]})]})]})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"File Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"remotePath",children:"Remote Path"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(C,{id:"remotePath",value:n.remotePath,onChange:r=>d({...n,remotePath:r.target.value}),placeholder:"/employee-data",className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"filePattern",children:"File Pattern"}),e.jsx(C,{id:"filePattern",value:n.filePattern,onChange:r=>d({...n,filePattern:r.target.value}),placeholder:"employees-*.csv"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Use * as wildcard (e.g., employees-*.csv)"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"archivePath",children:"Archive Path"}),e.jsx(C,{id:"archivePath",value:n.processing.archivePath,onChange:r=>d({...n,processing:{...n.processing,archivePath:r.target.value}}),placeholder:"/employee-data/archive"})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[e.jsx(z,{checked:n.processing.deleteAfterImport,onCheckedChange:r=>d({...n,processing:{...n.processing,deleteAfterImport:r}})}),e.jsx(h,{children:"Delete files after import"})]})]})]})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Sync Schedule"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{checked:n.schedule.enabled,onCheckedChange:r=>d({...n,schedule:{...n.schedule,enabled:r}})}),e.jsx("span",{className:"text-sm text-gray-600",children:n.schedule.enabled?"Enabled":"Disabled"})]})]}),n.schedule.enabled&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"frequency",children:"Frequency"}),e.jsxs("select",{id:"frequency",value:n.schedule.frequency,onChange:r=>d({...n,schedule:{...n.schedule,frequency:r.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]})]}),n.schedule.frequency!=="hourly"&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"time",children:"Time"}),e.jsx(C,{id:"time",type:"time",value:n.schedule.time||"",onChange:r=>d({...n,schedule:{...n.schedule,time:r.target.value}})})]}),n.schedule.frequency==="weekly"&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"dayOfWeek",children:"Day of Week"}),e.jsxs("select",{id:"dayOfWeek",value:n.schedule.dayOfWeek||1,onChange:r=>d({...n,schedule:{...n.schedule,dayOfWeek:parseInt(r.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:1,children:"Monday"}),e.jsx("option",{value:2,children:"Tuesday"}),e.jsx("option",{value:3,children:"Wednesday"}),e.jsx("option",{value:4,children:"Thursday"}),e.jsx("option",{value:5,children:"Friday"}),e.jsx("option",{value:6,children:"Saturday"}),e.jsx("option",{value:0,children:"Sunday"})]})]})]}),n.lastSync&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-sm text-blue-900",children:["Last sync: ",new Date(n.lastSync).toLocaleString()]})]})]})}),e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Notify on successful sync"}),e.jsx(z,{checked:n.processing.notifyOnSuccess,onCheckedChange:r=>d({...n,processing:{...n.processing,notifyOnSuccess:r}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Notify on sync failure"}),e.jsx(z,{checked:n.processing.notifyOnFailure,onCheckedChange:r=>d({...n,processing:{...n.processing,notifyOnFailure:r}})})]})]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{onClick:u,disabled:I,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:I?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Save Configuration"]})}),e.jsxs(y,{onClick:D,variant:"outline",disabled:!n.enabled||!(f!=null&&f.success),children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Run Manual Sync"]})]})]})}const ue=[{id:"workday",name:"Workday",description:"Enterprise-grade HR, payroll, and financial management",authTypes:["oauth","api_key"],supportsRealtime:!0},{id:"bamboohr",name:"BambooHR",description:"All-in-one HR software for small and medium businesses",authTypes:["api_key"],supportsRealtime:!0},{id:"adp",name:"ADP Workforce Now",description:"Comprehensive payroll and HR solutions",authTypes:["oauth","api_key"],supportsRealtime:!0},{id:"namely",name:"Namely",description:"Modern HR platform with integrated payroll",authTypes:["api_key"],supportsRealtime:!1},{id:"rippling",name:"Rippling",description:"Employee management platform",authTypes:["oauth","api_key"],supportsRealtime:!0},{id:"gusto",name:"Gusto",description:"Payroll, benefits, and HR in one place",authTypes:["api_key"],supportsRealtime:!1},{id:"sftp",name:"SFTP File Transfer",description:"Import employee data via secure file transfer",authTypes:["sftp"],supportsRealtime:!1}],ge={employeeId:"employee_id",firstName:"first_name",lastName:"last_name",email:"email",department:"department",jobTitle:"job_title",startDate:"hire_date",status:"employment_status"};function ts({client:i,sites:b,onSyncComplete:n}){const d=Le(),[w,$]=o.useState([]),[I,H]=o.useState([]),[E,j]=o.useState(!0),[f,R]=o.useState("connections"),[q,u]=o.useState(!1),[M,D]=o.useState(!1),[r,g]=o.useState(!1),[m,L]=o.useState(null),[v,_]=o.useState(null),[a,P]=o.useState(null),[k,l]=o.useState("client"),[c,p]=o.useState([]),[t,N]=o.useState({displayName:"",providerId:"",authType:"api_key",apiUrl:"",apiKey:"",username:"",password:"",clientId:"",clientSecret:"",tenantId:"",sftpHost:"",sftpPort:"22",sftpUsername:"",sftpPassword:"",sftpPath:"",syncFrequency:"daily",syncTime:"02:00",autoImport:!0,updateExisting:!0,deactivateMissing:!1,notifyOnSync:!0}),[se,ie]=o.useState(ge),X=`https://${Oe}.supabase.co/functions/v1/make-server-6fcaeea3`;o.useEffect(()=>{Y(),ce()},[i.id]);const Y=async()=>{try{j(!0);const s=await fetch(`${X}/hris/connections?clientId=${i.id}`,{headers:{Authorization:`Bearer ${G}`,"X-Environment-ID":d.id}});if(!s.ok)throw new Error(`Failed to load HRIS connections: ${s.status}`);const x=await s.json();$(x.connections||[])}catch(s){J.error("Error loading HRIS connections:",s),A("Failed to load HRIS connections")}finally{j(!1)}},ce=async()=>{try{const s=await fetch(`${X}/hris/sync-history?clientId=${i.id}`,{headers:{Authorization:`Bearer ${G}`,"X-Environment-ID":d.id}});if(s.ok){const x=await s.json();H(x.history||[])}}catch(s){J.error("Error loading sync history:",s)}},Ce=s=>{_(s),N({...t,displayName:`${i.name} - ${s.name}`,providerId:s.id,authType:s.authTypes[0]}),ie(ge),l("client"),p([]),u(!0)},Se=s=>{L(s),_(ue.find(Me=>Me.id===s.provider)||null),l("client"),p([]);const x=s.credentials;let U="",te="",de="",oe="",me="",xe="";const Ee="",Re="",Pe="22",Ue="",Ae="",$e="";x.type==="api_key"?(te=x.apiKey,U=x.apiSecret||""):x.type==="oauth"?(me=x.clientId,xe=x.clientSecret,U=x.accessToken||""):x.type==="basic_auth"&&(de=x.username,oe=x.password),N({displayName:s.provider,providerId:s.provider,authType:s.authType,apiUrl:U,apiKey:te,username:de,password:oe,clientId:me,clientSecret:xe,tenantId:Ee,sftpHost:Re,sftpPort:Pe,sftpUsername:Ue,sftpPassword:Ae,sftpPath:$e,syncFrequency:s.syncSchedule.frequency,syncTime:s.syncSchedule.time,autoImport:s.syncSchedule.enabled,updateExisting:!1,deactivateMissing:!1,notifyOnSync:!1}),ie(s.fieldMapping),u(!0)},Ie=async()=>{try{const s={};t.authType==="api_key"?(s.apiUrl=t.apiUrl,s.apiKey=t.apiKey):t.authType==="oauth"?(s.apiUrl=t.apiUrl,s.clientId=t.clientId,s.clientSecret=t.clientSecret,s.tenantId=t.tenantId):t.authType==="basic"?(s.apiUrl=t.apiUrl,s.username=t.username,s.password=t.password):t.authType==="sftp"&&(s.sftpHost=t.sftpHost,s.sftpPort=t.sftpPort,s.sftpUsername=t.sftpUsername,s.sftpPassword=t.sftpPassword,s.sftpPath=t.sftpPath);const x={id:m==null?void 0:m.id,clientId:i.id,providerId:t.providerId,providerName:(v==null?void 0:v.name)||"",displayName:t.displayName,authType:t.authType,credentials:s,fieldMapping:se,syncSchedule:{enabled:t.syncFrequency!=="manual",frequency:t.syncFrequency,time:t.syncTime},syncConfig:{autoImport:t.autoImport,updateExisting:t.updateExisting,deactivateMissing:t.deactivateMissing,notifyOnSync:t.notifyOnSync}};if(k==="client"?(x.siteId=null,x.siteIds=[]):x.siteIds=c,!(await fetch(`${X}/hris/connections${m?`/${m.id}`:""}`,{method:m?"PUT":"POST",headers:{Authorization:`Bearer ${G}`,"Content-Type":"application/json","X-Environment-ID":d.id},body:JSON.stringify(x)})).ok)throw new Error(`Failed to ${m?"update":"create"} connection`);B(`HRIS connection ${m?"updated":"created"} successfully`),u(!1),L(null),_(null),Y()}catch(s){J.error("Error saving HRIS connection:",s),A(`Failed to ${m?"update":"create"} connection`)}},ke=async s=>{try{const U=await(await fetch(`${X}/hris/connections/${s}/test`,{method:"POST",headers:{Authorization:`Bearer ${G}`,"X-Environment-ID":d.id}})).json();U.success?B("Connection test successful"):A(`Connection test failed: ${U.error}`),Y()}catch(x){J.error("Error testing connection:",x),A("Failed to test connection")}},Fe=async s=>{try{if(!(await fetch(`${X}/hris/connections/${s}/sync`,{method:"POST",headers:{Authorization:`Bearer ${G}`,"X-Environment-ID":d.id}})).ok)throw new Error("Failed to start sync");B("Sync started successfully"),setTimeout(()=>{ce(),Y(),n&&n()},2e3)}catch(x){J.error("Error starting sync:",x),A("Failed to start sync")}},Te=async s=>{if(confirm("Are you sure you want to delete this HRIS connection?"))try{if(!(await fetch(`${X}/hris/connections/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${G}`,"X-Environment-ID":d.id}})).ok)throw new Error("Failed to delete connection");B("HRIS connection deleted successfully"),Y()}catch(x){J.error("Error deleting connection:",x),A("Failed to delete connection")}},De=s=>"All Sites (Client-Level)";return E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#D91C81] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading HRIS integrations..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#1B2A5E] mb-2",children:"HRIS Integration"}),e.jsxs("p",{className:"text-gray-600",children:["Connect and sync employee data from your HR information system for ",i.name]})]})})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-4 px-6",children:[e.jsxs("button",{onClick:()=>R("connections"),className:`px-4 py-3 border-b-2 font-medium text-sm transition-colors ${f==="connections"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:["Connections (",w.length,")"]}),e.jsx("button",{onClick:()=>R("providers"),className:`px-4 py-3 border-b-2 font-medium text-sm transition-colors ${f==="providers"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Available Providers"}),e.jsxs("button",{onClick:()=>R("history"),className:`px-4 py-3 border-b-2 font-medium text-sm transition-colors ${f==="history"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:["Sync History (",I.length,")"]})]})}),e.jsxs("div",{className:"p-6",children:[f==="connections"&&e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No HRIS Connections"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Connect your HR system to automatically sync employee data for ",i.name]}),e.jsxs(y,{onClick:()=>R("providers"),className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Browse Providers"]})]}):e.jsx("div",{className:"space-y-4",children:w.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 hover:border-[#D91C81] transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[s.provider," Connection"]}),e.jsxs(F,{variant:s.status==="active"?"success":s.status==="error"?"destructive":"secondary",children:[s.status==="active"&&e.jsx(V,{className:"w-3 h-3 mr-1"}),s.status==="error"&&e.jsx(Ne,{className:"w-3 h-3 mr-1"}),s.status==="inactive"&&e.jsx(be,{className:"w-3 h-3 mr-1"}),s.status]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Provider: ",s.provider," • Auth: ",s.authType]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Scope: ",De()]}),s.lastSync&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Last sync: ",new Date(s.lastSync).toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{size:"sm",variant:"outline",onClick:()=>ke(s.id),children:"Test"}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>Fe(s.id),children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>Se(s),children:e.jsx(He,{className:"w-4 h-4"})}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>Te(s.id),className:"text-red-600 hover:text-red-700",children:"Delete"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sync Schedule"}),e.jsxs("p",{className:"font-medium",children:[s.syncSchedule.frequency," @ ",s.syncSchedule.time]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Auto Import"}),e.jsx("p",{className:"font-medium",children:s.syncConfig.autoImport?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Update Existing"}),e.jsx("p",{className:"font-medium",children:s.syncConfig.updateExisting?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Next Sync"}),e.jsx("p",{className:"font-medium",children:s.syncSchedule.nextSync?new Date(s.syncSchedule.nextSync).toLocaleString():"Manual only"})]})]})]},s.id))})}),f==="providers"&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:ue.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 hover:border-[#D91C81] transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(V,{className:"w-4 h-4 text-green-600"}),"Auth: ",s.authTypes.join(", ")]}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:s.supportsRealtime?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4 text-green-600"}),"Real-time sync supported"]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),"Scheduled sync only"]})})]}),e.jsxs(y,{onClick:()=>Ce(s),className:"w-full bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Connect"]})]},s.id))}),f==="history"&&e.jsx("div",{className:"space-y-4",children:I.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Sync History"}),e.jsx("p",{className:"text-gray-600",children:"Sync history will appear here after you run your first sync"})]}):I.map(s=>{const x=w.find(U=>U.id===s.connectionId);return e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:(x==null?void 0:x.displayName)||"Unknown Connection"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(s.startTime).toLocaleString(),s.endTime&&` - ${new Date(s.endTime).toLocaleString()}`]})]}),e.jsx(F,{variant:s.status==="completed"?"success":s.status==="failed"?"destructive":s.status==="partial"?"warning":"secondary",children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processed"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.recordsProcessed})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Created"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:s.recordsCreated})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Updated"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:s.recordsUpdated})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Skipped"}),e.jsx("p",{className:"text-lg font-semibold text-gray-600",children:s.recordsSkipped})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Failed"}),e.jsx("p",{className:"text-lg font-semibold text-red-600",children:s.recordsFailed})]})]}),s.errors&&s.errors.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900 mb-2",children:"Errors:"}),e.jsx("ul",{className:"space-y-1",children:s.errors.slice(0,3).map((U,te)=>e.jsxs("li",{className:"text-sm text-red-800",children:[U.field,": ",U.message,U.recordId&&` (${U.recordId})`]},te))}),s.errors.length>3&&e.jsxs("p",{className:"text-sm text-red-800 mt-1",children:["... and ",s.errors.length-3," more errors"]})]})]})})]},s.id)})})]})]}),q&&v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-bold text-[#1B2A5E]",children:[m?"Edit":"Create"," HRIS Connection"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[v.name," - ",i.name]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"displayName",children:"Display Name"}),e.jsx(C,{id:"displayName",value:t.displayName,onChange:s=>N({...t,displayName:s.target.value}),placeholder:"e.g., TechCorp - Workday"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsx(h,{className:"mb-3 block",children:"Connection Scope"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"scope",checked:k==="client",onChange:()=>{l("client"),p([])},className:"mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Client Level (All Sites)"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["This connection will apply to all sites under ",i.name]})]})]}),e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"scope",checked:k==="sites",onChange:()=>l("sites"),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Specific Sites"}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Select which sites should use this connection"}),k==="sites"&&e.jsx("div",{className:"space-y-2 ml-6",children:b.length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No sites available"}):b.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:x=>{x.target.checked?p([...c,s.id]):p(c.filter(U=>U!==s.id))}}),e.jsx("span",{className:"text-sm text-gray-700",children:s.name}),!s.isActive&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Inactive)"})]},s.id))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"authType",children:"Authentication Type"}),e.jsx("select",{id:"authType",value:t.authType,onChange:s=>N({...t,authType:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:v.authTypes.map(s=>e.jsx("option",{value:s,children:s.toUpperCase().replace("_"," ")},s))})]}),t.authType==="api_key"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"apiUrl",children:"API URL"}),e.jsx(C,{id:"apiUrl",value:t.apiUrl,onChange:s=>N({...t,apiUrl:s.target.value}),placeholder:"https://api.provider.com/v1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"apiKey",children:"API Key"}),e.jsx(C,{id:"apiKey",type:"password",value:t.apiKey,onChange:s=>N({...t,apiKey:s.target.value}),placeholder:"Enter API key"})]})]}),t.authType==="oauth"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"apiUrl",children:"API URL"}),e.jsx(C,{id:"apiUrl",value:t.apiUrl,onChange:s=>N({...t,apiUrl:s.target.value}),placeholder:"https://api.provider.com/v1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"clientId",children:"Client ID"}),e.jsx(C,{id:"clientId",value:t.clientId,onChange:s=>N({...t,clientId:s.target.value}),placeholder:"Enter OAuth client ID"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"clientSecret",children:"Client Secret"}),e.jsx(C,{id:"clientSecret",type:"password",value:t.clientSecret,onChange:s=>N({...t,clientSecret:s.target.value}),placeholder:"Enter OAuth client secret"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"tenantId",children:"Tenant ID (Optional)"}),e.jsx(C,{id:"tenantId",value:t.tenantId,onChange:s=>N({...t,tenantId:s.target.value}),placeholder:"Enter tenant ID if required"})]})]}),t.authType==="sftp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"sftpHost",children:"SFTP Host"}),e.jsx(C,{id:"sftpHost",value:t.sftpHost,onChange:s=>N({...t,sftpHost:s.target.value}),placeholder:"sftp.provider.com"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"sftpUsername",children:"Username"}),e.jsx(C,{id:"sftpUsername",value:t.sftpUsername,onChange:s=>N({...t,sftpUsername:s.target.value}),placeholder:"Enter SFTP username"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"sftpPassword",children:"Password"}),e.jsx(C,{id:"sftpPassword",type:"password",value:t.sftpPassword,onChange:s=>N({...t,sftpPassword:s.target.value}),placeholder:"Enter SFTP password"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"sftpPath",children:"File Path"}),e.jsx(C,{id:"sftpPath",value:t.sftpPath,onChange:s=>N({...t,sftpPath:s.target.value}),placeholder:"/exports/employees.csv"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sync Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"syncFrequency",children:"Sync Frequency"}),e.jsxs("select",{id:"syncFrequency",value:t.syncFrequency,onChange:s=>N({...t,syncFrequency:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"manual",children:"Manual Only"}),e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),t.syncFrequency!=="manual"&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"syncTime",children:"Sync Time"}),e.jsx(C,{id:"syncTime",type:"time",value:t.syncTime,onChange:s=>N({...t,syncTime:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(z,{checked:t.autoImport,onCheckedChange:s=>N({...t,autoImport:s})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Auto-import employees"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(z,{checked:t.updateExisting,onCheckedChange:s=>N({...t,updateExisting:s})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Update existing employees"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(z,{checked:t.deactivateMissing,onCheckedChange:s=>N({...t,deactivateMissing:s})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Deactivate employees not found in HRIS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(z,{checked:t.notifyOnSync,onCheckedChange:s=>N({...t,notifyOnSync:s})}),e.jsx("span",{className:"text-sm text-gray-700",children:"Send notification after sync"})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex gap-3 justify-end",children:[e.jsx(y,{variant:"outline",onClick:()=>{u(!1),L(null),_(null)},children:"Cancel"}),e.jsxs(y,{onClick:Ie,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[m?"Update":"Create"," Connection"]})]})]})})]})}const le={async set(i,b){await O("/kv",{method:"PUT",body:JSON.stringify({key:i,value:b})})},async get(i){try{return(await O(`/kv/${encodeURIComponent(i)}`)).value??null}catch{return null}},async del(i){await O(`/kv/${encodeURIComponent(i)}`,{method:"DELETE"})}},as={async get(i){return O(i)},async post(i,b){return O(i,{method:"POST",body:b?JSON.stringify(b):void 0})},async put(i,b){return O(i,{method:"PUT",body:b?JSON.stringify(b):void 0})},async del(i){return O(i,{method:"DELETE"})}};function rs({client:i,sites:b,onRulesUpdated:n}){const[d,w]=o.useState([]),[$,I]=o.useState(!0),[H,E]=o.useState(!1),[j,f]=o.useState(null),[R,q]=o.useState(!1),[u,M]=o.useState({clientId:i.id,siteId:"",priority:1,conditions:[{field:"country",operator:"equals",value:""}],isActive:!0});o.useEffect(()=>{D()},[i.id]);const D=async()=>{I(!0);try{const{rules:l}=await O(`/clients/${i.id}/mapping-rules`);w(l)}catch(l){A("Failed to load mapping rules",l instanceof Error?l.message:"Unknown error")}finally{I(!1)}},r=()=>{M({clientId:i.id,siteId:"",priority:d.length+1,conditions:[{field:"country",operator:"equals",value:""}],isActive:!0}),f(null),E(!0)},g=l=>{M(l),f(l),E(!0)},m=async()=>{if(j)try{const l=j.id?`site_mapping_rule:${j.id}`:`site_mapping_rule:${Date.now()}`,c={...j,id:j.id||`rule_${Date.now()}`,updatedAt:new Date().toISOString()};await le.set(l,c),B(j.id?"Rule updated":"Rule created","Site mapping rule saved successfully"),D(),E(!1)}catch(l){A("Failed to save rule",l instanceof Error?l.message:"Unknown error")}},L=async l=>{if(window.confirm("Are you sure you want to delete this mapping rule?"))try{await le.del(`site_mapping_rule:${l}`),B("Mapping rule deleted successfully"),D()}catch(c){A("Failed to delete rule",c instanceof Error?c.message:"Unknown error")}},v=async l=>{try{const c={...l,isActive:!l.isActive};await le.set(`site_mapping_rule:${l.id}`,c),B(`Rule ${l.isActive?"disabled":"enabled"}`),D()}catch(c){A("Failed to update rule",c instanceof Error?c.message:"Unknown error")}},_=async()=>{try{q(!0),await as.post("erp/site-mappings/apply-rules",{erpConnectionId:i.id}),n()}catch(l){A("Failed to apply rules",l instanceof Error?l.message:"Unknown error")}finally{q(!1)}},a=()=>{M({...u,conditions:[...u.conditions,{field:"country",operator:"equals",value:""}]})},P=l=>{M({...u,conditions:u.conditions.filter((c,p)=>p!==l)})},k=(l,c)=>{M({...u,conditions:u.conditions.map((p,t)=>t===l?{...p,...c}:p)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ee,{className:"w-6 h-6 text-[#D91C81] mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Site Mapping Rules"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automatically assign employees to sites based on their attributes like country, department, or region"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:_,disabled:R||d.length===0,variant:"outline",size:"sm",children:R?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 mr-2 animate-spin"}),"Applying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Apply Rules"]})}),e.jsxs(y,{onClick:r,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",size:"sm",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Add Rule"]})]})]})})}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg flex items-start gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-medium mb-1",children:"How Mapping Rules Work"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-800",children:[e.jsx("li",{children:"Rules are evaluated in priority order (lower numbers first)"}),e.jsx("li",{children:"All conditions in a rule must match for an employee to be mapped"}),e.jsx("li",{children:"Once an employee matches a rule, they are assigned to that site"}),e.jsx("li",{children:'Click "Apply Rules" to run the mapping process on all employees'})]})]})]}),$?e.jsx(S,{children:e.jsxs(T,{className:"p-12 text-center",children:[e.jsx(K,{className:"w-8 h-8 animate-spin text-[#D91C81] mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading mapping rules..."})]})}):d.length===0?e.jsx(S,{children:e.jsxs(T,{className:"p-12 text-center",children:[e.jsx(ee,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Mapping Rules"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first mapping rule to automatically assign employees to sites"}),e.jsxs(y,{onClick:r,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Create First Rule"]})]})}):e.jsx("div",{className:"space-y-3",children:d.sort((l,c)=>l.priority-c.priority).map(l=>{const c=b.find(p=>p.id===l.siteId);return e.jsx(S,{children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(F,{className:"bg-gray-100 text-gray-700 text-xs",children:["Priority ",l.priority]}),e.jsx(F,{className:l.isActive?"bg-green-100 text-green-800 text-xs":"bg-gray-100 text-gray-600 text-xs",children:l.isActive?"Active":"Inactive"}),c&&e.jsxs(F,{className:"bg-blue-100 text-blue-800 text-xs",children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),c.name]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Map employees to ",e.jsx("span",{className:"text-[#D91C81]",children:(c==null?void 0:c.name)||"Unknown Site"})," when:"]}),l.conditions.map((p,t)=>e.jsxs("div",{className:"text-sm text-gray-600 ml-4",children:[t>0&&e.jsx("span",{className:"font-semibold text-gray-900",children:"AND "}),e.jsx("span",{className:"font-medium",children:p.field})," ",e.jsx("span",{className:"text-gray-500",children:p.operator})," ",e.jsxs("span",{className:"font-mono bg-gray-100 px-2 py-0.5 rounded",children:['"',p.value,'"']})]},t))]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(y,{onClick:()=>v(l),variant:"outline",size:"sm",children:l.isActive?"Disable":"Enable"}),e.jsx(y,{onClick:()=>g(l),variant:"outline",size:"sm",children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx(y,{onClick:()=>l.id&&L(l.id),variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50",children:e.jsx(Ze,{className:"w-4 h-4"})})]})]})})},l.id)})}),e.jsx(Je,{open:H,onOpenChange:E,children:e.jsxs(Ve,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Xe,{children:e.jsx(Ge,{children:j?"Edit Mapping Rule":"Create Mapping Rule"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"siteId",children:"Target Site *"}),e.jsxs("select",{id:"siteId",value:u.siteId,onChange:l=>M({...u,siteId:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"",children:"Select a site..."}),b.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"priority",children:"Priority"}),e.jsx(C,{id:"priority",type:"number",min:1,value:u.priority,onChange:l=>M({...u,priority:parseInt(l.target.value)||1})}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Lower numbers = higher priority"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(h,{children:"Conditions (All must match)"}),e.jsxs(y,{onClick:a,variant:"outline",size:"sm",type:"button",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Add Condition"]})]}),e.jsx("div",{className:"space-y-2",children:u.conditions.map((l,c)=>e.jsxs("div",{className:"flex gap-2 items-start p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[e.jsx("div",{children:e.jsxs("select",{value:l.field,onChange:p=>k(c,{field:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-[#D91C81] outline-none",children:[e.jsx("option",{value:"country",children:"Country"}),e.jsx("option",{value:"region",children:"Region"}),e.jsx("option",{value:"department",children:"Department"}),e.jsx("option",{value:"location",children:"Location"})]})}),e.jsx("div",{children:e.jsxs("select",{value:l.operator,onChange:p=>k(c,{operator:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-[#D91C81] outline-none",children:[e.jsx("option",{value:"equals",children:"Equals"}),e.jsx("option",{value:"contains",children:"Contains"}),e.jsx("option",{value:"startsWith",children:"Starts With"}),e.jsx("option",{value:"endsWith",children:"Ends With"})]})}),e.jsx("div",{children:e.jsx(C,{value:l.value,onChange:p=>k(c,{value:p.target.value}),placeholder:"Value",className:"text-sm"})})]}),u.conditions.length>1&&e.jsx(y,{onClick:()=>P(c),variant:"outline",size:"sm",type:"button",className:"text-red-600 hover:bg-red-50",children:e.jsx(ne,{className:"w-4 h-4"})})]},c))})]})]}),e.jsxs(Ye,{children:[e.jsx(y,{onClick:()=>E(!1),variant:"outline",children:"Cancel"}),e.jsxs(y,{onClick:m,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Save Rule"]})]})]})})]})}function Hs(){const{currentClient:i,sites:b,isLoading:n}=_e(),[d,w]=o.useState("employees"),[$,I]=o.useState([]),[H,E]=o.useState(!1),[j,f]=o.useState(""),[R,q]=o.useState("all"),[u,M]=o.useState("all"),[D,r]=o.useState({total:0,active:0,inactive:0,mapped:0,unmapped:0}),g=i?b.filter(a=>a.clientId===i.id):b;o.useEffect(()=>{i?m():I([])},[i]);const m=async()=>{if(i){E(!0);try{const{employees:a}=await O(`/clients/${i.id}/employees`);I(a);const P=a.length,k=a.filter(t=>t.status==="active").length,l=a.filter(t=>t.status==="inactive").length,c=a.filter(t=>t.siteId).length,p=a.filter(t=>!t.siteId).length;r({total:P,active:k,inactive:l,mapped:c,unmapped:p})}catch(a){A("Failed to load employees",a instanceof Error?a.message:"Unknown error"),I([])}finally{E(!1)}}},L=()=>{if(v.length===0){A("No employees to export","");return}const a=[["Name","Email","Employee ID","Serial Card","Department","Country","Region","Location","Site","Status"].join(","),...v.map(c=>{var p;return[c.name||"",c.email||"",c.employeeId||"",c.serialCard||"",c.department||"",c.country||"",c.region||"",c.location||"",c.siteId?((p=g.find(t=>t.id===c.siteId))==null?void 0:p.name)||"Unknown":"Not Mapped",c.status].join(",")})].join(`
`),P=new Blob([a],{type:"text/csv"}),k=URL.createObjectURL(P),l=document.createElement("a");l.href=k,l.download=`employees-${i==null?void 0:i.name}-${new Date().toISOString().split("T")[0]}.csv`,l.click(),URL.revokeObjectURL(k),B("Employees exported successfully")},v=$.filter(a=>{var c,p,t,N,se;const P=((c=a.name)==null?void 0:c.toLowerCase().includes(j.toLowerCase()))||((p=a.email)==null?void 0:p.toLowerCase().includes(j.toLowerCase()))||((t=a.employeeId)==null?void 0:t.toLowerCase().includes(j.toLowerCase()))||((N=a.department)==null?void 0:N.toLowerCase().includes(j.toLowerCase()))||((se=a.country)==null?void 0:se.toLowerCase().includes(j.toLowerCase())),k=R==="all"||a.status===R,l=u==="all"||u==="unmapped"&&!a.siteId||a.siteId===u;return P&&k&&l}),_=[{id:"employees",label:"All Employees",icon:Q,count:D.total},{id:"mapping",label:"Site Mapping Rules",icon:ee,badge:`${D.unmapped} unmapped`},{id:"manual",label:"Manual Upload",icon:re},{id:"sftp",label:"SFTP Integration",icon:ve},{id:"hris",label:"HRIS Integration",icon:ye}];return i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Employee Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Manage employee data and site assignments"}),i&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(F,{className:"bg-[#D91C81] text-white px-3 py-1",children:[e.jsx(ae,{className:"w-3 h-3 mr-1.5"}),i.name]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[g.length," ",g.length===1?"site":"sites"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:m,className:"gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs(y,{onClick:L,variant:"outline",size:"sm",className:"gap-2",disabled:$.length===0,children:[e.jsx(je,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(S,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.total}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Employees"})]})]})})}),e.jsx(S,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.active}),e.jsx("div",{className:"text-xs text-gray-600",children:"Active"})]})]})})}),e.jsx(S,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gray-100 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.inactive}),e.jsx("div",{className:"text-xs text-gray-600",children:"Inactive"})]})]})})}),e.jsx(S,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.mapped}),e.jsx("div",{className:"text-xs text-gray-600",children:"Mapped to Sites"})]})]})})}),e.jsx(S,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D.unmapped}),e.jsx("div",{className:"text-xs text-gray-600",children:"Unmapped"})]})]})})})]}),e.jsx(S,{className:"p-1",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:_.map(a=>{const P=a.icon;return e.jsxs("button",{onClick:()=>w(a.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-md transition-all ${d===a.id?"bg-[#D91C81] text-white shadow-sm":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:a.label}),a.count!==void 0&&e.jsx(F,{className:d===a.id?"bg-white text-[#D91C81]":"bg-gray-200 text-gray-700",children:a.count}),a.badge&&e.jsx(F,{className:d===a.id?"bg-white text-[#D91C81]":"bg-orange-100 text-orange-700",children:a.badge})]},a.id)})})}),d==="employees"&&e.jsx(S,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, employee ID, department, or country...",value:j,onChange:a=>f(a.target.value),className:"w-full pl-10 pr-4 py-2 border-2 border-gray-200 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:R,onChange:a=>q(a.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("select",{value:u,onChange:a=>M(a.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"all",children:"All Sites"}),e.jsx("option",{value:"unmapped",children:"Unmapped"}),g.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}),H?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"w-8 h-8 animate-spin text-[#D91C81] mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading employees..."})]}):v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Employees Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:j?"Try adjusting your search or filters":"Get started by uploading employee data"}),!j&&e.jsxs(y,{onClick:()=>w("manual"),className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Upload Employees"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Site Assignment"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:v.map(a=>{const P=a.siteId?g.find(k=>k.id===a.siteId):null;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-sm text-gray-600",children:a.email})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono text-sm text-gray-900",children:a.employeeId})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"text-sm text-gray-900",children:a.department||"-"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-900",children:a.country||"-"}),a.region&&e.jsx("div",{className:"text-gray-600 text-xs",children:a.region})]})}),e.jsx("td",{className:"px-4 py-4",children:P?e.jsxs(F,{className:"bg-green-100 text-green-800",children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),P.name]}):e.jsx(F,{className:"bg-orange-100 text-orange-800",children:"Not Mapped"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx(F,{className:a.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:a.status})})]},a.id)})})]})}),v.length>0&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600 text-center",children:["Showing ",v.length," of ",$.length," employees"]})]})}),d==="mapping"&&e.jsx(rs,{client:i,sites:g,onRulesUpdated:m}),d==="manual"&&e.jsx(es,{client:i,onUploadComplete:m}),d==="sftp"&&e.jsx(ss,{client:i,onConfigUpdated:m}),d==="hris"&&e.jsx(ts,{client:i,sites:g.map(a=>({...a,isActive:a.status==="active"})),onSyncComplete:m})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Client Selected"}),e.jsx("p",{className:"text-gray-600",children:"Please select a client to manage employees"})]})})}export{Hs as EmployeeManagement};
