import{q as de,r as a,j as e,X as p,a7 as me}from"./index-dV4Uttrq.js";import{f as xe,b as ue,e as ge}from"./catalogApi-BPJCFqb9.js";import{C as se}from"./circle-alert-DNo9lQw-.js";import{C as he}from"./circle-check-big-BTbhA0uw.js";import{P as pe}from"./package-x6dzX_nl.js";import{I as fe}from"./info-HDMuh2zi.js";import{E as be}from"./eye-off-DmeI3nVv.js";import{P as f}from"./plus-DUZUgypq.js";import{T as ye}from"./tag-XF9-iKWa.js";import{D as je}from"./dollar-sign-Bw4fvcvW.js";import{E as ve}from"./eye-CnbqyKZE.js";import{S as Ne}from"./save-D7hvH_Dw.js";function Ke(){const{currentSite:r}=de(),[te,E]=a.useState(!0),[b,O]=a.useState(!1),[A,m]=a.useState(null),[B,F]=a.useState(null),[T,ae]=a.useState([]),[l,I]=a.useState(""),[Ce,re]=a.useState(null),[n,y]=a.useState([]),[c,j]=a.useState([]),[o,v]=a.useState([]),[d,N]=a.useState([]),[x,K]=a.useState(""),[u,M]=a.useState(""),[g,U]=a.useState(""),[h,H]=a.useState(""),[C,R]=a.useState(!1),[w,L]=a.useState(0),[$,q]=a.useState(!1),[G,X]=a.useState(!0),[S,z]=a.useState(0),[k,J]=a.useState(0),[D,Q]=a.useState(0),[V,W]=a.useState(!1);a.useEffect(()=>{r&&P()},[r]);async function P(){if(r)try{E(!0),m(null);const s=await xe({status:"active"});ae(s);try{const t=await ue(r.id);re(t),I(t.catalogId),y(t.exclusions.excludedCategories||[]),j(t.exclusions.excludedSkus||[]),v(t.exclusions.excludedTags||[]),N(t.exclusions.excludedBrands||[]),t.overrides&&(R(t.overrides.allowPriceOverride),L(t.overrides.priceAdjustment||0)),t.availability&&(q(t.availability.hideOutOfStock),X(t.availability.hideDiscontinued),z(t.availability.minimumInventory||0),J(t.availability.maximumPrice||0),Q(t.availability.minimumPrice||0),W(t.availability.onlyShowFeatured||!1))}catch{console.warn("No existing site catalog config")}}catch(s){console.error("Error loading data:",s),m(s.message||"Failed to load data")}finally{E(!1)}}async function le(){if(!r||!l){m("Please select a catalog");return}try{O(!0),m(null),F(null);const s={catalogId:l,exclusions:{excludedCategories:n,excludedSkus:c,excludedTags:o,excludedBrands:d},overrides:{allowPriceOverride:C,priceAdjustment:w>0?w:void 0},availability:{hideOutOfStock:$,hideDiscontinued:G,minimumInventory:S>0?S:void 0,maximumPrice:k>0?k:void 0,minimumPrice:D>0?D:void 0,onlyShowFeatured:V}};await ge(r.id,s),F("Site catalog configuration saved successfully!"),await P()}catch(s){console.error("Error saving configuration:",s),m(s.message||"Failed to save configuration")}finally{O(!1)}}function Y(){x&&!n.includes(x)&&(y([...n,x]),K(""))}function ie(s){y(n.filter(t=>t!==s))}function Z(){u&&!c.includes(u)&&(j([...c,u]),M(""))}function ne(s){j(c.filter(t=>t!==s))}function _(){g&&!o.includes(g)&&(v([...o,g]),U(""))}function ce(s){v(o.filter(t=>t!==s))}function ee(){h&&!d.includes(h)&&(N([...d,h]),H(""))}function oe(s){N(d.filter(t=>t!==s))}if(!r)return e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx(se,{className:"w-12 h-12 text-yellow-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Site Selected"}),e.jsx("p",{className:"text-gray-600",children:"Please select a site from the site selector in the top-right corner to configure its catalog."})]})});if(te)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"w-12 h-12 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin"})});const i=T.find(s=>s.id===l);return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Site Catalog Configuration"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Configure which catalog ",e.jsx("span",{className:"font-semibold",children:r.name})," uses and set up exclusions"]})]}),A&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 flex-shrink-0"}),A]}),B&&e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 flex-shrink-0"}),B]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(pe,{className:"w-5 h-5 text-[#D91C81]"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Catalog Assignment"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Catalog ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:l,onChange:s=>I(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"",children:"-- Select a Catalog --"}),T.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.type.toUpperCase(),") - ",s.totalProducts," products"]},s.id))]})]}),i&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-1",children:i.name}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:i.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",i.type.toUpperCase()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Source:"})," ",i.source.sourceSystem]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Products:"})," ",i.activeProducts," active / ",i.totalProducts," total"]})]})]})]})})]})]}),l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(be,{className:"w-5 h-5 text-[#D91C81]"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Product Exclusions"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Exclude specific categories, SKUs, tags, or brands from being visible on this site."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excluded Categories"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:x,onChange:s=>K(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),Y()),placeholder:"Enter category name",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:Y,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Add"]})]}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[s,e.jsx("button",{type:"button",onClick:()=>ie(s),className:"hover:text-red-600",children:e.jsx(p,{className:"w-3 h-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excluded SKUs"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:u,onChange:s=>M(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),Z()),placeholder:"Enter SKU",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:Z,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Add"]})]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm font-mono",children:[s,e.jsx("button",{type:"button",onClick:()=>ne(s),className:"hover:text-red-600",children:e.jsx(p,{className:"w-3 h-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excluded Tags"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:g,onChange:s=>U(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),_()),placeholder:"Enter tag",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:_,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Add"]})]}),o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[e.jsx(ye,{className:"w-3 h-3"}),s,e.jsx("button",{type:"button",onClick:()=>ce(s),className:"hover:text-red-600",children:e.jsx(p,{className:"w-3 h-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excluded Brands"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:h,onChange:s=>H(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),ee()),placeholder:"Enter brand name",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:ee,className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Add"]})]}),d.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[s,e.jsx("button",{type:"button",onClick:()=>oe(s),className:"hover:text-red-600",children:e.jsx(p,{className:"w-3 h-3"})})]},s))})]})]})]}),l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"w-5 h-5 text-[#D91C81]"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Price Overrides"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"allowPriceOverride",checked:C,onChange:s=>R(s.target.checked),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"allowPriceOverride",className:"text-sm font-medium text-gray-700",children:"Allow price overrides for this site"})]}),C&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Global Price Adjustment (%)"}),e.jsx("input",{type:"number",value:w,onChange:s=>L(Number(s.target.value)),placeholder:"0",min:"-100",max:"100",step:"0.1",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Positive values increase prices, negative values decrease them. Leave at 0 for no adjustment."})]})]})]}),l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ve,{className:"w-5 h-5 text-[#D91C81]"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Availability Rules"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Control which products are visible based on inventory and pricing."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"hideOutOfStock",checked:$,onChange:s=>q(s.target.checked),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"hideOutOfStock",className:"text-sm font-medium text-gray-700",children:"Hide out of stock products"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"hideDiscontinued",checked:G,onChange:s=>X(s.target.checked),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"hideDiscontinued",className:"text-sm font-medium text-gray-700",children:"Hide discontinued products"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"onlyShowFeatured",checked:V,onChange:s=>W(s.target.checked),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"onlyShowFeatured",className:"text-sm font-medium text-gray-700",children:"Only show featured products"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Inventory Threshold"}),e.jsx("input",{type:"number",value:S,onChange:s=>z(Number(s.target.value)),placeholder:"0",min:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hide products with inventory below this amount"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Price ($)"}),e.jsx("input",{type:"number",value:D,onChange:s=>Q(Number(s.target.value)),placeholder:"0",min:"0",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Price ($)"}),e.jsx("input",{type:"number",value:k,onChange:s=>J(Number(s.target.value)),placeholder:"0",min:"0",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e.jsxs("button",{type:"button",onClick:P,disabled:b,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Reset"]}),e.jsx("button",{type:"button",onClick:le,disabled:b||!l,className:"px-6 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4"}),"Save Configuration"]})})]})]})]})}export{Ke as default};
