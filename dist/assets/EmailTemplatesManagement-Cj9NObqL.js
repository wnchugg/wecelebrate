import{r as o,j as e,S as Y,C as t}from"./index-DHDOl0g2.js";import{a as J}from"./usePhase5A-CBK5OL7K.js";import{a as x,s as j}from"./errorHandling-cB_D8Kf8.js";import{B as f}from"./badge-SpbMApKn.js";import{D as w,a as T,b as C,c as E,d as S,e as D}from"./dialog-D59bRHfc.js";import{I as n}from"./input-nH9JeeLB.js";import{L as r}from"./label-CTcOiWw4.js";import{T as F}from"./textarea-D9owg_uV.js";import{P}from"./plus-Du5_lMGy.js";import{M}from"./mail-BTrZHThJ.js";import{E as K}from"./eye-11lXgXQ8.js";import{C as X}from"./copy-HrjeJ2VP.js";import{S as Z}from"./square-pen-D4GEpeV_.js";import{T as ee}from"./trash-2-c4zWA-a_.js";import"./index-0KHVUZMN.js";import"./index-lgbBQNXr.js";import"./index-BkT7IzDf.js";import"./index-DDay136h.js";import"./index-2uzMacW4.js";import"./index-fna-u0r9.js";function be(){const[V,H]=o.useState(""),[h,k]=o.useState("all"),[u,_]=o.useState("all"),[O,d]=o.useState(!1),[q,p]=o.useState(!1),[a,c]=o.useState(null),[i,A]=o.useState(null),[B,v]=o.useState(!1),{templates:y,loading:L,error:g,createTemplate:b,updateTemplate:$,deleteTemplate:z}=J({templateType:h==="all"?void 0:h,eventType:u==="all"?void 0:u}),I=async s=>{s.preventDefault();const l=new FormData(s.currentTarget),m={name:l.get("name"),description:l.get("description"),templateType:l.get("templateType"),eventType:l.get("eventType"),subject:l.get("subject"),bodyHtml:l.get("bodyHtml"),bodyText:l.get("bodyText"),fromName:l.get("fromName"),fromEmail:l.get("fromEmail"),status:l.get("status")||"active"};try{a?(await $(a.id,m),x("Template updated successfully")):(await b(m),x("Template created successfully")),d(!1),c(null)}catch(R){j(R.message||"Failed to save template")}},U=async(s,l)=>{if(confirm(`Are you sure you want to delete "${l}"?`)){v(!0);try{await z(s),x(`"${l}" deleted successfully`)}catch(m){j(m.message||"Failed to delete template")}finally{v(!1)}}},W=async s=>{try{await b({...s,name:`${s.name} (Copy)`,isDefault:!1}),x("Template duplicated successfully")}catch(l){j(l.message||"Failed to duplicate template")}},N=()=>{c(null),d(!0)},G=s=>{c(s),d(!0)},Q=s=>{A(s),p(!0)};return L?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading templates..."})}):g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-red-500",children:["Error: ",g]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Email Templates"}),e.jsx("p",{className:"text-gray-600",children:"Manage email templates for automated notifications"})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(n,{type:"text",placeholder:"Search templates...",value:V,onChange:s=>H(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:h,onChange:s=>k(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"global",children:"Global"}),e.jsx("option",{value:"site",children:"Site"}),e.jsx("option",{value:"client",children:"Client"})]}),e.jsxs("select",{value:u,onChange:s=>_(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Events"}),e.jsx("option",{value:"order_confirmation",children:"Order Confirmation"}),e.jsx("option",{value:"shipping_notification",children:"Shipping Notification"}),e.jsx("option",{value:"delivery_confirmation",children:"Delivery Confirmation"}),e.jsx("option",{value:"employee_added",children:"Employee Welcome"})]}),e.jsxs(t,{onClick:N,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"New Template"]})]}),e.jsx("div",{className:"space-y-4",children:y.map(s=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(M,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),s.isDefault&&e.jsx(f,{variant:"default",children:"Default"}),e.jsx(f,{variant:s.status==="active"?"default":"secondary",children:s.status}),e.jsx(f,{variant:"outline",children:s.templateType})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Event:"})," ",e.jsx("span",{className:"text-gray-900",children:s.eventType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Subject:"})," ",e.jsx("span",{className:"text-gray-900",children:s.subject})]}),s.fromName&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"From:"})," ",e.jsx("span",{className:"text-gray-900",children:s.fromName})]}),s.fromEmail&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",e.jsx("span",{className:"text-gray-900",children:s.fromEmail})]})]}),s.variables&&s.variables.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Variables: "}),e.jsx("div",{className:"inline-flex flex-wrap gap-1 mt-1",children:s.variables.map(l=>e.jsx("code",{className:"px-2 py-1 bg-gray-100 text-xs rounded",children:`{{${l}}}`},l))})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>Q(s),children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>W(s),children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>G(s),children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>U(s.id,s.name),disabled:B||s.isDefault,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(ee,{className:"w-4 h-4"})})]})]})},s.id))}),y.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first email template"}),e.jsxs(t,{onClick:N,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Create Template"]})]}),e.jsx(w,{open:O,onOpenChange:d,children:e.jsxs(T,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(C,{children:[e.jsx(E,{children:a?"Edit Template":"Create New Template"}),e.jsx(S,{children:a?"Update email template":"Add a new email template"})]}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"name",children:"Template Name *"}),e.jsx(n,{id:"name",name:"name",defaultValue:a==null?void 0:a.name,required:!0,placeholder:"e.g., Order Confirmation"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"eventType",children:"Event Type *"}),e.jsxs("select",{id:"eventType",name:"eventType",defaultValue:a==null?void 0:a.eventType,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"order_confirmation",children:"Order Confirmation"}),e.jsx("option",{value:"shipping_notification",children:"Shipping Notification"}),e.jsx("option",{value:"delivery_confirmation",children:"Delivery Confirmation"}),e.jsx("option",{value:"employee_added",children:"Employee Welcome"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(n,{id:"description",name:"description",defaultValue:a==null?void 0:a.description,placeholder:"Brief description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"templateType",children:"Template Type *"}),e.jsxs("select",{id:"templateType",name:"templateType",defaultValue:(a==null?void 0:a.templateType)||"global",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"global",children:"Global"}),e.jsx("option",{value:"site",children:"Site-Specific"}),e.jsx("option",{value:"client",children:"Client-Specific"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",name:"status",defaultValue:(a==null?void 0:a.status)||"active",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"subject",children:"Email Subject *"}),e.jsx(n,{id:"subject",name:"subject",defaultValue:a==null?void 0:a.subject,required:!0,placeholder:"e.g., Your Order Confirmation - {{orderNumber}}"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"fromName",children:"From Name"}),e.jsx(n,{id:"fromName",name:"fromName",defaultValue:a==null?void 0:a.fromName,placeholder:"e.g., WeCelebrate"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"fromEmail",children:"From Email"}),e.jsx(n,{id:"fromEmail",name:"fromEmail",type:"email",defaultValue:a==null?void 0:a.fromEmail,placeholder:"e.g., noreply@wecelebrate.com"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"bodyHtml",children:"HTML Body *"}),e.jsx(F,{id:"bodyHtml",name:"bodyHtml",defaultValue:a==null?void 0:a.bodyHtml,required:!0,placeholder:"<html><body>...</body></html>",rows:8,className:"font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"bodyText",children:"Plain Text Body"}),e.jsx(F,{id:"bodyText",name:"bodyText",defaultValue:a==null?void 0:a.bodyText,placeholder:"Plain text version of the email",rows:6})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium mb-2",children:"Available Variables:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["userName","orderNumber","giftName","orderTotal","trackingNumber","companyName"].map(s=>e.jsx("code",{className:"px-2 py-1 bg-white text-xs rounded border border-blue-200",children:`{{${s}}}`},s))})]})]}),e.jsxs(D,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>{d(!1),c(null)},children:"Cancel"}),e.jsx(t,{type:"submit",children:a?"Update Template":"Create Template"})]})]})]})}),e.jsx(w,{open:q,onOpenChange:p,children:e.jsxs(T,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(C,{children:[e.jsxs(E,{children:["Template Preview: ",i==null?void 0:i.name]}),e.jsx(S,{children:"Preview of the email template"})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Subject"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded border",children:i.subject})]}),e.jsxs("div",{children:[e.jsx(r,{children:"HTML Preview"}),e.jsx("div",{className:"border rounded-lg p-4 bg-white",children:e.jsx("iframe",{srcDoc:i.bodyHtml,className:"w-full h-96 border-0",title:"Email Preview"})})]}),i.bodyText&&e.jsxs("div",{children:[e.jsx(r,{children:"Plain Text"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border text-sm whitespace-pre-wrap",children:i.bodyText})]})]}),e.jsx(D,{children:e.jsx(t,{onClick:()=>p(!1),children:"Close"})})]})})]})}export{be as EmailTemplatesManagement};
