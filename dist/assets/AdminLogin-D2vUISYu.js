import{u as k,r as i,a1 as B,l as m,j as e,U as P,L as D}from"./index-DHDOl0g2.js";import{E as F,A as $}from"./Alert-ASedXnjN.js";import{B as M,c as I,l as x,s as U,a as _,v as z}from"./frontendSecurity-fmu5WR13.js";import{s as g,a as R}from"./errorHandling-cB_D8Kf8.js";import{p as T}from"./apiErrors-Br52ABxq.js";import{L as y}from"./loader-circle-CxhB-7Ws.js";import{S as v}from"./shield-DZ_C3_ZQ.js";import{M as q}from"./mail-BTrZHThJ.js";import{L as O}from"./lock-dtn2hE9b.js";import{E as H}from"./eye-off-BDRka7V8.js";import{E as V}from"./eye-11lXgXQ8.js";import"./badge-SpbMApKn.js";import"./circle-check-big-BYmGA9PQ.js";import"./info-Bs8xUcz2.js";import"./circle-x-DNt9TFja.js";import"./circle-alert-HchCeVzY.js";function le(){const h=k(),[t,N]=i.useState(""),[l,L]=i.useState(""),[c,C]=i.useState(!1),[d,p]=i.useState(!1),[b,n]=i.useState(""),[r,u]=i.useState({}),{adminLogin:E,isAdminAuthenticated:w,isLoading:f}=B();i.useEffect(()=>{w&&!f&&(m.info("[AdminLogin] User already authenticated, redirecting to dashboard"),h("/admin/dashboard"))},[w,f,h]);const A=()=>{const s={};return t.trim()?t.includes("@")?z(t)||(s.identifier="Please enter a valid email address"):t.length<3&&(s.identifier="Username must be at least 3 characters"):s.identifier="Email or username is required",l?l.length<8&&(s.password="Password must be at least 8 characters"):s.password="Password is required",u(s),Object.keys(s).length===0},S=async s=>{s.preventDefault(),n(""),m.info("[AdminLogin] Attempting login",{identifier:t.substring(0,3)+"***"});const j=I("admin_login",5,3e5);if(!j.allowed){const a=Math.ceil((j.retryAfter??0)/6e4),o=`Too many login attempts. Please try again in ${a} minute${a!==1?"s":""}.`;n(o),g(o),x({type:"rate_limit",details:`Admin login rate limit exceeded for ${t}`,severity:"medium"});return}if(A()){p(!0);try{const a=U(t.trim().toLowerCase());await E(a,l)?(m.info("[AdminLogin] Login successful"),_("admin_login"),R("Welcome back! Redirecting to dashboard...")):(m.warn("[AdminLogin] Login returned false"),n("Invalid email/username or password"),g("Login failed"),x({type:"auth_failure",details:`Failed admin login attempt for ${a}`,severity:"medium"}))}catch(a){m.error("[AdminLogin] Login error:",a);const o=T(a);n(o),g(a),x({type:"auth_failure",details:`Admin login exception: ${o}`,severity:"high"})}finally{p(!1)}}};return f?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"w-12 h-12 text-white animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Checking authentication..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center p-6",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(F,{})}),e.jsx("div",{className:"fixed top-4 left-4 z-50",children:e.jsx(M,{})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 md:p-12 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#D91C81] to-[#B71569] rounded-full mb-4",children:e.jsx(v,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to manage your platform"})]}),b&&e.jsx($,{variant:"error",title:"Login Failed",message:b,className:"mb-6"}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identifier",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email or Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:t.includes("@")?e.jsx(q,{className:"h-5 w-5 text-gray-400"}):e.jsx(P,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"identifier",type:"text",value:t,onChange:s=>{N(s.target.value),u({...r,identifier:void 0}),n("")},placeholder:"admin@example.com",autoComplete:"username",disabled:d,className:`w-full pl-12 pr-4 py-3 border ${r.identifier?"border-red-300":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent transition-all disabled:bg-gray-100 disabled:cursor-not-allowed`})]}),r.identifier&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.identifier})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(O,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",type:c?"text":"password",value:l,onChange:s=>{L(s.target.value),u({...r,password:void 0}),n("")},placeholder:"••••••••",autoComplete:"current-password",disabled:d,className:`w-full pl-12 pr-12 py-3 border ${r.password?"border-red-300":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent transition-all disabled:bg-gray-100 disabled:cursor-not-allowed`}),e.jsx("button",{type:"button",onClick:()=>C(!c),disabled:d,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed","aria-label":c?"Hide password":"Show password",children:c?e.jsx(H,{className:"h-5 w-5"}):e.jsx(V,{className:"h-5 w-5"})})]}),r.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.password})]}),e.jsx("button",{type:"submit",disabled:d||!t||!l,className:"w-full bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white py-3 px-4 rounded-lg font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-none flex items-center justify-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5"}),"Sign In"]})}),e.jsx("div",{className:"text-center",children:e.jsx(D,{to:"/admin/forgot-password",className:"text-sm text-[#D91C81] hover:text-[#B71569] font-medium transition-colors",children:"Forgot your password?"})})]})]})]})}export{le as default};
