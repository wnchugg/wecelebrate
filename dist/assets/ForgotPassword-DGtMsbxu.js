import{r,j as e,f as m,o as C,l as c,a3 as S}from"./index-o4gpx1In.js";import{E as b,A as E}from"./Alert-6n0gpoYQ.js";import{B as j,c as k,l as x,s as B,v as P}from"./frontendSecurity-Dqq1PZ0q.js";import{s as L,a as A}from"./errorHandling-CFBDpS8c.js";import{C as D}from"./circle-check-big-b_APp8Jk.js";import{S as F}from"./shield-Bpl7O2Ou.js";import{C as R}from"./circle-alert-Bm1NT70L.js";import{M as w}from"./mail-qbw95uc6.js";import{L as q}from"./loader-circle-DEMR-8fp.js";import"./badge-C5gk6m_5.js";import"./info-CRJhujo5.js";import"./circle-x-Bc15q1z6.js";function K(){const[s,u]=r.useState(""),[i,h]=r.useState(!1),[y,l]=r.useState(!1),[f,o]=r.useState(""),[n,a]=r.useState(""),v=()=>s.trim()?P(s)?!0:(a("Please enter a valid email address"),!1):(a("Email is required"),!1),N=async d=>{d.preventDefault(),o(""),a(""),c.info("[ForgotPassword] Requesting password reset",{email:s.substring(0,3)+"***"});const g=k("password_reset",3,9e5);if(!g.allowed){const t=Math.ceil(g.retryAfter/6e4),p=`Too many password reset attempts. Please try again in ${t} minute${t!==1?"s":""}.`;o(p),L(p),x({type:"rate_limit",details:`Password reset rate limit exceeded for ${s}`,severity:"medium"});return}if(v()){h(!0);try{const t=B(s.trim().toLowerCase());await S("/admin/forgot-password",{method:"POST",body:JSON.stringify({email:t})}),c.info("[ForgotPassword] Password reset request successful"),l(!0),A("Password reset instructions sent!"),x({type:"password_reset_request",details:`Password reset requested for ${t}`,severity:"low"})}catch(t){c.error("[ForgotPassword] Error:",t),l(!0),x({type:"password_reset_error",details:`Password reset error for ${s}: ${t.message}`,severity:"medium"})}finally{h(!1)}}};return y?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center p-6",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(b,{})}),e.jsx("div",{className:"fixed top-4 left-4 z-50",children:e.jsx(j,{})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-8 md:p-12 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(D,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Check Your Email"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["If an account exists for ",e.jsx("span",{className:"font-medium text-gray-900",children:s}),", you will receive password reset instructions shortly."]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," The reset link will expire in 1 hour for security reasons."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(m,{to:"/admin/login",className:"block w-full bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white py-3 px-4 rounded-lg font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all text-center",children:"Back to Login"}),e.jsx("button",{onClick:()=>{l(!1),u("")},className:"block w-full bg-white text-gray-700 py-3 px-4 rounded-lg font-medium border border-gray-300 hover:bg-gray-50 transition-colors text-center",children:"Send Another Request"})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#1B2A5E] via-[#D91C81] to-[#00B4CC] flex items-center justify-center p-6",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(b,{})}),e.jsx("div",{className:"fixed top-4 left-4 z-50",children:e.jsx(j,{})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 md:p-12 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#D91C81] to-[#B71569] rounded-full mb-4",children:e.jsx(F,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your email to receive reset instructions"})]}),e.jsxs(m,{to:"/admin/login",className:"inline-flex items-center text-sm text-gray-600 hover:text-[#D91C81] mb-6 transition-colors",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),"Back to Login"]}),f&&e.jsx(E,{variant:"error",title:"Error",message:f,className:"mb-6"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Security Information"}),e.jsx("p",{children:"For your security, we'll send reset instructions only if this email is associated with an admin account."})]})]})}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(w,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",type:"email",value:s,onChange:d=>{u(d.target.value),a(""),o("")},placeholder:"admin@example.com",autoComplete:"email",disabled:i,className:`w-full pl-12 pr-4 py-3 border ${n?"border-red-300":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent transition-all disabled:bg-gray-100 disabled:cursor-not-allowed`})]}),n&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:n})]}),e.jsx("button",{type:"submit",disabled:i||!s,className:"w-full bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white py-3 px-4 rounded-lg font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:shadow-none flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-5 h-5"}),"Send Reset Link"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",e.jsx(m,{to:"/admin/login",className:"text-[#D91C81] hover:text-[#B71569] font-medium",children:"Sign in"})]})})]})]})}export{K as default};
