import{m as Fe,r as h,j as e,C as f,t as u,l as Y,am as Ae,g as ge,w as Pe,c as Le,S as K,U as Me,X as fe,a7 as Re,q as Ue,G as $e}from"./index-DAep3-17.js";import{E as de}from"./exceljs.min-CjE7kP5-.js";import{s as _e,p as Be}from"./fileSecurityHelpers-CSk_xi4i.js";import{D as Ve,a as Je,b as Te,c as Oe,d as ze,e as Xe}from"./dialog-DxmycFb0.js";import{B as Z}from"./badge-CKAfVDe6.js";import{T as We,a as qe,b as he,c as pe}from"./tabs-0I4LxGB_.js";import{A as se,b as ae}from"./alert-CNc3tQv-.js";import{U as ye}from"./users-BInxthQ2.js";import{U as O}from"./upload-CPOO72Jy.js";import{D as H}from"./download-C6Tum4sE.js";import{F as Ge}from"./file-spreadsheet-C72d3up4.js";import{C as Qe}from"./circle-check-big-Dewj6UrC.js";import{C as Ye}from"./circle-x-BFN1fzT3.js";import{C as te}from"./circle-alert-BJpcJige.js";import{F as Ke}from"./file-text-FCbbDMlz.js";import{L as re}from"./loader-circle-DZ1z-CmB.js";import{S as ee}from"./square-pen-Bj3YdsC1.js";import{K as Ze}from"./key-BSEOBSLQ.js";import{E as He}from"./eye-off-ttBGpPEa.js";import{E as es}from"./eye-BXXJW7Ry.js";import{s as ce}from"./supabase-DvttA2W0.js";import{P as ie}from"./plus-U3aaopYz.js";import{M as ue}from"./mail-BlQiYOtl.js";import{T as ne}from"./trash-2-orf3MXe6.js";import{I as ss}from"./id-card-Df83phs_.js";import{C as as}from"./credit-card-BMMipEi8.js";import"./index-BBIAgE77.js";import"./index-Dxauqy8w.js";import"./index-CH-6Jnw9.js";import"./index-NQBsc09o.js";import"./index-GxwXKa5n.js";import"./index-CE6KxwT7.js";import"./index-7D9TSwIG.js";import"./index-b2qZ5oZ4.js";import"./index-D_kBqr1b.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],rs=Fe("user-check",ts);function ls({open:r,onClose:t,validationType:s,onImport:p}){const[o,m]=h.useState(!1),[d,j]=h.useState([]),[b,x]=h.useState({valid:0,errors:0,duplicates:0}),w=h.useRef(null),P=async l=>{var k;const N=(k=l.target.files)==null?void 0:k[0];if(N){m(!0);try{const E=await N.arrayBuffer(),A=new de.Workbook;await A.xlsx.load(E);let g=A.getWorksheet(1).getSheetValues();g=_e(g);const C=Be(N,g,{maxSizeMB:5,allowedExtensions:[".csv",".xlsx",".xls"],maxRows:1e4,maxCellLength:500});if(!C.isValid){u.error(`Security validation failed: ${C.errors.join(", ")}`),Y.error("File security check failed:",C.errors);return}C.warnings.length>0&&Y.warn("File security warnings:",C.warnings);const M=g.slice(1).filter(c=>Array.isArray(c)&&c.length>0).map((c,V)=>{const S=c,v={id:`temp-${V}`,email:S[1]||"",employeeId:S[2]||"",firstName:S[3]||"",lastName:S[4]||"",department:S[5]||"",serialCard:S[6]||"",status:"valid"};return(s==="email"||s==="magicLink")&&(!v.email||!i(v.email))&&(v.status="error",v.errorMessage="Invalid or missing email address"),s==="employeeId"&&(v.employeeId||(v.status="error",v.errorMessage="Missing employee ID"),(!v.email||!i(v.email))&&(v.status="error",v.errorMessage="Invalid or missing email address")),s==="serialCard"&&(v.serialCard||(v.status="error",v.errorMessage="Missing serial card number")),v}),B=new Set,U=new Set,X=new Set;M.forEach(c=>{c.email&&B.has(c.email.toLowerCase())?(c.status="duplicate",c.errorMessage="Duplicate email address"):c.email&&B.add(c.email.toLowerCase()),c.employeeId&&U.has(c.employeeId)?(c.status="duplicate",c.errorMessage="Duplicate employee ID"):c.employeeId&&U.add(c.employeeId),c.serialCard&&X.has(c.serialCard)?(c.status="duplicate",c.errorMessage="Duplicate serial card"):c.serialCard&&X.add(c.serialCard)});const W=M.filter(c=>c.status==="valid").length,le=M.filter(c=>c.status==="error").length,q=M.filter(c=>c.status==="duplicate").length;j(M),x({valid:W,errors:le,duplicates:q}),u.success(`Processed ${M.length} records`)}catch(E){Y.error("Import error:",E),u.error("Failed to process file. Please check the format.")}finally{m(!1)}}},i=l=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l),I=()=>{const l=d.filter(N=>N.status==="valid");p(l),u.success(`Imported ${l.length} employee records`),L()},L=()=>{j([]),x({valid:0,errors:0,duplicates:0}),w.current&&(w.current.value=""),t()},_=async()=>{let l=[];s==="email"||s==="magicLink"?l=[{Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]:s==="employeeId"?l=[{"Employee ID":"EMP001",Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{"Employee ID":"EMP002",Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]:s==="serialCard"&&(l=[{"Serial Card":"CARD-ABC123XYZ",Email:"john.doe@company.com","First Name":"John","Last Name":"Doe",Department:"Sales"},{"Serial Card":"CARD-DEF456UVW",Email:"jane.smith@company.com","First Name":"Jane","Last Name":"Smith",Department:"Marketing"}]);try{const N=new de.Workbook,k=N.addWorksheet("Employees");if(l.length>0){const g=Object.keys(l[0]);k.addRow(g),l.forEach(M=>{k.addRow(Object.values(M))});const C=k.getRow(1);C.font={bold:!0},C.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD91C81"}}}const E=await N.xlsx.writeBuffer(),A=new Blob([E],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=document.createElement("a");y.href=URL.createObjectURL(A),y.download=`employee_import_template_${s}.xlsx`,y.click(),u.success("Template downloaded")}catch(N){Y.error("Template download error:",N),u.error("Failed to download template")}},F=()=>{switch(s){case"email":return"Email Address";case"employeeId":return"Employee ID";case"serialCard":return"Serial Card";case"magicLink":return"Email Address";default:return"Identifier"}};return e.jsx(Ve,{open:r,onOpenChange:L,children:e.jsxs(Je,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Te,{children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-[#D91C81]"}),"Import Employee Data"]}),e.jsxs(ze,{children:["Upload a CSV or Excel file to import employee records for ",F()," validation"]})]}),e.jsxs(We,{defaultValue:"upload",className:"mt-4",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsx(he,{value:"upload",children:"Upload File"}),e.jsx(he,{value:"instructions",children:"Instructions"})]}),e.jsxs(pe,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-[#D91C81] transition-colors",children:[e.jsx("input",{ref:w,type:"file",accept:".csv,.xlsx,.xls",onChange:P,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-sm text-gray-600",children:"CSV, XLSX, or XLS files (max 5MB)"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:_,className:"flex-1",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>{var l;return(l=w.current)==null?void 0:l.click()},className:"flex-1",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Choose File"]})]}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-semibold text-green-900",children:"Valid Records"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:b.valid})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-sm font-semibold text-red-900",children:"Errors"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:b.errors})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(te,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"text-sm font-semibold text-yellow-900",children:"Duplicates"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:b.duplicates})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Preview (",d.length," records)"]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Status"}),s!=="email"&&s!=="magicLink"&&e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:F()}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-2 font-semibold text-gray-700",children:"Department"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.slice(0,100).map((l,N)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-2",children:[l.status==="valid"&&e.jsx(Z,{className:"bg-green-100 text-green-800",children:"Valid"}),l.status==="error"&&e.jsx(Z,{className:"bg-red-100 text-red-800",children:"Error"}),l.status==="duplicate"&&e.jsx(Z,{className:"bg-yellow-100 text-yellow-800",children:"Duplicate"})]}),s==="employeeId"&&e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:l.employeeId}),s==="serialCard"&&e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:l.serialCard}),e.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:l.email}),e.jsxs("td",{className:"px-4 py-2",children:[l.firstName," ",l.lastName]}),e.jsx("td",{className:"px-4 py-2",children:l.department})]},N))})]})}),d.length>100&&e.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-t border-gray-200 text-sm text-gray-600",children:["Showing first 100 of ",d.length," records"]})]}),b.errors>0&&e.jsxs(se,{children:[e.jsx(te,{className:"h-4 w-4"}),e.jsxs(ae,{children:[b.errors," record(s) have validation errors and will not be imported.",b.duplicates>0&&` ${b.duplicates} duplicate(s) detected.`]})]})]})]}),e.jsxs(pe,{value:"instructions",className:"space-y-4",children:[e.jsxs(se,{children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx(ae,{children:"Follow these guidelines to ensure successful import"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Required Columns"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[s==="email"||s==="magicLink"?e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (required)"]}):null,s==="employeeId"?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Employee ID"})," - Unique employee identifier (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (required)"]})]}):null,s==="serialCard"?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Serial Card"})," - Unique card number (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Email"})," - Valid email address (optional but recommended)"]})]}):null]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Optional Columns"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"First Name"})," - Employee first name"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Last Name"})," - Employee last name"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Department"})," - Department or team name"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"File Format"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:"Supported formats: CSV, XLSX, XLS"}),e.jsx("li",{children:"First row must contain column headers"}),e.jsx("li",{children:"Column names are case-insensitive"}),e.jsx("li",{children:"Maximum file size: 5MB"}),e.jsx("li",{children:"Recommended maximum: 10,000 records per file"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Validation Rules"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:"Email addresses must be valid format"}),e.jsx("li",{children:"Duplicate entries within the file will be flagged"}),e.jsx("li",{children:"All required fields must have values"}),e.jsx("li",{children:"Empty rows will be skipped"})]})]})]})]})]}),e.jsxs(Xe,{children:[e.jsx(f,{variant:"outline",onClick:L,children:"Cancel"}),d.length>0&&b.valid>0&&e.jsx(f,{onClick:I,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Import ",b.valid," Records"]})})]})]})})}function os(){const t=ge().supabaseUrl.match(/https:\/\/([^.]+)\.supabase\.co/);return`https://${t?t[1]:Pe}.supabase.co/functions/v1/make-server-6fcaeea3`}async function z(r,t={}){const p=`${os()}${r}`,o=Ae();if(!o)throw new Error("Authentication required");const m={"Content-Type":"application/json","X-Access-Token":o,Authorization:`Bearer ${o}`,...t.headers||{}},d=ge();m["X-Environment-ID"]=d.id;const j=await fetch(p,{...t,headers:m}),b=await j.json();if(!j.ok)throw new Error(b.error||`Request failed with status ${j.status}`);return b}async function is(r){return(await z(`/v2/employees?site_id=${r}`)).data}async function ns(r,t){return(await z("/v2/employees",{method:"POST",body:JSON.stringify({site_id:r,...t})})).data}async function ds(r,t,s){return(await z(`/v2/employees/${r}`,{method:"PUT",body:JSON.stringify({site_id:t,...s})})).data}async function cs(r,t){await z(`/v2/employees/${r}`,{method:"DELETE"})}async function ms(r,t){const s=await z("/v2/employees/bulk-import",{method:"POST",body:JSON.stringify({site_id:r,employees:t})});return{imported:s.imported,errors:s.errors,employees:s.employees}}function me(){const{currentLanguage:r}=Le(),t=r.code,s=(o,m,d)=>["ja","zh","zh-TW","ko"].includes(t)?d?`${m} ${d} ${o}`:`${m} ${o}`:d?`${o} ${d} ${m}`:`${o} ${m}`;return{formatFullName:s,formatFormalName:(o,m,d)=>{const j=s(o,m);return d?`${d} ${j}`:j}}}function xs({users:r,loading:t,onEditUser:s,onSetPassword:p,onProxyLogin:o,hasProxyPermission:m}){const[d,j]=h.useState(""),{formatFullName:b}=me(),x=r.filter(i=>{var L;const I=d.toLowerCase();return i.email.toLowerCase().includes(I)||i.firstName.toLowerCase().includes(I)||i.lastName.toLowerCase().includes(I)||((L=i.employeeId)==null?void 0:L.toLowerCase().includes(I))}),w=i=>{switch(i){case"admin":return"bg-red-100 text-red-800 border-red-200";case"manager":return"bg-blue-100 text-blue-800 border-blue-200";case"employee":return"bg-green-100 text-green-800 border-green-200";case"viewer":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},P=i=>{switch(i){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-gray-100 text-gray-800 border-gray-200";case"suspended":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users by name, email, or employee ID...",value:d,onChange:i=>j(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),t?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(re,{className:"w-8 h-8 text-[#D91C81] animate-spin"})}):x.length===0?e.jsxs("div",{className:"text-center py-12 border border-gray-200 rounded-lg",children:[e.jsx(Me,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No users found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:d?`No users matching "${d}"`:"Users will appear here when added"})]}):e.jsx("div",{className:"space-y-2",children:x.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[#D91C81] to-purple-600 flex items-center justify-center text-white font-semibold",children:[i.firstName[0],i.lastName[0]]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:b(i.firstName,i.lastName)}),e.jsx("p",{className:"text-sm text-gray-600",children:i.email}),e.jsxs("div",{className:"flex gap-2 mt-1 flex-wrap",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${w(i.role)}`,children:i.role}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${P(i.status)}`,children:i.status}),i.employeeId&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full border bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",i.employeeId]}),i.forcePasswordReset&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full border bg-amber-100 text-amber-800 border-amber-200",children:"Password Reset Required"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>s(i),className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-4 h-4"}),"Edit"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>p(i),className:"flex items-center gap-1",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Set Password"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>o(i),disabled:!m,className:"flex items-center gap-1",title:m?"Login as this user":"You do not have permission to proxy login",children:[e.jsx(rs,{className:"w-4 h-4"}),"Login As"]})]})]},i.id))}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600",children:e.jsxs("p",{children:[x.length," user",x.length!==1?"s":"",d&&` matching "${d}"`]})})]})}function hs({open:r,user:t,onClose:s,onSave:p}){const[o,m]=h.useState({firstName:"",lastName:"",email:"",employeeId:"",role:"employee",status:"active"}),[d,j]=h.useState(!1);h.useEffect(()=>{t&&m({firstName:t.firstName,lastName:t.lastName,email:t.email,employeeId:t.employeeId||"",role:t.role,status:t.status})},[t]);const b=async()=>{if(t){j(!0);try{await p(t.id,o),s()}catch(x){console.error("Failed to save user:",x)}finally{j(!1)}}};return!r||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fe,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.firstName,onChange:x=>m({...o,firstName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"John"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.lastName,onChange:x=>m({...o,lastName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"Doe"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:o.email,onChange:x=>m({...o,email:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"john.doe@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),e.jsx("input",{type:"text",value:o.employeeId,onChange:x=>m({...o,employeeId:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"EMP-001"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:o.role,onChange:x=>m({...o,role:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Determines user permissions and access level"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:o.status,onChange:x=>m({...o,status:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active users can login, inactive users cannot"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:s,disabled:d,className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void b(),disabled:d||!o.firstName||!o.lastName||!o.email,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:d?"Saving...":"Save Changes"})]})]})})}function ps({open:r,user:t,onClose:s,onSetPassword:p}){const[o,m]=h.useState(""),[d,j]=h.useState(!0),[b,x]=h.useState(!1),[w,P]=h.useState(!1),{formatFullName:i}=me();h.useEffect(()=>{r&&(m(I()),j(!0),x(!1))},[r]);const I=()=>{const N="ABCDEFGHIJKLMNOPQRSTUVWXYZ",k="abcdefghijklmnopqrstuvwxyz",E="0123456789",A="!@#$%^&*",y=N+k+E+A;let g="";g+=N[Math.floor(Math.random()*N.length)],g+=k[Math.floor(Math.random()*k.length)],g+=E[Math.floor(Math.random()*E.length)],g+=A[Math.floor(Math.random()*A.length)];for(let C=g.length;C<16;C++)g+=y[Math.floor(Math.random()*y.length)];return g.split("").sort(()=>Math.random()-.5).join("")},L=()=>{m(I()),x(!0)},_=async()=>{if(!(!t||!o)){P(!0);try{await p(t.id,o,d),s()}catch(l){console.error("Failed to set password:",l)}finally{P(!1)}}},F=o.length>=8;return!r||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Set Temporary Password"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["For ",i(t.firstName,t.lastName)]})]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fe,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Temporary Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b?"text":"password",value:o,onChange:l=>m(l.target.value),className:"w-full px-3 py-2 pr-20 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none font-mono text-sm",placeholder:"Enter password"}),e.jsx("button",{type:"button",onClick:()=>x(!b),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded transition-colors",children:b?e.jsx(He,{className:"w-4 h-4 text-gray-500"}):e.jsx(es,{className:"w-4 h-4 text-gray-500"})})]}),!F&&o&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Password must be at least 8 characters"})]}),e.jsxs(f,{variant:"outline",onClick:L,className:"w-full flex items-center justify-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Generate Random Password"]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"forceReset",checked:d,onChange:l=>j(l.target.checked),className:"mt-0.5 w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"forceReset",className:"text-sm text-gray-700 cursor-pointer",children:"Force user to reset password on next login"})]}),e.jsxs(se,{variant:"default",className:"bg-blue-50 border-blue-200",children:[e.jsx(te,{className:"w-4 h-4 text-blue-600"}),e.jsxs(ae,{className:"text-sm text-blue-900",children:["The temporary password will be sent to the user's email address (",t.email,").",d&&" They will be required to change it on their first login."]})]}),!d&&e.jsxs(se,{variant:"default",className:"bg-amber-50 border-amber-200",children:[e.jsx(te,{className:"w-4 h-4 text-amber-600"}),e.jsx(ae,{className:"text-sm text-amber-900",children:"For security, it's recommended to force password reset on first login."})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:s,disabled:w,className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void _(),disabled:w||!F,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:w?"Setting Password...":"Set Password"})]})]})})}async function us(r){const{data:t,error:s}=await ce.from("site_users").select("*").eq("site_id",r).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching users:",s),new Error("Failed to fetch users");return t.map(p=>({id:p.id,email:p.email,firstName:p.first_name,lastName:p.last_name,employeeId:p.employee_id,role:p.role,status:p.status,forcePasswordReset:p.force_password_reset||!1,lastLogin:p.last_login?new Date(p.last_login):void 0,createdAt:new Date(p.created_at),updatedAt:new Date(p.updated_at),metadata:p.metadata}))}async function gs(r){const t={updated_at:new Date().toISOString()};r.firstName!==void 0&&(t.first_name=r.firstName),r.lastName!==void 0&&(t.last_name=r.lastName),r.email!==void 0&&(t.email=r.email),r.employeeId!==void 0&&(t.employee_id=r.employeeId),r.role!==void 0&&(t.role=r.role),r.status!==void 0&&(t.status=r.status);const{error:s}=await ce.from("site_users").update(t).eq("id",r.userId);if(s)throw console.error("Error updating user:",s),new Error("Failed to update user")}async function fs(r){const t={force_password_reset:r.forcePasswordReset,updated_at:new Date().toISOString()},{error:s}=await ce.from("site_users").update(t).eq("id",r.userId);if(s)throw console.error("Error setting password:",s),new Error("Failed to set password");console.log("Sending password email to user:",r.userId)}function Hs({mode:r="simple",validationMethod:t="email"}){const{currentSite:s,currentClient:p,updateSite:o}=Ue(),{formatFullName:m}=me(),[d,j]=h.useState(!1),[b,x]=h.useState(!1),[w,P]=h.useState(null),[i,I]=h.useState([]),[L,_]=h.useState([]),[F,l]=h.useState(!1),[N,k]=h.useState(""),[E,A]=h.useState(""),[y,g]=h.useState({email:"",employeeId:"",serialCard:"",name:"",department:""}),[C,M]=h.useState([]),[B,U]=h.useState(null),[X,W]=h.useState(!1),[le,q]=h.useState(!1),[c]=h.useState(!0);h.useEffect(()=>{if(s!=null&&s.id){r==="advanced"?V():S();const a=s.settings.allowedDomains;A(a?a.join(", "):"")}},[s==null?void 0:s.id,r]);const V=async()=>{if(s!=null&&s.id){l(!0);try{const a=await us(s.id);M(a)}catch(a){console.error("Failed to load users:",a),u.error("Failed to load users")}finally{l(!1)}}},S=async()=>{if(s!=null&&s.id){l(!0);try{const a=await is(s.id);_(a)}catch(a){console.error("Failed to load employees:",a),a instanceof Error&&!a.message.includes("PGRST116")&&u.error("Failed to load employees")}finally{l(!1)}}},v=async()=>{if(s!=null&&s.id){if(!y.email&&!y.employeeId&&!y.serialCard){u.error("Please provide at least one identifier (email, employee ID, or serial card)");return}l(!0);try{await ns(s.id,y),u.success("Employee added successfully"),x(!1),g({email:"",employeeId:"",serialCard:"",name:"",department:""}),await S()}catch(a){console.error("Failed to add employee:",a),u.error("Failed to add employee")}finally{l(!1)}}},je=async()=>{if(!(!(s!=null&&s.id)||!w)){l(!0);try{await ds(w.id,s.id,y),u.success("Employee updated successfully"),P(null),g({email:"",employeeId:"",serialCard:"",name:"",department:""}),await S()}catch(a){console.error("Failed to update employee:",a),u.error("Failed to update employee")}finally{l(!1)}}},be=async a=>{if(s!=null&&s.id&&confirm("Are you sure you want to deactivate this employee?")){l(!0);try{await cs(a,s.id),u.success("Employee deactivated successfully"),await S()}catch(n){console.error("Failed to delete employee:",n),u.error("Failed to delete employee")}finally{l(!1)}}},Ne=async a=>{if(s!=null&&s.id){l(!0);try{const n=await ms(s.id,a);I(a),u.success(`Successfully imported ${n.imported} employees`),n.errors&&n.errors.length>0&&u.warning(`${n.errors.length} records had errors`),await S()}catch(n){console.error("Failed to import employees:",n),u.error("Failed to import employees")}finally{l(!1)}}},we=async()=>{if(s!=null&&s.id){l(!0);try{const a=E.split(",").map(n=>n.trim()).filter(n=>n.length>0);await o(s.id,{settings:{...s.settings,allowedDomains:a}}),u.success("Allowed domains saved successfully")}catch(a){console.error("Failed to save allowed domains:",a),u.error("Failed to save allowed domains")}finally{l(!1)}}},ve=a=>{U(a),W(!0)},Ce=a=>{U(a),q(!0)},De=a=>{u.info(`Proxy login for ${m(a.firstName,a.lastName)} - Coming soon`)},ke=async(a,n)=>{try{await gs({userId:a,firstName:n.firstName,lastName:n.lastName,email:n.email,employeeId:n.employeeId,role:n.role,status:n.status}),u.success("User updated successfully"),await V()}catch(D){throw console.error("Failed to update user:",D),u.error("Failed to update user"),D}},Ee=async(a,n,D)=>{try{await fs({userId:a,temporaryPassword:n,forcePasswordReset:D,sendEmail:!0}),u.success("Password set successfully. Email sent to user."),await V()}catch(R){throw console.error("Failed to set password:",R),u.error("Failed to set password"),R}},Se=a=>{P(a),g({email:a.email||"",employeeId:a.employeeId||"",serialCard:a.serialCard||"",name:a.name||"",department:a.department||""})},G=L.filter(a=>{var D,R,J,Q,$;const n=N.toLowerCase();return((D=a.email)==null?void 0:D.toLowerCase().includes(n))||((R=a.employeeId)==null?void 0:R.toLowerCase().includes(n))||((J=a.serialCard)==null?void 0:J.toLowerCase().includes(n))||((Q=a.name)==null?void 0:Q.toLowerCase().includes(n))||(($=a.department)==null?void 0:$.toLowerCase().includes(n))}),oe=()=>{const a=t;let n=[],D=[];switch(a){case"email":n=["Email Address","First Name","Last Name","Department"],D=[["john.doe@company.com","John","Doe","Engineering"],["jane.smith@company.com","Jane","Smith","Marketing"]];break;case"employeeId":n=["Employee ID","First Name","Last Name","Department"],D=[["EMP-001","John","Doe","Engineering"],["EMP-002","Jane","Smith","Marketing"]];break;case"serialCard":n=["Card Number","Employee Name","Department","Status"],D=[["CARD-ABC123XYZ","John Doe","Engineering","Active"],["CARD-DEF456UVW","Jane Smith","Marketing","Active"]];break;default:n=["Identifier","Name"],D=[["sample@email.com","Sample User"]]}const R=new de.Workbook,J=R.addWorksheet("Template");J.addRow(n),D.forEach($=>J.addRow($));const Q=`${a}_import_template.xlsx`;R.xlsx.writeBuffer().then($=>{const Ie=new Blob([new Uint8Array($)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),xe=window.URL.createObjectURL(Ie),T=document.createElement("a");T.href=xe,T.download=Q,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(xe)}),u.success("Template downloaded successfully")};return!s||!p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx($e,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Please select a site to manage access"})]}):e.jsxs("div",{className:"space-y-6",children:[t==="email"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Authorized Email Addresses"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.length," employee",i.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:oe,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>j(!0),children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",onClick:()=>x(!0),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Add Email"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Allowed Domains (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"e.g., company.com, business.org",value:E,onChange:a=>A(a.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"}),e.jsx(f,{onClick:()=>void we(),disabled:F,className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:"Save"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Comma-separated list of allowed email domains"})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search email addresses...",value:N,onChange:a=>k(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:F?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(re,{className:"w-8 h-8 text-[#D91C81] animate-spin"})}):G.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No employees found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add employees to manage access"})]}):e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:G.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm block",children:a.email}),a.name&&e.jsx("span",{className:"text-xs text-gray-500",children:a.name})]}),a.status==="inactive"&&e.jsx(Z,{variant:"secondary",className:"text-xs",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",onClick:()=>Se(a),children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",onClick:()=>void be(a.id),children:e.jsx(ne,{className:"w-4 h-4 text-red-600"})})]})]},a.id))})}),e.jsx("div",{className:"mt-4 flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[G.length," employee",G.length!==1?"s":"",N&&` matching "${N}"`]})})]}),t==="employeeId"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Authorized Employee IDs"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.length," employee",i.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:oe,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>j(!0),children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Add Employee ID"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search employee IDs...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:["EMP-001","EMP-002","EMP-003","EMP-004","EMP-005"].map((a,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ss,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm font-semibold",children:a})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(ne,{className:"w-4 h-4 text-red-600"})})]})]},n))})})]}),t==="serialCard"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Serial Card Numbers"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.length," card",i.length!==1?"s":""," imported"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:oe,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsxs(f,{variant:"outline",onClick:()=>j(!0),children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Import CSV"]}),e.jsxs(f,{className:"bg-[#D91C81] hover:bg-[#B01669] text-white",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Generate Cards"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search serial numbers...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:["CARD-ABC123XYZ","CARD-DEF456UVW","CARD-GHI789RST","CARD-JKL012MNO","CARD-PQR345JKL"].map((a,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(as,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm font-semibold",children:a}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full border border-green-200",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(ne,{className:"w-4 h-4 text-red-600"})})]})]},n))})})]}),r==="advanced"&&e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-[#D91C81]"}),"User Management"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage employee accounts, passwords, and permissions"})]})}),e.jsx(xs,{users:C,loading:F,onEditUser:ve,onSetPassword:Ce,onProxyLogin:De,hasProxyPermission:c})]}),e.jsx(ls,{open:d,onClose:()=>j(!1),validationType:t,onImport:a=>void Ne(a)}),(b||w)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:w?"Edit Employee":"Add Employee"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",t==="email"&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:y.email,onChange:a=>g({...y,email:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"john.doe@company.com"})]}),t==="employeeId"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.employeeId,onChange:a=>g({...y,employeeId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"EMP-001"})]}),t==="serialCard"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Serial Card ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.serialCard,onChange:a=>g({...y,serialCard:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"CARD-ABC123XYZ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:y.name,onChange:a=>g({...y,name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:y.department,onChange:a=>g({...y,department:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",placeholder:"Engineering"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(f,{variant:"outline",onClick:()=>{x(!1),P(null),g({email:"",employeeId:"",serialCard:"",name:"",department:""})},className:"flex-1",children:"Cancel"}),e.jsx(f,{onClick:()=>void(w?je():v()),disabled:F,className:"flex-1 bg-[#D91C81] hover:bg-[#B01669] text-white",children:F?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):w?"Update":"Add"})]})]})}),e.jsx(hs,{open:X,user:B,onClose:()=>{W(!1),U(null)},onSave:ke}),e.jsx(ps,{open:le,user:B,onClose:()=>{q(!1),U(null)},onSetPassword:Ee})]})}export{Hs as AccessManagement};
