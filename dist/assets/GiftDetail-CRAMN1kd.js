import{a as G,u as L,I as B,r as d,c as O,b as F,q as M,j as e,J as q,n as U,K as D,A as $,t as p,g as K,k as R,l as X}from"./index-C7jV57L-.js";import{M as z}from"./minus-BBS7YdJz.js";import{P as H}from"./plus-C2AKBA6c.js";function Y(){const{giftId:n,siteId:J}=G(),l=L(),{selectedGift:r,quantity:b,selectGift:S,setQuantity:k}=B(),[c,m]=d.useState(1),{t}=O(),[a,C]=d.useState(null),[E,j]=d.useState(!0),[y,g]=d.useState(null),{currentSite:Q}=F(),{currentSite:I}=M(),f=Q||I,o=f==null?void 0:f.settings,T=(o==null?void 0:o.allowQuantitySelection)??!1,x=(o==null?void 0:o.giftsPerUser)??1;if(d.useEffect(()=>{(async()=>{if(!n){l("../gift-selection");return}j(!0),g(null);try{const s=sessionStorage.getItem("employee_session");if(!s){p.error("Session expired. Please log in again."),l("../access");return}const h=K(),P=R(h),v=await fetch(`${P}/public/gifts/${n}`,{headers:{Authorization:`Bearer ${h.supabaseAnonKey}`,"X-Environment-ID":h.id,"X-Session-Token":s}}),u=await v.json();if(!v.ok)throw new Error(u.error||"Failed to load gift");u.gift?C(u.gift):(g("Gift not found"),p.error("Gift not found"),setTimeout(()=>l("../gift-selection"),2e3))}catch(s){X.error("Failed to load gift:",s),g(s instanceof Error?s.message:"Failed to load gift details"),p.error(s instanceof Error?s.message:"Failed to load gift"),setTimeout(()=>l("../gift-selection"),2e3)}finally{j(!1)}})()},[n,l]),d.useEffect(()=>{(r==null?void 0:r.id)===n?m(b):m(1)},[r,n,b]),!a)return null;const N=i=>{const s=c+i;s>=1&&s<=x&&m(s)},A=()=>{S(a),k(c),l("../shipping-information")},w=(r==null?void 0:r.id)===n;return E?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:t("common.loading")})]})}):y?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg font-bold mb-4",children:y}),e.jsx("p",{className:"text-gray-600",children:t("common.redirecting")})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(q,{}),e.jsx("div",{className:"py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("button",{onClick:()=>l("../gift-selection"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors mb-6","aria-label":t("common.back"),children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:t("common.back")})]}),e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-lg",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"relative h-96 md:h-full bg-gray-100",children:[e.jsx("img",{src:a.image||"https://images.unsplash.com/photo-1513104890138-7c749659a591?w=800&q=80",alt:a.name,className:"w-full h-full object-cover"}),w&&e.jsxs("div",{className:"absolute top-6 right-6 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-4 py-2 rounded-full font-semibold flex items-center gap-2 shadow-lg",children:[e.jsx(D,{className:"w-5 h-5"}),t("giftDetail.currentlySelected")]})]}),e.jsxs("div",{className:"p-8 md:p-12 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"inline-block bg-pink-100 text-[#D91C81] px-4 py-2 rounded-full text-sm font-semibold",children:a.category})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:a.name}),e.jsx("p",{className:"text-lg text-gray-600 leading-relaxed mb-8",children:a.description}),T&&e.jsxs("div",{className:"mb-8 border-t border-gray-200 pt-8",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:t("giftDetail.selectQuantity")}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:()=>N(-1),disabled:c<=1,className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center hover:bg-gray-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx(z,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"text-center min-w-[80px]",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900",children:c}),e.jsx("div",{className:"text-sm text-gray-500",children:t(c===1?"giftDetail.item":"giftDetail.items")})]}),e.jsx("button",{onClick:()=>N(1),disabled:c>=x,className:"w-12 h-12 bg-gradient-to-r from-[#D91C81] to-[#B71569] rounded-xl flex items-center justify-center hover:shadow-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx(H,{className:"w-5 h-5 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:[t("giftDetail.maximumPerOrder")," ",x," ",t(x===1?"giftDetail.item":"giftDetail.items")," ",t("giftDetail.perOrder")]})]})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsxs("button",{onClick:A,className:"w-full flex items-center justify-center gap-3 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-8 py-4 rounded-xl font-bold text-lg transition-all",style:{boxShadow:"0 4px 12px rgba(217, 28, 129, 0.3)"},onMouseEnter:i=>i.currentTarget.style.boxShadow="0 6px 16px rgba(217, 28, 129, 0.4)",onMouseLeave:i=>i.currentTarget.style.boxShadow="0 4px 12px rgba(217, 28, 129, 0.3)",children:[t(w?"giftDetail.updateSelection":"giftDetail.selectThisGift"),e.jsx($,{className:"w-6 h-6"})]}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:t("giftDetail.reviewNotice")})]})]})]})}),e.jsxs("div",{className:"mt-8 grid md:grid-cols-2 gap-8",children:[a.features&&a.features.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:t("giftDetail.features")}),e.jsx("ul",{className:"space-y-3",children:a.features.map((i,s)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-[#D91C81] flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:i})]},s))})]}),a.specifications&&Object.keys(a.specifications).length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:t("giftDetail.specifications")}),e.jsx("dl",{className:"space-y-3",children:Object.entries(a.specifications).map(([i,s])=>e.jsxs("div",{className:"flex justify-between gap-4 py-2 border-b border-gray-100 last:border-0",children:[e.jsx("dt",{className:"font-semibold text-gray-700",children:i}),e.jsx("dd",{className:"text-gray-600 text-right",children:String(s)})]},i))})]})]}),e.jsxs("div",{className:"mt-8 bg-white rounded-xl p-8 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:t("giftDetail.description")}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.longDescription})]}),e.jsxs("div",{className:"mt-8 bg-cyan-50 border border-cyan-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-[#1B2A5E] mb-2",children:t("giftDetail.giftInfoTitle")}),e.jsx("p",{className:"text-sm text-gray-700",children:t("giftDetail.giftInfoDesc")})]})]})})]})}export{Y as GiftDetail};
