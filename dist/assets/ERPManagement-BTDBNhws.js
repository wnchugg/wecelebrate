import{m as ee,r as d,j as e,A as G,aj as k,a5 as _,D as W,Y as se,a6 as te,x as ae}from"./index-DHDOl0g2.js";import{s as w,a as T,b as re}from"./errorHandling-cB_D8Kf8.js";import{R as le}from"./rotate-ccw-D42TkvDG.js";import{S as ne}from"./save-Boa8-IjG.js";import{T as Y}from"./trash-2-c4zWA-a_.js";import{P as J}from"./plus-Du5_lMGy.js";import{I as ie}from"./info-Bs8xUcz2.js";import{C as Q}from"./clock-Cgju5BVR.js";import{C as X}from"./calendar-NQ71wNpy.js";import{T as de,a as oe}from"./toggle-right-BmYfm-B2.js";import{P as ce}from"./play-C-DWbc3T.js";import{P as xe}from"./pen-BIu3415J.js";import{C as z}from"./circle-alert-HchCeVzY.js";import{C as q}from"./circle-x-DNt9TFja.js";import{C as me}from"./circle-check-D3s6FA-S.js";import{C as H}from"./circle-check-big-BYmGA9PQ.js";import{T as ue}from"./test-tube--h5qysc2.js";import{S as ge}from"./square-pen-D4GEpeV_.js";import{A as he}from"./activity-CTzfCVVy.js";import{P as pe}from"./package-DB_piFYl.js";import{F as ye}from"./file-text-D58_PMPW.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Z=ee("history",fe);function be({title:t,mappings:i,onMappingsChange:D,sourceFields:r=[],targetFields:u=[],placeholder:f={source:"wecelebrate field",target:"ERP field"}}){const[b,o]=d.useState([]),[a,p]=d.useState(!1);d.useEffect(()=>{const y=Object.entries(i).map(([x,c])=>({source:x,target:c}));o(y.length>0?y:[{source:"",target:""}])},[i]);const E=()=>{o([...b,{source:"",target:""}]),p(!0)},M=y=>{const x=b.filter((c,F)=>F!==y);o(x.length>0?x:[{source:"",target:""}]),p(!0)},j=(y,x,c)=>{const F=[...b];F[y][x]=c,o(F),p(!0)},R=()=>{const y=b.filter(x=>x.source&&x.target).reduce((x,c)=>(x[c.source]=c.target,x),{});D(y),p(!1)},C=()=>{const y=Object.entries(i).map(([x,c])=>({source:x,target:c}));o(y.length>0?y:[{source:"",target:""}]),p(!1)},I=["orderId","orderNumber","customerInfo.name","customerInfo.email","customerInfo.phone","items[].sku","items[].name","items[].quantity","items[].price","totalAmount","shippingAddress.street","shippingAddress.city","shippingAddress.state","shippingAddress.zip","shippingAddress.country","status","createdAt","updatedAt","sku","name","description","price","stockQuantity","category","imageUrl","weight","dimensions","quantity","location","warehouseId","lastUpdated","reservedQuantity","availableQuantity"],S=[...new Set([...r,...I])];return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[#1B2A5E]",children:t}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Map wecelebrate platform fields to your ERP system fields"})]}),e.jsx("div",{className:"flex gap-2",children:a&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(le,{className:"w-4 h-4"}),"Reset"]}),e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 text-white bg-[#D91C81] rounded-lg hover:bg-[#B91870] transition-colors",children:[e.jsx(ne,{className:"w-4 h-4"}),"Save Mappings"]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_40px_1fr_40px] gap-3 pb-2 border-b border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"wecelebrate Field"}),e.jsx("div",{}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"ERP Field"}),e.jsx("div",{})]}),b.map((y,x)=>e.jsxs("div",{className:"grid grid-cols-[1fr_40px_1fr_40px] gap-3 items-center group",children:[e.jsx("div",{className:"relative",children:S.length>0?e.jsxs("select",{value:y.source,onChange:c=>j(x,"source",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm",children:[e.jsxs("option",{value:"",children:["Select ",f.source]}),S.map(c=>e.jsx("option",{value:c,children:c},c))]}):e.jsx("input",{type:"text",value:y.source,onChange:c=>j(x,"source",c.target.value),placeholder:f.source,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm"})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-gray-400"})}),e.jsx("div",{className:"relative",children:u.length>0?e.jsxs("select",{value:y.target,onChange:c=>j(x,"target",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm",children:[e.jsxs("option",{value:"",children:["Select ",f.target]}),u.map(c=>e.jsx("option",{value:c,children:c},c))]}):e.jsx("input",{type:"text",value:y.target,onChange:c=>j(x,"target",c.target.value),placeholder:f.target,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm"})}),e.jsx("button",{onClick:()=>M(x),className:"flex items-center justify-center w-8 h-8 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors opacity-0 group-hover:opacity-100",disabled:b.length===1,children:e.jsx(Y,{className:"w-4 h-4"})})]},x))]}),e.jsxs("button",{onClick:E,className:"mt-4 flex items-center gap-2 px-4 py-2 text-[#D91C81] border border-[#D91C81] rounded-lg hover:bg-pink-50 transition-colors w-full justify-center",children:[e.jsx(J,{className:"w-4 h-4"}),"Add Field Mapping"]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"Tip:"})," Use dot notation for nested fields (e.g., ",e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"customerInfo.email"}),") and array notation for list items (e.g., ",e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"items[].sku"}),")."]})})]})}function je({value:t,onChange:i,timezone:D="UTC",onTimezoneChange:r}){const[u,f]=d.useState("preset"),[b,o]=d.useState(""),[a,p]=d.useState("0"),[E,M]=d.useState("0"),[j,R]=d.useState("*"),[C,I]=d.useState("*"),[S,y]=d.useState("*"),x=[{label:"Every 15 minutes",value:"*/15 * * * *",description:"Runs every 15 minutes"},{label:"Every 30 minutes",value:"*/30 * * * *",description:"Runs every 30 minutes"},{label:"Every hour",value:"0 * * * *",description:"Runs at the start of every hour"},{label:"Every 6 hours",value:"0 */6 * * *",description:"Runs every 6 hours at minute 0"},{label:"Every 12 hours",value:"0 */12 * * *",description:"Runs twice daily at midnight and noon"},{label:"Daily at midnight",value:"0 0 * * *",description:"Runs once per day at 12:00 AM"},{label:"Daily at 2 AM",value:"0 2 * * *",description:"Runs once per day at 2:00 AM"},{label:"Daily at noon",value:"0 12 * * *",description:"Runs once per day at 12:00 PM"},{label:"Twice daily (2 AM & 2 PM)",value:"0 2,14 * * *",description:"Runs at 2:00 AM and 2:00 PM"},{label:"Weekly on Sunday",value:"0 0 * * 0",description:"Runs every Sunday at midnight"},{label:"Weekly on Monday",value:"0 0 * * 1",description:"Runs every Monday at midnight"},{label:"Monthly on 1st",value:"0 0 1 * *",description:"Runs on the 1st of each month at midnight"}];d.useEffect(()=>{if(t){const n=t.split(" ");if(n.length===5){p(n[0]),M(n[1]),R(n[2]),I(n[3]),y(n[4]);const v=x.find(N=>N.value===t);v?(f("preset"),o(v.description)):(f("custom"),c(t))}}},[t]);const c=n=>{const v=n.split(" ");if(v.length!==5){o("Invalid expression");return}const[N,l,m,L,O]=v;let A="At ";if(N==="*"?A+="every minute":N.startsWith("*/")?A+=`every ${N.substring(2)} minutes`:A+=`minute ${N}`,A+=" of ",l==="*"?A+="every hour":l.startsWith("*/")?A+=`every ${l.substring(2)} hours`:l.includes(",")?A+=`hours ${l}`:A+=`hour ${l}`,m!=="*"&&(A+=` on day ${m} of the month`),L!=="*"){const B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],U=parseInt(L);U>=1&&U<=12&&(A+=` in ${B[U-1]}`)}if(O!=="*"){const B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],U=parseInt(O);U>=0&&U<=6&&(A+=` on ${B[U]}`)}o(A)},F=n=>{i(n);const v=x.find(N=>N.value===n);v&&o(v.description)},$=()=>{const n=`${a} ${E} ${j} ${C} ${S}`;i(n),c(n)};d.useEffect(()=>{u==="custom"&&$()},[a,E,j,C,S,u]);const P=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Phoenix","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f("preset"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${u==="preset"?"bg-[#D91C81] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Common Presets"}),e.jsx("button",{onClick:()=>f("custom"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${u==="custom"?"bg-[#D91C81] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Custom Expression"})]}),u==="preset"&&e.jsx("div",{className:"space-y-3",children:x.map(n=>e.jsxs("label",{className:`flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${t===n.value?"border-[#D91C81] bg-pink-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("input",{type:"radio",name:"preset",value:n.value,checked:t===n.value,onChange:v=>F(v.target.value),className:"mt-1 text-[#D91C81] focus:ring-[#D91C81]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-[#1B2A5E]",children:n.label}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:n.description}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 font-mono bg-gray-100 px-2 py-1 rounded inline-block",children:n.value})]})]},n.value))}),u==="custom"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Minute",e.jsx("span",{className:"block text-xs text-gray-500 font-normal mt-1",children:"0-59"})]}),e.jsx("input",{type:"text",value:a,onChange:n=>p(n.target.value),placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Hour",e.jsx("span",{className:"block text-xs text-gray-500 font-normal mt-1",children:"0-23"})]}),e.jsx("input",{type:"text",value:E,onChange:n=>M(n.target.value),placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Day",e.jsx("span",{className:"block text-xs text-gray-500 font-normal mt-1",children:"1-31"})]}),e.jsx("input",{type:"text",value:j,onChange:n=>R(n.target.value),placeholder:"*",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Month",e.jsx("span",{className:"block text-xs text-gray-500 font-normal mt-1",children:"1-12"})]}),e.jsx("input",{type:"text",value:C,onChange:n=>I(n.target.value),placeholder:"*",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Day of Week",e.jsx("span",{className:"block text-xs text-gray-500 font-normal mt-1",children:"0-6"})]}),e.jsx("input",{type:"text",value:S,onChange:n=>y(n.target.value),placeholder:"*",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent text-sm font-mono"})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-medium mb-2",children:"Supported patterns:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"*"})," - Any value"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"*/n"})," - Every n units (e.g., */15 for every 15 minutes)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"n"})," - Specific value (e.g., 5 for 5th minute)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-1 py-0.5 rounded",children:"n,m"})," - Multiple values (e.g., 1,15 for 1st and 15th)"]})]})]})]})})]}),r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsx("select",{value:D,onChange:n=>r(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:P.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{className:"w-5 h-5 text-[#D91C81] mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cron Expression:"}),e.jsx("div",{className:"font-mono text-sm bg-gray-100 px-3 py-2 rounded border border-gray-200 mb-3",children:t||"0 0 * * *"}),b&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Schedule:"}),e.jsx("div",{className:"text-sm text-gray-900 bg-green-50 px-3 py-2 rounded border border-green-200",children:b})]})]})]})})]})}function ve({erpConnectionId:t,erpConnectionName:i,onClose:D}){const[r,u]=d.useState([]),[f,b]=d.useState(!0),[o,a]=d.useState(!1),[p,E]=d.useState(!1),[M,j]=d.useState(null),[R,C]=d.useState(!1),[I,S]=d.useState([]),[y,x]=d.useState(!1);d.useEffect(()=>{c()},[t]);const c=async()=>{try{b(!0);const l=await k.getSchedulesByConnection(t);u(l.schedules||[])}catch(l){w(l,{operation:"loadSchedules"})}finally{b(!1)}},F=async l=>{try{x(!0);const m=await k.getScheduleExecutionLogs(l,20);S(m.logs||[])}catch(m){w(m,{operation:"loadExecutionLogs"})}finally{x(!1)}},$=async l=>{try{await k.updateSchedule(l.id,{enabled:!l.enabled}),T("Schedule Updated",`Schedule ${l.enabled?"disabled":"enabled"} successfully`),c()}catch(m){w(m,{operation:"toggleSchedule"})}},P=async l=>{try{await k.deleteSchedule(l),T("Schedule Deleted","Schedule removed successfully"),c()}catch(m){w(m,{operation:"deleteSchedule"})}},n=async l=>{try{re("Executing Schedule","Manual execution started..."),await k.executeScheduleNow(l.id),T("Execution Started","Schedule is running. Check logs for results."),c()}catch(m){w(m,{operation:"executeSchedule"})}},v=l=>{j(l),C(!0),F(l.id)},N=l=>l?new Date(l).toLocaleString():"Never";return f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#D91C81]"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-[#1B2A5E]",children:"Schedule Manager"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Managing schedules for ",e.jsx("span",{className:"font-semibold",children:i})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91870] transition-colors",children:"Create Schedule"}),e.jsx("button",{onClick:D,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})]}),r.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(X,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No Schedules Yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first automated sync schedule"}),e.jsx("button",{onClick:()=>a(!0),className:"px-6 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91870] transition-colors",children:"Create Schedule"})]}):e.jsx("div",{className:"grid gap-4",children:r.map(l=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#1B2A5E]",children:l.name}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${l.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.enabled?"Active":"Disabled"}),e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:l.syncType==="both"?"Products & Inventory":l.syncType.charAt(0).toUpperCase()+l.syncType.slice(1)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Schedule:"})," ",l.schedule.type==="cron"?l.schedule.cronExpression:`Every ${l.schedule.intervalMinutes} minutes`]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Timezone:"})," ",l.schedule.timezone||"UTC"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Last Run:"})," ",N(l.lastRun)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Next Run:"})," ",N(l.nextRun)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total Runs:"})," ",l.runCount]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Notifications:"})," ",l.notifications.onFailure?"On Failure":"None"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:()=>$(l),className:"p-2 text-gray-600 hover:text-[#D91C81] hover:bg-pink-50 rounded-lg transition-colors",title:l.enabled?"Disable":"Enable",children:l.enabled?e.jsx(de,{className:"w-5 h-5"}):e.jsx(oe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>n(l),className:"p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Execute Now",children:e.jsx(ce,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>v(l),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View Execution Logs",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{j(l),E(!0)},className:"p-2 text-gray-600 hover:text-[#D91C81] hover:bg-pink-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>P(l.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Y,{className:"w-5 h-5"})})]})]})},l.id))}),(o||p)&&e.jsx(Ne,{erpConnectionId:t,schedule:p?M:null,onClose:()=>{a(!1),E(!1),j(null)},onSuccess:()=>{c(),a(!1),E(!1),j(null)}}),R&&M&&e.jsx(we,{schedule:M,logs:I,loading:y,onClose:()=>{C(!1),j(null)}})]})}function Ne({erpConnectionId:t,schedule:i,onClose:D,onSuccess:r}){var N,l;const[u,f]=d.useState((i==null?void 0:i.name)||""),[b,o]=d.useState((i==null?void 0:i.syncType)||"products"),[a,p]=d.useState((i==null?void 0:i.schedule.type)||"cron"),[E,M]=d.useState((i==null?void 0:i.schedule.cronExpression)||"0 2 * * *"),[j,R]=d.useState((i==null?void 0:i.schedule.timezone)||"UTC"),[C,I]=d.useState(((N=i==null?void 0:i.schedule.intervalMinutes)==null?void 0:N.toString())||"360"),[S,y]=d.useState((i==null?void 0:i.enabled)??!0),[x,c]=d.useState((i==null?void 0:i.notifications.onFailure)??!0),[F,$]=d.useState(((l=i==null?void 0:i.notifications.emailRecipients)==null?void 0:l.join(", "))||""),[P,n]=d.useState(!1),v=async m=>{if(m.preventDefault(),!u.trim()){w(new Error("Please enter a schedule name"),{operation:"validateSchedule"});return}try{n(!0);const L={erpConnectionId:t,name:u.trim(),enabled:S,syncType:b,schedule:{type:a,...a==="cron"?{cronExpression:E,timezone:j}:{intervalMinutes:parseInt(C)}},notifications:{onSuccess:!1,onFailure:x,emailRecipients:F.split(",").map(O=>O.trim()).filter(Boolean)}};i?(await k.updateSchedule(i.id,L),T("Schedule Updated","Schedule updated successfully")):(await k.createSchedule(L),T("Schedule Created","Schedule created successfully")),r()}catch(L){w(L,{operation:"saveSchedule"})}finally{n(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-[#1B2A5E]",children:i?"Edit Schedule":"Create Schedule"}),e.jsx("button",{onClick:D,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),e.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Name *"}),e.jsx("input",{type:"text",value:u,onChange:m=>f(m.target.value),placeholder:"e.g., Daily Product Sync",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sync Type *"}),e.jsxs("select",{value:b,onChange:m=>o(m.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"products",children:"Products Only"}),e.jsx("option",{value:"inventory",children:"Inventory Only"}),e.jsx("option",{value:"both",children:"Products & Inventory"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Type *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"cron",checked:a==="cron",onChange:m=>p(m.target.value),className:"mr-2 text-[#D91C81] focus:ring-[#D91C81]"}),"Cron Expression"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"interval",checked:a==="interval",onChange:m=>p(m.target.value),className:"mr-2 text-[#D91C81] focus:ring-[#D91C81]"}),"Simple Interval"]})]})]}),a==="cron"?e.jsx(je,{value:E,onChange:M,timezone:j,onTimezoneChange:R}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interval (minutes) *"}),e.jsx("input",{type:"number",value:C,onChange:m=>I(m.target.value),min:"1",placeholder:"360",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Schedule will run every ",C," minutes (",Math.round(parseInt(C)/60*10)/10," hours)"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Enable Schedule"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Schedule will run automatically when enabled"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:m=>y(m.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#D91C81]"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"notifyFailure",checked:x,onChange:m=>c(m.target.checked),className:"mr-2 text-[#D91C81] focus:ring-[#D91C81]"}),e.jsx("label",{htmlFor:"notifyFailure",className:"text-sm font-medium text-gray-700",children:"Send notification on failure"})]}),x&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Recipients (comma-separated)"}),e.jsx("input",{type:"text",value:F,onChange:m=>$(m.target.value),placeholder:"admin@example.com, ops@example.com",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:P,className:"flex-1 px-6 py-3 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91870] transition-colors disabled:opacity-50",children:P?"Saving...":i?"Update Schedule":"Create Schedule"}),e.jsx("button",{type:"button",onClick:D,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})})}function we({schedule:t,logs:i,loading:D,onClose:r}){const u=o=>new Date(o).toLocaleString(),f=o=>{switch(o){case"success":return"text-green-600 bg-green-50";case"failed":return"text-red-600 bg-red-50";case"partial":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}},b=o=>{switch(o){case"success":return e.jsx(me,{className:"w-5 h-5"});case"failed":return e.jsx(q,{className:"w-5 h-5"});case"partial":return e.jsx(z,{className:"w-5 h-5"});default:return e.jsx(Q,{className:"w-5 h-5"})}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#1B2A5E]",children:"Execution History"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.name})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#D91C81]"})}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No execution history yet"})]}):e.jsx("div",{className:"space-y-4",children:i.map(o=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${f(o.status)}`,children:[b(o.status),e.jsx("span",{className:"font-medium capitalize",children:o.status})]}),e.jsx("div",{className:"text-sm text-gray-600",children:u(o.startedAt)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Sync Type:"}),e.jsx("span",{className:"ml-2 font-medium capitalize",children:o.syncType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Records Processed:"}),e.jsx("span",{className:"ml-2 font-medium text-green-600",children:o.recordsProcessed})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Records Failed:"}),e.jsx("span",{className:"ml-2 font-medium text-red-600",children:o.recordsFailed})]})]}),o.error&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-red-900 mb-1",children:"Error:"}),e.jsx("div",{className:"text-sm text-red-700",children:o.error})]}),o.details&&e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"text-sm text-gray-600 cursor-pointer hover:text-gray-900",children:"View Details"}),e.jsx("pre",{className:"mt-2 p-3 bg-gray-50 rounded text-xs overflow-x-auto",children:JSON.stringify(o.details,null,2)})]})]},o.id))})}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4",children:e.jsx("button",{onClick:r,className:"w-full px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})}const K=[{value:"sap",label:"SAP",icon:"ðŸ¢"},{value:"oracle",label:"Oracle",icon:"ðŸ”¶"},{value:"netsuite",label:"NetSuite",icon:"â˜ï¸"},{value:"shopify",label:"Shopify",icon:"ðŸ›ï¸"},{value:"magento",label:"Magento",icon:"ðŸ›’"},{value:"woocommerce",label:"WooCommerce",icon:"ðŸ”·"},{value:"custom_api",label:"Custom API",icon:"âš™ï¸"}],Ce=[{value:"api_key",label:"API Key"},{value:"bearer",label:"Bearer Token"},{value:"basic",label:"Basic Auth"},{value:"oauth",label:"OAuth 2.0"}];function Je(){var V;const[t,i]=d.useState([]),[D,r]=d.useState(!0),[u,f]=d.useState(!1),[b,o]=d.useState(!1),[a,p]=d.useState(null),[E,M]=d.useState(null),[j,R]=d.useState(null),[C,I]=d.useState(null),[S,y]=d.useState({}),[x,c]=d.useState(!1),[F,$]=d.useState(!1),[P,n]=d.useState("orderFields");d.useEffect(()=>{v()},[]);const v=async()=>{try{r(!0);const s=await k.getERPConnections();i(s.connections||[])}catch(s){w("Failed to load ERP connections",s instanceof Error?s.message:"Unknown error")}finally{r(!1)}},N=async s=>{try{const g=await k.getERPSyncLogs(s);y(h=>({...h,[s]:g.logs||[]}))}catch(g){w("Failed to load sync logs",g instanceof Error?g.message:"Unknown error")}},l=async s=>{try{M(s.id);const g=await k.testERPConnection(s.id);g.success?T("Connection Successful",`${g.message} (${g.responseTime}ms)`):w("Connection Failed",g.message)}catch(g){w("Connection Test Failed",g instanceof Error?g.message:"Unknown error")}finally{M(null)}},m=async s=>{var g;try{R(s);const h=await k.syncProductsFromERP(s);h.success?(T("Products Synced",`Successfully synced ${((g=h.products)==null?void 0:g.length)||0} products`),N(s)):w("Product Sync Failed",h.error||"Unknown error")}catch(h){w("Product Sync Failed",h instanceof Error?h.message:"Unknown error")}finally{R(null)}},L=async s=>{var g;try{R(s);const h=await k.syncInventoryFromERP(s);h.success?(T("Inventory Synced",`Successfully synced ${((g=h.inventory)==null?void 0:g.length)||0} items`),N(s)):w("Inventory Sync Failed",h.error||"Unknown error")}catch(h){w("Inventory Sync Failed",h instanceof Error?h.message:"Unknown error")}finally{R(null)}},O=async s=>{if(confirm("Are you sure you want to delete this ERP connection?"))try{await k.deleteERPConnection(s),T("ERP Connection Deleted","Connection removed successfully"),v()}catch(g){w("Failed to delete connection",g instanceof Error?g.message:"Unknown error")}},A=async s=>{C===s?I(null):(I(s),S[s]||await N(s))},B=s=>{switch(s){case"active":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:[e.jsx(H,{className:"w-3 h-3"}),"Active"]});case"inactive":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 text-xs font-medium rounded-full",children:[e.jsx(q,{className:"w-3 h-3"}),"Inactive"]});case"error":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full",children:[e.jsx(z,{className:"w-3 h-3"}),"Error"]});default:return null}},U=s=>{var g;return((g=K.find(h=>h.value===s))==null?void 0:g.icon)||"âš™ï¸"};return D?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(_,{className:"w-8 h-8 animate-spin text-[#D91C81]"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ERP Integrations"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage connections to ERP systems for order fulfillment and inventory sync"})]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),"Add ERP Connection"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Connections"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t.length})]}),e.jsx(W,{className:"w-8 h-8 text-[#D91C81]"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:t.filter(s=>s.status==="active").length})]}),e.jsx(H,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600 mt-1",children:t.filter(s=>s.status==="inactive").length})]}),e.jsx(q,{className:"w-8 h-8 text-gray-600"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Errors"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:t.filter(s=>s.status==="error").length})]}),e.jsx(z,{className:"w-8 h-8 text-red-600"})]})})]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No ERP Connections"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by adding your first ERP integration"}),e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),"Add ERP Connection"]})]}):t.map(s=>{var g;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"text-4xl",children:U(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),B(s.status),e.jsx("span",{className:"text-xs text-gray-500 px-2 py-1 bg-gray-100 rounded",children:(g=K.find(h=>h.value===s.type))==null?void 0:g.label})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.config.apiUrl}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3"}),"Last sync: ",s.syncSettings.lastSync?new Date(s.syncSettings.lastSync).toLocaleString():"Never"]}),s.assignedSites&&s.assignedSites.length>0&&e.jsxs("span",{children:[s.assignedSites.length," site(s) assigned"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>l(s),disabled:E===s.id,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",title:"Test Connection",children:E===s.id?e.jsx(_,{className:"w-4 h-4 animate-spin"}):e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{p(s),o(!0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit Connection",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Connection",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(s.id),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Toggle Details",children:C===s.id?e.jsx(se,{className:"w-4 h-4"}):e.jsx(te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[s.syncSettings.autoSyncOrders&&e.jsx("span",{className:"text-xs text-gray-600 bg-blue-50 px-2 py-1 rounded",children:"Auto-sync Orders"}),s.syncSettings.autoSyncProducts&&e.jsx("span",{className:"text-xs text-gray-600 bg-green-50 px-2 py-1 rounded",children:"Auto-sync Products"}),s.syncSettings.autoSyncInventory&&e.jsx("span",{className:"text-xs text-gray-600 bg-purple-50 px-2 py-1 rounded",children:"Auto-sync Inventory"}),s.syncSettings.syncInterval&&e.jsxs("span",{className:"text-xs text-gray-600",children:["Interval: ",s.syncSettings.syncInterval," min"]})]})]}),C===s.id&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Manual Sync Actions"]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("button",{onClick:()=>m(s.id),disabled:j===s.id,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[j===s.id?e.jsx(_,{className:"w-4 h-4 animate-spin"}):e.jsx(pe,{className:"w-4 h-4"}),"Sync Products"]}),e.jsxs("button",{onClick:()=>L(s.id),disabled:j===s.id,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[j===s.id?e.jsx(_,{className:"w-4 h-4 animate-spin"}):e.jsx(W,{className:"w-4 h-4"}),"Sync Inventory"]}),e.jsxs("button",{onClick:()=>{p(s),c(!0)},className:"flex items-center gap-2 px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91870] transition-colors",children:[e.jsx(X,{className:"w-4 h-4"}),"Manage Schedules"]}),e.jsxs("button",{onClick:()=>{p(s),n("orderFields"),$(!0)},className:"flex items-center gap-2 px-4 py-2 bg-[#00B4CC] text-white rounded-lg hover:bg-[#0099B3] transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Configure Field Mapping"]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Recent Sync Logs"]}),S[s.id]&&S[s.id].length>0?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 divide-y divide-gray-200",children:S[s.id].slice(0,5).map(h=>e.jsx("div",{className:"p-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[h.status==="success"?e.jsx(H,{className:"w-5 h-5 text-green-600"}):h.status==="failed"?e.jsx(q,{className:"w-5 h-5 text-red-600"}):e.jsx(z,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 capitalize",children:[h.type," Sync"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${h.status==="success"?"bg-green-100 text-green-800":h.status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:h.status})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[h.recordsProcessed," processed, ",h.recordsFailed," failed"," â€¢ ",new Date(h.completedAt).toLocaleString()]})]})]})},h.id))}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 text-center text-sm text-gray-600",children:"No sync logs available"})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Configuration"]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("dl",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium text-gray-700",children:"Auth Type"}),e.jsx("dd",{className:"text-gray-600 mt-1 capitalize",children:s.config.authType.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium text-gray-700",children:"API URL"}),e.jsx("dd",{className:"text-gray-600 mt-1 break-all",children:s.config.apiUrl})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium text-gray-700",children:"Created"}),e.jsx("dd",{className:"text-gray-600 mt-1",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-medium text-gray-700",children:"Last Updated"}),e.jsx("dd",{className:"text-gray-600 mt-1",children:new Date(s.updatedAt).toLocaleDateString()})]})]})})]})]})})]},s.id)})}),(u||b)&&e.jsx(Se,{connection:b?a:null,onClose:()=>{f(!1),o(!1),p(null)},onSave:()=>{f(!1),o(!1),p(null),v()}}),x&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:e.jsx(ve,{erpConnectionId:a.id,erpConnectionName:a.name,onClose:()=>{c(!1),p(null)}})})}),F&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#1B2A5E]",children:"Field Mapping Configuration"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[a.name," - ",(V=K.find(s=>s.value===a.type))==null?void 0:V.label]})]}),e.jsx("button",{onClick:()=>{$(!1),p(null)},className:"text-gray-400 hover:text-gray-600 transition-colors text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>n("orderFields"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${P==="orderFields"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Order Fields"}),e.jsx("button",{onClick:()=>n("productFields"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${P==="productFields"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Product Fields"}),e.jsx("button",{onClick:()=>n("inventoryFields"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${P==="inventoryFields"?"border-[#D91C81] text-[#D91C81]":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Inventory Fields"})]}),e.jsx(be,{title:P==="orderFields"?"Order Field Mapping":P==="productFields"?"Product Field Mapping":"Inventory Field Mapping",mappings:a.mapping[P],onMappingsChange:async s=>{try{await k.updateERPConnection(a.id,{mapping:{...a.mapping,[P]:s}}),T("Field Mapping Updated","Mappings saved successfully"),v()}catch(g){w("Failed to save mappings",g instanceof Error?g.message:"Unknown error")}},placeholder:{source:"JALA field name",target:"ERP field name"}})]})]})})]})}function Se({connection:t,onClose:i,onSave:D}){const[r,u]=d.useState({name:(t==null?void 0:t.name)||"",type:(t==null?void 0:t.type)||"custom_api",status:(t==null?void 0:t.status)||"active",apiUrl:(t==null?void 0:t.config.apiUrl)||"",authType:(t==null?void 0:t.config.authType)||"api_key",apiKey:(t==null?void 0:t.config.apiKey)||"",username:(t==null?void 0:t.config.username)||"",autoSyncOrders:(t==null?void 0:t.syncSettings.autoSyncOrders)||!1,autoSyncProducts:(t==null?void 0:t.syncSettings.autoSyncProducts)||!1,autoSyncInventory:(t==null?void 0:t.syncSettings.autoSyncInventory)||!1,syncInterval:(t==null?void 0:t.syncSettings.syncInterval)||60}),[f,b]=d.useState(!1),o=async a=>{a.preventDefault();try{b(!0);const p={name:r.name,type:r.type,status:r.status,config:{apiUrl:r.apiUrl,authType:r.authType,apiKey:r.apiKey,username:r.username},syncSettings:{autoSyncOrders:r.autoSyncOrders,autoSyncProducts:r.autoSyncProducts,autoSyncInventory:r.autoSyncInventory,syncInterval:r.syncInterval},mapping:(t==null?void 0:t.mapping)||{orderFields:{},productFields:{},inventoryFields:{}}};t?(await k.updateERPConnection(t.id,p),T("Connection Updated","ERP connection updated successfully")):(await k.createERPConnection(p),T("Connection Created","ERP connection created successfully")),D()}catch(p){w("Failed to save connection",p instanceof Error?p.message:"Unknown error")}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t?"Edit ERP Connection":"Add ERP Connection"})}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Connection Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:a=>u({...r,name:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",placeholder:"My ERP System"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ERP Type *"}),e.jsx("select",{value:r.type,onChange:a=>u({...r,type:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:K.map(a=>e.jsxs("option",{value:a.value,children:[a.icon," ",a.label]},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsxs("select",{value:r.status,onChange:a=>u({...r,status:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"error",children:"Error"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"API Configuration"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API URL *"}),e.jsx("input",{type:"url",value:r.apiUrl,onChange:a=>u({...r,apiUrl:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",placeholder:"https://api.example.com/v1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Authentication Type *"}),e.jsx("select",{value:r.authType,onChange:a=>u({...r,authType:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",children:Ce.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),(r.authType==="api_key"||r.authType==="bearer")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key / Token *"}),e.jsx("input",{type:"password",value:r.apiKey,onChange:a=>u({...r,apiKey:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent",placeholder:"Enter your API key"})]}),r.authType==="basic"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username *"}),e.jsx("input",{type:"text",value:r.username,onChange:a=>u({...r,username:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e.jsx("input",{type:"password",value:r.apiKey,onChange:a=>u({...r,apiKey:a.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Sync Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.autoSyncOrders,onChange:a=>u({...r,autoSyncOrders:a.target.checked}),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Auto-sync Orders"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.autoSyncProducts,onChange:a=>u({...r,autoSyncProducts:a.target.checked}),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Auto-sync Products"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.autoSyncInventory,onChange:a=>u({...r,autoSyncInventory:a.target.checked}),className:"w-4 h-4 text-[#D91C81] border-gray-300 rounded focus:ring-[#D91C81]"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Auto-sync Inventory"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sync Interval (minutes)"}),e.jsx("input",{type:"number",value:r.syncInterval,onChange:a=>u({...r,syncInterval:parseInt(a.target.value)}),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#D91C81] focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-[#D91C81] text-white rounded-lg hover:bg-[#B91670] transition-colors disabled:opacity-50",children:f?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsx(e.Fragment,{children:"Save Connection"})})]})]})]})})}export{Je as ERPManagement,Je as default};
