import{u as N,a as w,I as C,d as S,r as x,c as k,j as e,t as l,g as E,k as I,l as O}from"./index-DAep3-17.js";import{P as T}from"./package-BYXKoKMr.js";import{S as g}from"./square-pen-Bj3YdsC1.js";import{M as A}from"./map-pin-BnvXFQRp.js";import{C as B}from"./circle-check-big-Dewj6UrC.js";const D={shippingMethod:"individual"};function U(){const a=N(),{siteId:P}=w(),{selectedGift:i,quantity:h,shippingAddress:t}=C(),{userIdentifier:u}=S(),[n,c]=x.useState(!1),[p,d]=x.useState(null),{t:s}=k();x.useEffect(()=>{(!i||!t)&&a("../gift-selection")},[i,t,a]);const j=async()=>{if(!i||!t){d(s("notification.error.missingInformation")),l.error(s("notification.error.missingInformation"));return}c(!0),d(null);try{const r=sessionStorage.getItem("employee_session");if(!r){l.error(s("notification.error.sessionExpired")),a("../access");return}const o=E(),y=I(o),v={siteId:o.id,userId:u,giftId:i.id,quantity:h,shippingAddress:{fullName:t.fullName,addressLine1:t.street,addressLine2:"",city:t.city,state:t.state,postalCode:t.zipCode,country:t.country||"United States",phone:t.phone||""}},f=await fetch(`${y}/public/orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.supabaseAnonKey}`,"X-Environment-ID":o.id,"X-Session-Token":r},body:JSON.stringify(v)}),m=await f.json();if(!f.ok||!m.success)throw new Error(m.error||"Failed to create order");l.success(s("notification.success.orderPlaced")),c(!1),a(`/confirmation/${m.order.id}`)}catch(r){O.error("Failed to submit order:",r),d(r instanceof Error?r.message:s("notification.error.failedToSubmitOrder")),l.error(r instanceof Error?r.message:s("notification.error.failedToSubmitOrder")),c(!1)}};if(!i||!t)return null;const b=D.shippingMethod==="company";return e.jsx("div",{className:"min-h-[calc(100vh-4rem)] py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-block bg-pink-100 text-[#D91C81] px-4 py-2 rounded-full mb-4",children:e.jsx("p",{className:"text-sm font-medium",children:s("review.step")})}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4",children:s("review.title")}),e.jsx("p",{className:"text-lg text-gray-600",children:s("review.reviewBeforeConfirm")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(T,{className:"w-7 h-7 text-[#D91C81]"}),s("review.selectedGift")]}),e.jsxs("button",{onClick:()=>a("../gift-selection"),className:"flex items-center gap-2 text-[#D91C81] hover:text-[#B71569] font-medium text-sm",children:[e.jsx(g,{className:"w-4 h-4"}),s("review.change")]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-40 h-40 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:e.jsx("img",{src:i.image,alt:i.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-block bg-pink-100 text-[#D91C81] px-3 py-1 rounded-full text-sm font-medium",children:i.category})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:i.name}),e.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[s("review.quantity")," ",h]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(A,{className:"w-7 h-7 text-[#00B4CC]"}),s("review.shippingInformation")]}),e.jsxs("button",{onClick:()=>a("../shipping-information"),className:"flex items-center gap-2 text-[#D91C81] hover:text-[#B71569] font-medium text-sm",children:[e.jsx(g,{className:"w-4 h-4"}),s("review.change")]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[b,e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s("review.recipient")}),e.jsx("p",{className:"text-gray-900 font-semibold",children:t.fullName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s("review.deliveryAddress")}),e.jsx("p",{className:"text-gray-900",children:t.street}),e.jsxs("p",{className:"text-gray-900",children:[t.city,", ",t.state," ",t.zipCode]}),e.jsx("p",{className:"text-gray-900",children:t.country})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s("review.phoneLabel")}),e.jsx("p",{className:"text-gray-900",children:t.phone})]})]})]})]}),e.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-[#1B2A5E] mb-2",children:s("review.orderConfirmationTitle")}),e.jsx("p",{className:"text-sm text-gray-700",children:s("review.orderConfirmationDesc")})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:j,disabled:n,className:"flex items-center gap-3 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-12 py-5 rounded-xl font-bold text-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed",style:{boxShadow:"0 4px 12px rgba(217, 28, 129, 0.3)"},onMouseEnter:r=>!n&&(r.currentTarget.style.boxShadow="0 6px 16px rgba(217, 28, 129, 0.4)"),onMouseLeave:r=>!n&&(r.currentTarget.style.boxShadow="0 4px 12px rgba(217, 28, 129, 0.3)"),children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}),s("review.processingOrder")]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-6 h-6"}),s("review.confirmOrder")]})})}),p&&e.jsx("div",{className:"mt-4 text-red-500 text-sm",children:p})]})]})})}export{U as ReviewOrder};
