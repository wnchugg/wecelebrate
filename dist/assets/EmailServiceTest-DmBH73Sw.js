import{m as T,aq as I,r as i,j as e,C as g,ar as A,t,ap as F}from"./index-CYlZQa06.js";import{C as c,a as n,b as d,c as p,d as o}from"./card-BPM0EqmW.js";import{I as P}from"./input-BGLnrYUB.js";import{L as j}from"./label-BhePNVd4.js";import{B as R}from"./badge-9JH8fCUp.js";import{M as D}from"./mail-Btt_E8CL.js";import{C as f}from"./circle-check-big-CFCg4-e0.js";import{C as y}from"./circle-alert-cB5UyqMQ.js";import{S as v}from"./send-BXyaGZqs.js";import"./index-BXDtpjth.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],N=T("loader",_);function $(){const{globalTemplates:b}=I(),[s,w]=i.useState(null),[r,S]=i.useState(""),[l,C]=i.useState(""),[m,h]=i.useState(!1),[x,u]=i.useState(!1),E=async()=>{u(!0);try{const a=await A();w(a),a.configured?t.success("Email service is configured and ready"):t.error("Email service is not configured. Please set RESEND_API_KEY.")}catch(a){t.error("Failed to check email service status"),console.error(a)}finally{u(!1)}},k=async()=>{if(!r){t.error("Please enter an email address");return}if(!l){t.error("Please select a template");return}h(!0);try{(await F(l,r)).success?t.success(`Test email sent to ${r}!`):t.error("Failed to send test email")}catch(a){t.error(a.message||"Failed to send test email"),console.error(a)}finally{h(!1)}};return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Email Service Testing"}),e.jsx("p",{className:"text-gray-600",children:"Test email functionality and verify Resend API configuration"})]}),e.jsxs(c,{children:[e.jsxs(n,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Email Service Status"]}),e.jsx(p,{children:"Check if the email service (Resend API) is properly configured"})]}),e.jsxs(o,{className:"space-y-4",children:[s?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.configured?e.jsx(f,{className:"w-5 h-5 text-green-600"}):e.jsx(y,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.configured?"Configured":"Not Configured"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.configured?"Email service is ready to send emails":"RESEND_API_KEY environment variable not set"})]})]}),e.jsx(R,{variant:s.configured?"default":"destructive",className:s.configured?"bg-green-600":"",children:s.configured?"Active":"Inactive"})]}),s.configured&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Provider"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.provider})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Default From"}),e.jsx("p",{className:"font-medium text-gray-900 text-xs",children:s.defaultFrom})]})]})]}):e.jsx("p",{className:"text-gray-600 text-center py-4",children:"Click button below to check status"}),e.jsx(g,{onClick:E,disabled:x,className:"w-full bg-[#D91C81] hover:bg-[#B01566] text-white",children:x?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Check Email Service Status"]})})]})]}),e.jsxs(c,{children:[e.jsxs(n,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Send Test Email"]}),e.jsx(p,{children:"Send a test email using one of the global templates to verify everything works"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"test-email",children:"Recipient Email Address"}),e.jsx(P,{id:"test-email",type:"email",placeholder:"your@email.com",value:r,onChange:a=>S(a.target.value),className:"mt-1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your email address to receive the test email"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"template-select",children:"Select Template"}),e.jsxs("select",{id:"template-select",value:l,onChange:a=>C(a.target.value),className:"mt-1 w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-[#D91C81] focus:ring-2 focus:ring-pink-100 outline-none",children:[e.jsx("option",{value:"",children:"Choose a template..."}),b.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.category,")"]},a.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select which template to test. Sample data will be used for variables."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Note:"})," The test email will use sample/placeholder data for all template variables. This is to verify the email service is working correctly."]})}),e.jsx(g,{onClick:k,disabled:m||!(s!=null&&s.configured)||!r||!l,className:"w-full bg-[#D91C81] hover:bg-[#B01566] text-white",children:m?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Send Test Email"]})}),!(s!=null&&s.configured)&&e.jsx("p",{className:"text-sm text-red-600 text-center",children:"Email service must be configured before sending test emails"})]})]}),s&&!s.configured&&e.jsxs(c,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(n,{children:e.jsxs(d,{className:"text-yellow-900 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),"Setup Required"]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsx("p",{children:e.jsx("strong",{children:"To enable email functionality:"})}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 ml-2",children:[e.jsxs("li",{children:["Sign up for a free Resend account at"," ",e.jsx("a",{href:"https://resend.com",target:"_blank",rel:"noopener noreferrer",className:"text-[#D91C81] hover:underline font-medium",children:"resend.com"})]}),e.jsx("li",{children:"Generate an API key from your Resend dashboard"}),e.jsxs("li",{children:["Add the API key as ",e.jsx("code",{className:"bg-white px-2 py-0.5 rounded border",children:"RESEND_API_KEY"})," in your Supabase environment variables"]}),e.jsx("li",{children:"Restart your edge function (server will automatically pick up the new key)"})]}),e.jsx("p",{className:"pt-2",children:"Once configured, the email service will be ready to send transactional emails, notifications, and reminders."})]})})]})]})}export{$ as EmailServiceTest};
