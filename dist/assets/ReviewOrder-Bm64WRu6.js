import{u as N,a as w,I as C,d as S,r as x,c as k,j as e,t as o,g as E,k as I,l as P}from"./index-C7jV57L-.js";import{P as A}from"./package-sL0K4R_A.js";import{S as u}from"./square-pen-C0i8uS2r.js";import{M as B}from"./map-pin-BehCdzck.js";import{C as D}from"./circle-check-big-DXQHMGWC.js";const M={shippingMethod:"individual"};function U(){const a=N(),{siteId:O}=w(),{selectedGift:i,quantity:h,shippingAddress:s}=C(),{userIdentifier:f}=S(),[n,d]=x.useState(!1),[p,c]=x.useState(null),{t}=k();x.useEffect(()=>{(!i||!s)&&a("../gift-selection")},[i,s,a]);const j=async()=>{if(!i||!s){c("Missing required information"),o.error("Missing required information");return}d(!0),c(null);try{const r=sessionStorage.getItem("employee_session");if(!r){o.error("Session expired. Please log in again."),a("../access");return}const l=E(),y=I(l),v={siteId:l.id,userId:f,giftId:i.id,quantity:h,shippingAddress:{fullName:s.fullName,addressLine1:s.street,addressLine2:"",city:s.city,state:s.state,postalCode:s.zipCode,country:s.country||"United States",phone:s.phone||""}},g=await fetch(`${y}/public/orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.supabaseAnonKey}`,"X-Environment-ID":l.id,"X-Session-Token":r},body:JSON.stringify(v)}),m=await g.json();if(!g.ok||!m.success)throw new Error(m.error||"Failed to create order");o.success("Order placed successfully! ðŸŽ‰"),d(!1),a(`/confirmation/${m.order.id}`)}catch(r){P.error("Failed to submit order:",r),c(r instanceof Error?r.message:"Failed to submit order. Please try again."),o.error(r instanceof Error?r.message:"Failed to submit order"),d(!1)}};if(!i||!s)return null;const b=M.shippingMethod==="company";return e.jsx("div",{className:"min-h-[calc(100vh-4rem)] py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-block bg-pink-100 text-[#D91C81] px-4 py-2 rounded-full mb-4",children:e.jsx("p",{className:"text-sm font-medium",children:t("review.step")})}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4",children:t("review.title")}),e.jsx("p",{className:"text-lg text-gray-600",children:t("review.reviewBeforeConfirm")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(A,{className:"w-7 h-7 text-[#D91C81]"}),t("review.selectedGift")]}),e.jsxs("button",{onClick:()=>a("../gift-selection"),className:"flex items-center gap-2 text-[#D91C81] hover:text-[#B71569] font-medium text-sm",children:[e.jsx(u,{className:"w-4 h-4"}),t("review.change")]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-40 h-40 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:e.jsx("img",{src:i.image,alt:i.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-block bg-pink-100 text-[#D91C81] px-3 py-1 rounded-full text-sm font-medium",children:i.category})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:i.name}),e.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[t("review.quantity")," ",h]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(B,{className:"w-7 h-7 text-[#00B4CC]"}),t("review.shippingInformation")]}),e.jsxs("button",{onClick:()=>a("../shipping-information"),className:"flex items-center gap-2 text-[#D91C81] hover:text-[#B71569] font-medium text-sm",children:[e.jsx(u,{className:"w-4 h-4"}),t("review.change")]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[b,e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("review.recipient")}),e.jsx("p",{className:"text-gray-900 font-semibold",children:s.fullName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("review.deliveryAddress")}),e.jsx("p",{className:"text-gray-900",children:s.street}),e.jsxs("p",{className:"text-gray-900",children:[s.city,", ",s.state," ",s.zipCode]}),e.jsx("p",{className:"text-gray-900",children:s.country})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("review.phoneLabel")}),e.jsx("p",{className:"text-gray-900",children:s.phone})]})]})]})]}),e.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-[#1B2A5E] mb-2",children:t("review.orderConfirmationTitle")}),e.jsx("p",{className:"text-sm text-gray-700",children:t("review.orderConfirmationDesc")})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:j,disabled:n,className:"flex items-center gap-3 bg-gradient-to-r from-[#D91C81] to-[#B71569] text-white px-12 py-5 rounded-xl font-bold text-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed",style:{boxShadow:"0 4px 12px rgba(217, 28, 129, 0.3)"},onMouseEnter:r=>!n&&(r.currentTarget.style.boxShadow="0 6px 16px rgba(217, 28, 129, 0.4)"),onMouseLeave:r=>!n&&(r.currentTarget.style.boxShadow="0 4px 12px rgba(217, 28, 129, 0.3)"),children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}),t("review.processingOrder")]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-6 h-6"}),t("review.confirmOrder")]})})}),p&&e.jsx("div",{className:"mt-4 text-red-500 text-sm",children:p})]})]})})}export{U as ReviewOrder};
