import{m as Ut,j as e,K as tr,r as _,Y as rr,X as sr,Z as x}from"./index-DAep3-17.js";import{C as nr}from"./circle-alert-BJpcJige.js";import{R as ar}from"./rotate-ccw-Cd0zLiGk.js";import{S as or}from"./save-VFQGZXXm.js";import{C as ir}from"./code-CskcP2fb.js";import{P as lr}from"./palette-DwRAajaX.js";import{C as cr}from"./chevron-up-DF2_RBoF.js";import{S as dr}from"./square-pen-Bj3YdsC1.js";import{C as ur}from"./copy-CQOI8jQv.js";import{T as mr}from"./trash-2-orf3MXe6.js";import{P as hr}from"./plus-U3aaopYz.js";import{S as pr,M as fr}from"./smartphone-BGx8SKCA.js";import{E as gr}from"./external-link-BkWXEGDv.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["path",{d:"M10 21V8a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H3",key:"1fpvtg"}]],yr=Ut("blocks",xr);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]],vr=Ut("tablet",br);class wr{constructor(t,n=50){this.history={past:[],present:t,future:[],maxSize:n}}push(t){this.history.past.push(this.history.present),this.history.past.length>this.history.maxSize&&this.history.past.shift(),this.history.present=t,this.history.future=[]}undo(){if(!this.canUndo())return null;this.history.future.unshift(this.history.present);const t=this.history.past.pop();return this.history.present=t,t}redo(){if(!this.canRedo())return null;this.history.past.push(this.history.present);const t=this.history.future.shift();return this.history.present=t,t}canUndo(){return this.history.past.length>0}canRedo(){return this.history.future.length>0}getCurrent(){return this.history.present}getHistory(){return this.history}clear(){this.history.past=[],this.history.future=[]}reset(t){this.history.past=[],this.history.present=t,this.history.future=[]}getUndoCount(){return this.history.past.length}getRedoCount(){return this.history.future.length}}const Er=({hasChanges:s,saveStatus:t,onSave:n,onReset:a,canUndo:l,canRedo:d,onUndo:f,onRedo:E})=>e.jsx("div",{className:"border-b bg-white px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Page Editor"}),s&&e.jsxs("div",{className:"flex items-center text-amber-600 text-sm",children:[e.jsx(nr,{className:"w-4 h-4 mr-1"}),"Unsaved changes"]}),t==="saved"&&e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx(tr,{className:"w-4 h-4 mr-1"}),"Saved"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,disabled:!l,className:"px-3 py-2 text-sm border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Undo",children:"Undo"}),e.jsx("button",{onClick:E,disabled:!d,className:"px-3 py-2 text-sm border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Redo",children:"Redo"}),e.jsxs("button",{onClick:a,className:"px-3 py-2 text-sm border rounded hover:bg-gray-50 flex items-center",title:"Reset to default",children:[e.jsx(ar,{className:"w-4 h-4 mr-1"}),"Reset"]}),e.jsxs("button",{onClick:n,disabled:!s||t==="saving",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[e.jsx(or,{className:"w-4 h-4 mr-1"}),t==="saving"?"Saving...":"Save"]})]})]})}),Nr={visual:{label:"Visual",icon:lr,description:"Form-based editing"},blocks:{label:"Blocks",icon:yr,description:"Drag-and-drop builder"},custom:{label:"Custom Code",icon:ir,description:"HTML/CSS/JS"}},Tr=({currentMode:s,allowedModes:t,onModeChange:n})=>e.jsx("div",{className:"flex space-x-2 border-b bg-gray-50 px-6 py-3",children:t.map(a=>{const l=Nr[a],d=l.icon,f=s===a;return e.jsxs("button",{onClick:()=>n(a),className:`
              flex items-center px-4 py-2 rounded-t border-b-2 transition-colors
              ${f?"bg-white border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:bg-gray-100"}
            `,title:l.description,children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),l.label]},a)})});class Ar{validate(t){const n=[];return(!t.version||typeof t.version!="string")&&n.push({field:"version",message:"Configuration version is required and must be a string"}),(!t.mode||!["visual","blocks","custom"].includes(t.mode))&&n.push({field:"mode",message:"Mode must be one of: visual, blocks, custom"}),t.mode==="visual"&&!t.visual&&n.push({field:"visual",message:"Visual configuration is required when mode is visual"}),t.mode==="blocks"&&(t.blocks?Array.isArray(t.blocks)?t.blocks.forEach((a,l)=>{this.validateBlock(a).errors.forEach(f=>{n.push({field:`blocks[${l}].${f.field}`,message:f.message})})}):n.push({field:"blocks",message:"Blocks must be an array"}):n.push({field:"blocks",message:"Blocks array is required when mode is blocks"})),t.mode==="custom"&&!t.custom&&n.push({field:"custom",message:"Custom code configuration is required when mode is custom"}),t.custom&&(typeof t.custom.html!="string"&&n.push({field:"custom.html",message:"Custom HTML must be a string"}),typeof t.custom.css!="string"&&n.push({field:"custom.css",message:"Custom CSS must be a string"}),typeof t.custom.javascript!="string"&&n.push({field:"custom.javascript",message:"Custom JavaScript must be a string"})),t.metadata&&t.metadata.lastModified&&typeof t.metadata.lastModified!="string"&&n.push({field:"metadata.lastModified",message:"Last modified must be a string"}),{valid:n.length===0,errors:n}}validateBlock(t,n=0,a=10){const l=[];return(!t.id||typeof t.id!="string")&&l.push({field:"id",message:"Block ID is required and must be a string"}),(!t.type||typeof t.type!="string")&&l.push({field:"type",message:"Block type is required and must be a string"}),(!t.content||typeof t.content!="object")&&l.push({field:"content",message:"Block content is required and must be an object"}),(!t.styles||typeof t.styles!="object")&&l.push({field:"styles",message:"Block styles is required and must be an object"}),n>a&&l.push({field:"children",message:`Block nesting depth exceeds maximum of ${a}`}),t.children&&(Array.isArray(t.children)?t.type==="layout"?t.children.forEach((d,f)=>{Array.isArray(d)?d.forEach((E,u)=>{this.validateBlock(E,n+1,a).errors.forEach(o=>{l.push({field:`children[${f}][${u}].${o.field}`,message:o.message})})}):this.validateBlock(d,n+1,a).errors.forEach(u=>{l.push({field:`children[${f}].${u.field}`,message:u.message})})}):t.children.forEach((d,f)=>{this.validateBlock(d,n+1,a).errors.forEach(u=>{l.push({field:`children[${f}].${u.field}`,message:u.message})})}):l.push({field:"children",message:"Block children must be an array"})),{valid:l.length===0,errors:l}}validateField(t,n){const a=[];if(!t.validation||t.validation.length===0)return{valid:!0,errors:[]};for(const l of t.validation){const d=this.validateRule(l,n,t.label);d&&a.push(d)}return{valid:a.length===0,errors:a}}validateRule(t,n,a){switch(t.type){case"required":if(n==null||n==="")return{field:a,message:t.message||`${a} is required`};break;case"minLength":if(typeof n=="string"&&n.length<(t.value||0))return{field:a,message:t.message||`${a} must be at least ${t.value} characters`};break;case"maxLength":if(typeof n=="string"&&n.length>(t.value||0))return{field:a,message:t.message||`${a} must be at most ${t.value} characters`};break;case"pattern":if(typeof n=="string"&&t.value&&!new RegExp(t.value).test(n))return{field:a,message:t.message||`${a} format is invalid`};break;case"custom":if(t.validator&&!t.validator(n))return{field:a,message:t.message||`${a} validation failed`};break}return null}}const Cr=new Ar,Sr=({config:s,values:t,onChange:n,errors:a})=>{const[l,d]=_.useState(t),[f,E]=_.useState({});_.useEffect(()=>{d(t)},[t]);const u=(c,y,B)=>{const k={...l,[c]:y};d(k);const N=Cr.validateField(B,y);!N.valid&&N.errors.length>0?E(m=>({...m,[c]:N.errors[0].message})):E(m=>{const{[c]:b,...F}=m;return F}),n(k)},T=c=>{if(!c.conditional)return!0;const{field:y,operator:B,value:k}=c.conditional,N=l[y];switch(B){case"equals":return N===k;case"notEquals":return N!==k;case"contains":return String(N).includes(String(k));case"notContains":return!String(N).includes(String(k));default:return!0}},o=c=>{var N;if(!T(c))return null;const y=l[c.id]??c.defaultValue,B=f[c.id]||(a==null?void 0:a[c.id]),k=`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${B?"border-red-500":"border-gray-300"}`;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c.label,((N=c.validation)==null?void 0:N.some(m=>m.type==="required"))&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),c.type==="text"&&e.jsx("input",{type:"text",value:y||"",onChange:m=>u(c.id,m.target.value,c),placeholder:c.placeholder,className:k}),c.type==="textarea"&&e.jsx("textarea",{value:y||"",onChange:m=>u(c.id,m.target.value,c),placeholder:c.placeholder,rows:4,className:k}),c.type==="number"&&e.jsx("input",{type:"number",value:y||"",onChange:m=>u(c.id,Number(m.target.value),c),placeholder:c.placeholder,className:k}),c.type==="checkbox"&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:!!y,onChange:m=>u(c.id,m.target.checked,c),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:c.helpText})]}),c.type==="select"&&c.options&&e.jsxs("select",{value:y||"",onChange:m=>u(c.id,m.target.value,c),className:k,children:[e.jsx("option",{value:"",children:"Select..."}),c.options.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))]}),c.type==="color"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:y||"#000000",onChange:m=>u(c.id,m.target.value,c),className:"w-12 h-10 border rounded cursor-pointer"}),e.jsx("input",{type:"text",value:y||"",onChange:m=>u(c.id,m.target.value,c),placeholder:"#000000",className:k})]}),c.type==="image"&&e.jsxs("div",{children:[e.jsx("input",{type:"text",value:y||"",onChange:m=>u(c.id,m.target.value,c),placeholder:"Enter image URL",className:k}),y&&e.jsx("img",{src:y,alt:"Preview",className:"mt-2 max-w-xs rounded border",onError:m=>{m.target.style.display="none"}})]}),c.type==="custom"&&c.customComponent&&e.jsx(c.customComponent,{value:y,onChange:m=>u(c.id,m,c),field:c}),c.helpText&&c.type!=="checkbox"&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c.helpText}),B&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:B})]},c.id)},g=c=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[c.icon&&e.jsx("span",{className:"mr-2",children:c.icon}),c.title]}),e.jsx("div",{className:"space-y-4",children:c.fields.map(y=>o(y))})]},c.id);return e.jsxs("div",{className:"p-6 overflow-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Visual Editor"}),s.sections.map(c=>g(c))]})};var Re,jr=new Uint8Array(16);function _r(){if(!Re&&(Re=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Re))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Re(jr)}const kr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Rr(s){return typeof s=="string"&&kr.test(s)}var P=[];for(var Ze=0;Ze<256;++Ze)P.push((Ze+256).toString(16).substr(1));function Dr(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(P[s[t+0]]+P[s[t+1]]+P[s[t+2]]+P[s[t+3]]+"-"+P[s[t+4]]+P[s[t+5]]+"-"+P[s[t+6]]+P[s[t+7]]+"-"+P[s[t+8]]+P[s[t+9]]+"-"+P[s[t+10]]+P[s[t+11]]+P[s[t+12]]+P[s[t+13]]+P[s[t+14]]+P[s[t+15]]).toLowerCase();if(!Rr(n))throw TypeError("Stringified UUID is invalid");return n}function Lr(s,t,n){s=s||{};var a=s.random||(s.rng||_r)();return a[6]=a[6]&15|64,a[8]=a[8]&63|128,Dr(a)}class Or{constructor(){this.blocks=new Map}register(t,n){if(!n.label||!n.description)throw new Error(`Block definition for ${t} must include label and description`);if(!n.icon)throw new Error(`Block definition for ${t} must include an icon component`);if(!n.defaultContent||typeof n.defaultContent!="object")throw new Error(`Block definition for ${t} must include default content`);if(!n.defaultStyles||typeof n.defaultStyles!="object")throw new Error(`Block definition for ${t} must include default styles`);if(!n.contentSchema||typeof n.contentSchema!="object")throw new Error(`Block definition for ${t} must include content schema`);if(!n.renderPreview||typeof n.renderPreview!="function")throw new Error(`Block definition for ${t} must include renderPreview function`);if(!n.renderEditor||typeof n.renderEditor!="function")throw new Error(`Block definition for ${t} must include renderEditor function`);this.blocks.set(t,n)}unregister(t){this.blocks.delete(t)}get(t){return this.blocks.get(t)}getAll(){return Array.from(this.blocks.values())}getByCategory(t){return this.getAll().filter(n=>n.category===t)}createBlock(t){const n=this.get(t);if(!n)throw new Error(`Block type ${t} is not registered`);const a=JSON.parse(JSON.stringify(n.defaultContent)),l=JSON.parse(JSON.stringify(n.defaultStyles)),d={id:Lr(),type:t,content:a,styles:l};return n.allowChildren&&(d.children=[]),d}has(t){return this.blocks.has(t)}getTypes(){return Array.from(this.blocks.keys())}getCategories(){const t=new Set;return this.getAll().forEach(n=>{n.category&&t.add(n.category)}),Array.from(t)}clear(){this.blocks.clear()}}const se=new Or,Mr=({blocks:s,selectedBlockId:t,onSelectBlock:n,onMoveUp:a,onMoveDown:l,onDelete:d,onDuplicate:f})=>{const E=(u,T)=>{window.confirm(`Are you sure you want to delete this ${T} block?`)&&d(u)};return e.jsx("div",{className:"space-y-2",children:s.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'No blocks yet. Click "Add Block" to get started.'})}):s.map((u,T)=>{const o=u.id===t,g=T===0,c=T===s.length-1;return e.jsx("div",{className:`
                border rounded-lg p-3 transition-all cursor-pointer
                ${o?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-white"}
              `,onClick:()=>n(u.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:y=>{y.stopPropagation(),a(T)},disabled:g,className:"p-1 hover:bg-gray-100 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:e.jsx(cr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),l(T)},disabled:c,className:"p-1 hover:bg-gray-100 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:e.jsx(rr,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm capitalize",children:u.type.replace(/-/g," ")}),e.jsxs("div",{className:"text-xs text-gray-500",children:[Object.keys(u.content).length," properties"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:y=>{y.stopPropagation(),n(u.id)},className:"p-2 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(dr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),f(T)},className:"p-2 hover:bg-gray-100 rounded",title:"Duplicate",children:e.jsx(ur,{className:"w-4 h-4"})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),E(T,u.type)},className:"p-2 hover:bg-red-100 text-red-600 rounded",title:"Delete",children:e.jsx(mr,{className:"w-4 h-4"})})]})]})},u.id)})})},Ir=({isOpen:s,onClose:t,onSelectBlock:n,allowedBlockTypes:a})=>{const[l,d]=_.useState("all");if(!s)return null;const f=se.getAll(),E=["all",...se.getCategories()],u=a?f.filter(g=>a.includes(g.type)):f,T=l==="all"?u:u.filter(g=>g.category===l),o=g=>{n(g),t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Block"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(sr,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex space-x-2 p-4 border-b overflow-x-auto",children:E.map(g=>e.jsx("button",{onClick:()=>d(g),className:`
                flex items-center px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors
                ${l===g?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
              `,children:g.charAt(0).toUpperCase()+g.slice(1)},g))}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:T.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:e.jsx("p",{children:"No blocks available in this category."})}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:T.map(g=>{const c=g.icon;return e.jsxs("button",{onClick:()=>o(g.type),className:"flex flex-col items-center p-6 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all text-center",children:[e.jsx("div",{className:"w-12 h-12 flex items-center justify-center mb-3 text-blue-600",children:e.jsx(c,{})}),e.jsx("div",{className:"font-medium text-sm mb-1",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.description})]},g.type)})})})]})})},Pr=({block:s,onChange:t})=>{if(!s)return e.jsx("div",{className:"p-6 text-center text-gray-500",children:e.jsx("p",{children:"Select a block to edit its properties"})});const n=se.get(s.type);if(!n)return e.jsx("div",{className:"p-6 text-center text-red-500",children:e.jsxs("p",{children:['Block type "',s.type,'" not found in registry']})});const a=(d,f)=>{t({content:{...s.content,[d]:f}})},l=(d,f)=>{t({styles:{...s.styles,[d]:f}})};return e.jsxs("div",{className:"p-6 overflow-auto",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 capitalize",children:["Edit ",s.type.replace(/-/g," ")," Block"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Content"}),e.jsx("div",{className:"space-y-4",children:Object.entries(n.contentSchema).map(([d,f])=>{const E=s.content[d]??f.default;return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[d.charAt(0).toUpperCase()+d.slice(1).replace(/([A-Z])/g," $1"),f.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f.type==="string"&&d.includes("text")?e.jsx("textarea",{value:E||"",onChange:u=>a(d,u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}):f.type==="string"?e.jsx("input",{type:"text",value:E||"",onChange:u=>a(d,u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):f.type==="number"?e.jsx("input",{type:"number",value:E||"",onChange:u=>a(d,Number(u.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):f.type==="boolean"?e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:!!E,onChange:u=>a(d,u.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}):e.jsx("input",{type:"text",value:E||"",onChange:u=>a(d,u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]},d)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Styles"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Background Color"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:s.styles.backgroundColor||"#ffffff",onChange:d=>l("backgroundColor",d.target.value),className:"w-12 h-10 border rounded cursor-pointer"}),e.jsx("input",{type:"text",value:s.styles.backgroundColor||"",onChange:d=>l("backgroundColor",d.target.value),placeholder:"#ffffff",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Padding"}),e.jsx("input",{type:"text",value:typeof s.styles.padding=="string"?s.styles.padding:"",onChange:d=>l("padding",d.target.value),placeholder:"20px",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Align"}),e.jsxs("select",{value:typeof s.styles.textAlign=="string"?s.styles.textAlign:"left",onChange:d=>l("textAlign",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"left",children:"Left"}),e.jsx("option",{value:"center",children:"Center"}),e.jsx("option",{value:"right",children:"Right"})]})]})]})]})]})},Br=({blocks:s,onChange:t,allowedBlockTypes:n,enableDragDrop:a,enableLayouts:l,maxNestingDepth:d})=>{const[f,E]=_.useState(!1),[u,T]=_.useState(null),o=s.find(m=>m.id===u)||null,g=m=>{const b=se.createBlock(m);t([...s,b]),T(b.id)},c=m=>{if(m===0)return;const b=[...s];[b[m-1],b[m]]=[b[m],b[m-1]],t(b)},y=m=>{if(m===s.length-1)return;const b=[...s];[b[m],b[m+1]]=[b[m+1],b[m]],t(b)},B=m=>{const b=s.filter((F,S)=>S!==m);t(b),s[m].id===u&&T(null)},k=m=>{const b=s[m],F={...JSON.parse(JSON.stringify(b)),id:`${b.type}-${Date.now()}`},S=[...s];S.splice(m+1,0,F),t(S)},N=m=>{if(!u)return;const b=s.map(F=>F.id===u?{...F,...m}:F);t(b)};return e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-1/2 border-r p-6 overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Blocks"}),e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:[e.jsx(hr,{className:"w-4 h-4 mr-1"}),"Add Block"]})]}),e.jsx(Mr,{blocks:s,selectedBlockId:u,onSelectBlock:T,onMoveUp:c,onMoveDown:y,onDelete:B,onDuplicate:k})]}),e.jsx("div",{className:"w-1/2 overflow-auto",children:e.jsx(Pr,{block:o,onChange:N})}),e.jsx(Ir,{isOpen:f,onClose:()=>E(!1),onSelectBlock:g,allowedBlockTypes:n})]})},Ur=({html:s,css:t,javascript:n,onChange:a})=>{const[l,d]=_.useState("html"),f=u=>{a({[l]:u})},E=l==="html"?s:l==="css"?t:n;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex space-x-2 border-b px-6 py-3 bg-gray-50",children:["html","css","javascript"].map(u=>e.jsx("button",{onClick:()=>d(u),className:`
              px-4 py-2 rounded-t border-b-2 transition-colors uppercase text-sm
              ${l===u?"bg-white border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:bg-gray-100"}
            `,children:u},u))}),e.jsx("div",{className:"flex-1 p-6",children:e.jsx("textarea",{value:E,onChange:u=>f(u.target.value),className:"w-full h-full font-mono text-sm border rounded p-4 resize-none",placeholder:`Enter ${l.toUpperCase()} code here...`})}),e.jsx("div",{className:"border-t bg-yellow-50 px-6 py-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-600 text-lg",children:"âš ï¸"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-yellow-900 mb-1",children:"Security Warning"}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Custom code is executed in a sandboxed environment. Ensure all code is safe, tested, and from trusted sources only. Malicious code can compromise data security."})]})]})})]})},Fr={desktop:"100%",tablet:"768px",mobile:"375px"},Hr=({config:s,device:t,interactive:n=!1,pageType:a})=>{const l=()=>{if(!s.visual)return e.jsx("div",{className:"text-gray-500",children:"No visual configuration"});const o=s.visual,g=()=>o.heroBackgroundType==="gradient"&&o.heroBackgroundGradient?{background:o.heroBackgroundGradient}:o.heroBackgroundType==="solid"&&o.heroBackgroundColor?{backgroundColor:o.heroBackgroundColor}:o.heroBackgroundType==="image"&&o.heroBackgroundImage?{backgroundImage:`url(${o.heroBackgroundImage})`,backgroundSize:"cover",backgroundPosition:"center"}:{backgroundColor:"#1B2A5E"},c=()=>o.ctaStyle==="primary"?"bg-white text-gray-900 hover:bg-gray-100":o.ctaStyle==="secondary"?"bg-transparent border-2 border-white text-white hover:bg-white hover:text-gray-900":"bg-blue-600 text-white hover:bg-blue-700";return e.jsxs("div",{className:"w-full min-h-screen bg-gray-50",children:[o.showLogo!==!1&&e.jsx("header",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsx("div",{className:`flex items-center ${o.logoPosition==="center"?"mx-auto":""}`,children:e.jsx("div",{className:"text-xl font-bold text-gray-900",children:"Company Logo"})}),o.showLanguageSelector&&e.jsx("div",{className:"text-sm text-gray-600",children:"ðŸŒ Language"})]})}),e.jsx("section",{className:"relative py-20 px-4 text-white",style:g(),children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6 whitespace-pre-line",children:o.heroTitle||"Your Exclusive Gift Selection Portal"}),e.jsx("p",{className:"text-lg md:text-xl mb-8 opacity-90",children:o.heroSubtitle||"Welcome to your exclusive gift selection portal."}),e.jsx("button",{className:`px-8 py-3 rounded-lg font-semibold transition-colors ${c()}`,children:o.ctaText||"Get Started"})]})}),o.showFeatures&&e.jsx("section",{className:"py-16 px-4 bg-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12 text-gray-900",children:o.featuresTitle||"Why Choose Us"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[1,2,3].map(y=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"â­"}),e.jsxs("h3",{className:"text-xl font-semibold mb-2 text-gray-900",children:["Feature ",y]}),e.jsx("p",{className:"text-gray-600",children:"Feature description goes here"})]},y))})]})}),o.showHowItWorks&&e.jsx("section",{className:"py-16 px-4 bg-gray-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12 text-gray-900",children:o.howItWorksTitle||"How It Works"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[1,2,3].map(y=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4",children:y}),e.jsxs("h3",{className:"text-xl font-semibold mb-2 text-gray-900",children:["Step ",y]}),e.jsx("p",{className:"text-gray-600",children:"Step description goes here"})]},y))})]})})]})},d=()=>{if(!s.visual)return e.jsx("div",{className:"text-gray-500",children:"No visual configuration"});const o=s.visual;return e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden",children:[o.videoUrl?e.jsx("div",{className:"aspect-video bg-gray-200 flex items-center justify-center",children:e.jsxs("div",{className:"text-gray-500",children:["ðŸŽ¥ Video: ",o.videoUrl]})}):o.imageUrl?e.jsx("div",{className:"aspect-video bg-gray-200",children:e.jsx("img",{src:o.imageUrl,alt:"Welcome",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"aspect-video bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-6xl",children:"ðŸ‘‹"})}),e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:o.title||"Welcome!"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 whitespace-pre-line",children:o.message||"Thank you for being part of our team."}),(o.authorName||o.authorTitle)&&e.jsxs("div",{className:"mb-8 text-gray-700",children:[o.authorName&&e.jsx("div",{className:"font-semibold",children:o.authorName}),o.authorTitle&&e.jsx("div",{className:"text-sm",children:o.authorTitle})]}),e.jsx("button",{className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:o.ctaText||"Continue"}),o.showCelebrationWall&&e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Messages from Your Team"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[1,2].map(g=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm text-gray-600 italic",children:'"Congratulations!"'}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["- Colleague ",g]})]},g))})]})]})]})})},f=()=>{if(!s.visual)return e.jsx("div",{className:"text-gray-500",children:"No visual configuration"});const o=s.visual;return e.jsxs("div",{className:"w-full min-h-screen bg-white",children:[e.jsx("section",{className:`relative py-24 px-4 text-white bg-gradient-to-r ${o.gradientColors||"from-blue-600 to-indigo-800"}`,children:e.jsxs("div",{className:"max-w-6xl mx-auto text-center",children:[o.badgeText&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm mb-6",children:[e.jsx("span",{children:o.badgeIcon||"ðŸŽ"}),e.jsx("span",{children:o.badgeText})]}),e.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-6",children:o.title||"Celebrate Every Milestone"}),e.jsx("p",{className:"text-xl md:text-2xl opacity-90 max-w-3xl mx-auto",children:o.subtitle||"Choose from our curated selection of premium gifts"})]})}),e.jsx("section",{className:"py-20 px-4 bg-gray-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:o.deliverySectionTitle||"Choose Your Delivery Option"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:o.deliverySectionSubtitle||"Select how you'd like to receive your gifts"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 hover:shadow-xl transition-shadow",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ¢"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:o.companyShippingTitle||"Ship to Company"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o.companyShippingDescription||"Have all gifts delivered to your company address"}),e.jsx("button",{className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:o.companyShippingCTA||"Browse Catalog"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 hover:shadow-xl transition-shadow",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ‘¤"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:o.employeeShippingTitle||"Ship to Employee"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o.employeeShippingDescription||"Send gifts directly to individual employee addresses"}),e.jsx("button",{className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:o.employeeShippingCTA||"Browse Catalog"})]})]})]})}),o.showFeatures&&e.jsx("section",{className:"py-20 px-4 bg-white",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsx("div",{className:"grid md:grid-cols-3 gap-12",children:[1,2,3].map(g=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:o[`feature${g}Icon`]==="Gift"?"ðŸŽ":o[`feature${g}Icon`]==="Building2"?"ðŸ¢":o[`feature${g}Icon`]==="ArrowRight"?"âž¡ï¸":"â­"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:o[`feature${g}Title`]||`Feature ${g}`}),e.jsx("p",{className:"text-gray-600",children:o[`feature${g}Description`]||"Feature description"})]},g))})})})]})},E=()=>a==="landing-page"?l():a==="welcome-page"?d():a==="home-page"?f():s.visual?e.jsx("div",{className:"space-y-6 p-6",children:Object.entries(s.visual).map(([o,g])=>e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:o.charAt(0).toUpperCase()+o.slice(1).replace(/([A-Z])/g," $1")}),e.jsx("div",{className:"text-gray-900",children:typeof g=="object"?JSON.stringify(g,null,2):String(g)})]},o))}):e.jsx("div",{className:"text-gray-500",children:"No visual configuration"}),u=()=>!s.blocks||s.blocks.length===0?e.jsx("div",{className:"text-gray-500",children:"No blocks added yet"}):e.jsx("div",{className:"space-y-4",children:s.blocks.map(o=>{const g=se.get(o.type);if(!g)return e.jsx("div",{className:"p-4 border border-red-300 bg-red-50 rounded",children:e.jsxs("p",{className:"text-red-600",children:["Unknown block type: ",o.type]})},o.id);const c={padding:typeof o.styles.padding=="string"?o.styles.padding:void 0,margin:typeof o.styles.margin=="string"?o.styles.margin:void 0,backgroundColor:o.styles.backgroundColor,textAlign:typeof o.styles.textAlign=="string"?o.styles.textAlign:void 0,borderRadius:o.styles.borderRadius,boxShadow:o.styles.boxShadow};return e.jsx("div",{style:c,className:"border rounded",children:g.renderPreview(o)},o.id)})}),T=()=>{if(!s.custom)return e.jsx("div",{className:"text-gray-500",children:"No custom code"});const{html:o,css:g,javascript:c}=s.custom,y=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'unsafe-inline' 'unsafe-eval'; style-src 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'none'; frame-src 'none'; object-src 'none';">
          <style>
            body { margin: 0; padding: 20px; font-family: system-ui, -apple-system, sans-serif; }
            ${g||""}
          </style>
        </head>
        <body>
          ${o||"<p>No HTML content</p>"}
          <script>
            try {
              ${c||""}
            } catch (error) {
              console.error('Custom JavaScript error:', error);
            }
          <\/script>
        </body>
      </html>
    `;return e.jsx("iframe",{srcDoc:y,className:"w-full h-full min-h-[600px] border-0",sandbox:"allow-scripts",title:"Custom Code Preview"})};return e.jsxs("div",{className:"preview-renderer",children:[s.mode==="visual"&&E(),s.mode==="blocks"&&u(),s.mode==="custom"&&T()]})},Wr=({config:s,device:t,onDeviceChange:n,showDeviceControls:a=!0,showExternalLink:l=!1,externalUrl:d,pageType:f})=>{const E={desktop:fr,tablet:vr,mobile:pr};return e.jsxs("div",{className:"flex flex-col h-full bg-gray-100",children:[a&&e.jsxs("div",{className:"flex items-center justify-between border-b bg-white px-6 py-3",children:[e.jsx("div",{className:"flex space-x-2",children:["desktop","tablet","mobile"].map(u=>{const T=E[u],o=t===u;return e.jsx("button",{onClick:()=>n(u),className:`
                    p-2 rounded transition-colors
                    ${o?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}
                  `,title:u.charAt(0).toUpperCase()+u.slice(1),children:e.jsx(T,{className:"w-5 h-5"})},u)})}),l&&d&&e.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-sm text-blue-600 hover:text-blue-700",children:[e.jsx(gr,{className:"w-4 h-4 mr-1"}),"Open in new tab"]})]}),e.jsx("div",{className:"flex-1 p-6 overflow-auto",children:e.jsx("div",{className:"mx-auto bg-white shadow-lg transition-all duration-300",style:{width:Fr[t],minHeight:"600px"},children:e.jsx("div",{className:"p-8",children:e.jsx(Hr,{config:s,device:t,interactive:!1,pageType:f})})})})]})};/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Ft,setPrototypeOf:Rt,isFrozen:zr,getPrototypeOf:Gr,getOwnPropertyDescriptor:$r}=Object;let{freeze:W,seal:q,create:nt}=Object,{apply:at,construct:ot}=typeof Reflect<"u"&&Reflect;W||(W=function(t){return t});q||(q=function(t){return t});at||(at=function(t,n){for(var a=arguments.length,l=new Array(a>2?a-2:0),d=2;d<a;d++)l[d-2]=arguments[d];return t.apply(n,l)});ot||(ot=function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return new t(...a)});const De=z(Array.prototype.forEach),qr=z(Array.prototype.lastIndexOf),Dt=z(Array.prototype.pop),ye=z(Array.prototype.push),Vr=z(Array.prototype.splice),Oe=z(String.prototype.toLowerCase),Ke=z(String.prototype.toString),Qe=z(String.prototype.match),be=z(String.prototype.replace),Yr=z(String.prototype.indexOf),Xr=z(String.prototype.trim),V=z(Object.prototype.hasOwnProperty),H=z(RegExp.prototype.test),ve=Jr(TypeError);function z(s){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,a=new Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return at(s,t,a)}}function Jr(s){return function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return ot(s,n)}}function w(s,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oe;Rt&&Rt(s,null);let a=t.length;for(;a--;){let l=t[a];if(typeof l=="string"){const d=n(l);d!==l&&(zr(t)||(t[a]=d),l=d)}s[l]=!0}return s}function Zr(s){for(let t=0;t<s.length;t++)V(s,t)||(s[t]=null);return s}function J(s){const t=nt(null);for(const[n,a]of Ft(s))V(s,n)&&(Array.isArray(a)?t[n]=Zr(a):a&&typeof a=="object"&&a.constructor===Object?t[n]=J(a):t[n]=a);return t}function we(s,t){for(;s!==null;){const a=$r(s,t);if(a){if(a.get)return z(a.get);if(typeof a.value=="function")return z(a.value)}s=Gr(s)}function n(){return null}return n}const Lt=W(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),et=W(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),tt=W(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Kr=W(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rt=W(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Qr=W(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ot=W(["#text"]),Mt=W(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),st=W(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),It=W(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Le=W(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),es=q(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ts=q(/<%[\w\W]*|[\w\W]*%>/gm),rs=q(/\$\{[\w\W]*/gm),ss=q(/^data-[\-\w.\u00B7-\uFFFF]+$/),ns=q(/^aria-[\-\w]+$/),Ht=q(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),as=q(/^(?:\w+script|data):/i),os=q(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Wt=q(/^html$/i),is=q(/^[a-z][.\w]*(-[.\w]+)+$/i);var Pt=Object.freeze({__proto__:null,ARIA_ATTR:ns,ATTR_WHITESPACE:os,CUSTOM_ELEMENT:is,DATA_ATTR:ss,DOCTYPE_NAME:Wt,ERB_EXPR:ts,IS_ALLOWED_URI:Ht,IS_SCRIPT_OR_DATA:as,MUSTACHE_EXPR:es,TMPLIT_EXPR:rs});const Ee={element:1,text:3,progressingInstruction:7,comment:8,document:9},ls=function(){return typeof window>"u"?null:window},cs=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let a=null;const l="data-tt-policy-suffix";n&&n.hasAttribute(l)&&(a=n.getAttribute(l));const d="dompurify"+(a?"#"+a:"");try{return t.createPolicy(d,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+d+" could not be created."),null}},Bt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function zt(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ls();const t=p=>zt(p);if(t.version="3.3.1",t.removed=[],!s||!s.document||s.document.nodeType!==Ee.document||!s.Element)return t.isSupported=!1,t;let{document:n}=s;const a=n,l=a.currentScript,{DocumentFragment:d,HTMLTemplateElement:f,Node:E,Element:u,NodeFilter:T,NamedNodeMap:o=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:g,DOMParser:c,trustedTypes:y}=s,B=u.prototype,k=we(B,"cloneNode"),N=we(B,"remove"),m=we(B,"nextSibling"),b=we(B,"childNodes"),F=we(B,"parentNode");if(typeof f=="function"){const p=n.createElement("template");p.content&&p.content.ownerDocument&&(n=p.content.ownerDocument)}let S,Z="";const{implementation:pe,createNodeIterator:Me,createDocumentFragment:Ie,getElementsByTagName:Pe}=n,{importNode:Be}=a;let O=Bt();t.isSupported=typeof Ft=="function"&&typeof F=="function"&&pe&&pe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:ae,TMPLIT_EXPR:oe,DATA_ATTR:v,ARIA_ATTR:A,IS_SCRIPT_OR_DATA:$,ATTR_WHITESPACE:Ne,CUSTOM_ELEMENT:qt}=Pt;let{IS_ALLOWED_URI:lt}=Pt,L=null;const ct=w({},[...Lt,...et,...tt,...rt,...Ot]);let M=null;const dt=w({},[...Mt,...st,...It,...Le]);let j=Object.seal(nt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),fe=null,Ue=null;const ie=Object.seal(nt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ut=!0,Fe=!0,mt=!1,ht=!0,le=!1,Te=!0,te=!1,He=!1,We=!1,ce=!1,Ae=!1,Ce=!1,pt=!0,ft=!1;const Vt="user-content-";let ze=!0,ge=!1,de={},Y=null;const Ge=w({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let gt=null;const xt=w({},["audio","video","img","source","image","track"]);let $e=null;const yt=w({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",je="http://www.w3.org/2000/svg",K="http://www.w3.org/1999/xhtml";let ue=K,qe=!1,Ve=null;const Yt=w({},[Se,je,K],Ke);let _e=w({},["mi","mo","mn","ms","mtext"]),ke=w({},["annotation-xml"]);const Xt=w({},["title","style","font","a","script"]);let xe=null;const Jt=["application/xhtml+xml","text/html"],Zt="text/html";let D=null,me=null;const Kt=n.createElement("form"),bt=function(r){return r instanceof RegExp||r instanceof Function},Ye=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(me&&me===r)){if((!r||typeof r!="object")&&(r={}),r=J(r),xe=Jt.indexOf(r.PARSER_MEDIA_TYPE)===-1?Zt:r.PARSER_MEDIA_TYPE,D=xe==="application/xhtml+xml"?Ke:Oe,L=V(r,"ALLOWED_TAGS")?w({},r.ALLOWED_TAGS,D):ct,M=V(r,"ALLOWED_ATTR")?w({},r.ALLOWED_ATTR,D):dt,Ve=V(r,"ALLOWED_NAMESPACES")?w({},r.ALLOWED_NAMESPACES,Ke):Yt,$e=V(r,"ADD_URI_SAFE_ATTR")?w(J(yt),r.ADD_URI_SAFE_ATTR,D):yt,gt=V(r,"ADD_DATA_URI_TAGS")?w(J(xt),r.ADD_DATA_URI_TAGS,D):xt,Y=V(r,"FORBID_CONTENTS")?w({},r.FORBID_CONTENTS,D):Ge,fe=V(r,"FORBID_TAGS")?w({},r.FORBID_TAGS,D):J({}),Ue=V(r,"FORBID_ATTR")?w({},r.FORBID_ATTR,D):J({}),de=V(r,"USE_PROFILES")?r.USE_PROFILES:!1,ut=r.ALLOW_ARIA_ATTR!==!1,Fe=r.ALLOW_DATA_ATTR!==!1,mt=r.ALLOW_UNKNOWN_PROTOCOLS||!1,ht=r.ALLOW_SELF_CLOSE_IN_ATTR!==!1,le=r.SAFE_FOR_TEMPLATES||!1,Te=r.SAFE_FOR_XML!==!1,te=r.WHOLE_DOCUMENT||!1,ce=r.RETURN_DOM||!1,Ae=r.RETURN_DOM_FRAGMENT||!1,Ce=r.RETURN_TRUSTED_TYPE||!1,We=r.FORCE_BODY||!1,pt=r.SANITIZE_DOM!==!1,ft=r.SANITIZE_NAMED_PROPS||!1,ze=r.KEEP_CONTENT!==!1,ge=r.IN_PLACE||!1,lt=r.ALLOWED_URI_REGEXP||Ht,ue=r.NAMESPACE||K,_e=r.MATHML_TEXT_INTEGRATION_POINTS||_e,ke=r.HTML_INTEGRATION_POINTS||ke,j=r.CUSTOM_ELEMENT_HANDLING||{},r.CUSTOM_ELEMENT_HANDLING&&bt(r.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(j.tagNameCheck=r.CUSTOM_ELEMENT_HANDLING.tagNameCheck),r.CUSTOM_ELEMENT_HANDLING&&bt(r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(j.attributeNameCheck=r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),r.CUSTOM_ELEMENT_HANDLING&&typeof r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(j.allowCustomizedBuiltInElements=r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),le&&(Fe=!1),Ae&&(ce=!0),de&&(L=w({},Ot),M=[],de.html===!0&&(w(L,Lt),w(M,Mt)),de.svg===!0&&(w(L,et),w(M,st),w(M,Le)),de.svgFilters===!0&&(w(L,tt),w(M,st),w(M,Le)),de.mathMl===!0&&(w(L,rt),w(M,It),w(M,Le))),r.ADD_TAGS&&(typeof r.ADD_TAGS=="function"?ie.tagCheck=r.ADD_TAGS:(L===ct&&(L=J(L)),w(L,r.ADD_TAGS,D))),r.ADD_ATTR&&(typeof r.ADD_ATTR=="function"?ie.attributeCheck=r.ADD_ATTR:(M===dt&&(M=J(M)),w(M,r.ADD_ATTR,D))),r.ADD_URI_SAFE_ATTR&&w($e,r.ADD_URI_SAFE_ATTR,D),r.FORBID_CONTENTS&&(Y===Ge&&(Y=J(Y)),w(Y,r.FORBID_CONTENTS,D)),r.ADD_FORBID_CONTENTS&&(Y===Ge&&(Y=J(Y)),w(Y,r.ADD_FORBID_CONTENTS,D)),ze&&(L["#text"]=!0),te&&w(L,["html","head","body"]),L.table&&(w(L,["tbody"]),delete fe.tbody),r.TRUSTED_TYPES_POLICY){if(typeof r.TRUSTED_TYPES_POLICY.createHTML!="function")throw ve('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof r.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ve('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=r.TRUSTED_TYPES_POLICY,Z=S.createHTML("")}else S===void 0&&(S=cs(y,l)),S!==null&&typeof Z=="string"&&(Z=S.createHTML(""));W&&W(r),me=r}},vt=w({},[...et,...tt,...Kr]),wt=w({},[...rt,...Qr]),Qt=function(r){let i=F(r);(!i||!i.tagName)&&(i={namespaceURI:ue,tagName:"template"});const h=Oe(r.tagName),C=Oe(i.tagName);return Ve[r.namespaceURI]?r.namespaceURI===je?i.namespaceURI===K?h==="svg":i.namespaceURI===Se?h==="svg"&&(C==="annotation-xml"||_e[C]):!!vt[h]:r.namespaceURI===Se?i.namespaceURI===K?h==="math":i.namespaceURI===je?h==="math"&&ke[C]:!!wt[h]:r.namespaceURI===K?i.namespaceURI===je&&!ke[C]||i.namespaceURI===Se&&!_e[C]?!1:!wt[h]&&(Xt[h]||!vt[h]):!!(xe==="application/xhtml+xml"&&Ve[r.namespaceURI]):!1},X=function(r){ye(t.removed,{element:r});try{F(r).removeChild(r)}catch{N(r)}},re=function(r,i){try{ye(t.removed,{attribute:i.getAttributeNode(r),from:i})}catch{ye(t.removed,{attribute:null,from:i})}if(i.removeAttribute(r),r==="is")if(ce||Ae)try{X(i)}catch{}else try{i.setAttribute(r,"")}catch{}},Et=function(r){let i=null,h=null;if(We)r="<remove></remove>"+r;else{const R=Qe(r,/^[\r\n\t ]+/);h=R&&R[0]}xe==="application/xhtml+xml"&&ue===K&&(r='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+r+"</body></html>");const C=S?S.createHTML(r):r;if(ue===K)try{i=new c().parseFromString(C,xe)}catch{}if(!i||!i.documentElement){i=pe.createDocument(ue,"template",null);try{i.documentElement.innerHTML=qe?Z:C}catch{}}const U=i.body||i.documentElement;return r&&h&&U.insertBefore(n.createTextNode(h),U.childNodes[0]||null),ue===K?Pe.call(i,te?"html":"body")[0]:te?i.documentElement:U},Nt=function(r){return Me.call(r.ownerDocument||r,r,T.SHOW_ELEMENT|T.SHOW_COMMENT|T.SHOW_TEXT|T.SHOW_PROCESSING_INSTRUCTION|T.SHOW_CDATA_SECTION,null)},Xe=function(r){return r instanceof g&&(typeof r.nodeName!="string"||typeof r.textContent!="string"||typeof r.removeChild!="function"||!(r.attributes instanceof o)||typeof r.removeAttribute!="function"||typeof r.setAttribute!="function"||typeof r.namespaceURI!="string"||typeof r.insertBefore!="function"||typeof r.hasChildNodes!="function")},Tt=function(r){return typeof E=="function"&&r instanceof E};function Q(p,r,i){De(p,h=>{h.call(t,r,i,me)})}const At=function(r){let i=null;if(Q(O.beforeSanitizeElements,r,null),Xe(r))return X(r),!0;const h=D(r.nodeName);if(Q(O.uponSanitizeElement,r,{tagName:h,allowedTags:L}),Te&&r.hasChildNodes()&&!Tt(r.firstElementChild)&&H(/<[/\w!]/g,r.innerHTML)&&H(/<[/\w!]/g,r.textContent)||r.nodeType===Ee.progressingInstruction||Te&&r.nodeType===Ee.comment&&H(/<[/\w]/g,r.data))return X(r),!0;if(!(ie.tagCheck instanceof Function&&ie.tagCheck(h))&&(!L[h]||fe[h])){if(!fe[h]&&St(h)&&(j.tagNameCheck instanceof RegExp&&H(j.tagNameCheck,h)||j.tagNameCheck instanceof Function&&j.tagNameCheck(h)))return!1;if(ze&&!Y[h]){const C=F(r)||r.parentNode,U=b(r)||r.childNodes;if(U&&C){const R=U.length;for(let G=R-1;G>=0;--G){const ee=k(U[G],!0);ee.__removalCount=(r.__removalCount||0)+1,C.insertBefore(ee,m(r))}}}return X(r),!0}return r instanceof u&&!Qt(r)||(h==="noscript"||h==="noembed"||h==="noframes")&&H(/<\/no(script|embed|frames)/i,r.innerHTML)?(X(r),!0):(le&&r.nodeType===Ee.text&&(i=r.textContent,De([ne,ae,oe],C=>{i=be(i,C," ")}),r.textContent!==i&&(ye(t.removed,{element:r.cloneNode()}),r.textContent=i)),Q(O.afterSanitizeElements,r,null),!1)},Ct=function(r,i,h){if(pt&&(i==="id"||i==="name")&&(h in n||h in Kt))return!1;if(!(Fe&&!Ue[i]&&H(v,i))){if(!(ut&&H(A,i))){if(!(ie.attributeCheck instanceof Function&&ie.attributeCheck(i,r))){if(!M[i]||Ue[i]){if(!(St(r)&&(j.tagNameCheck instanceof RegExp&&H(j.tagNameCheck,r)||j.tagNameCheck instanceof Function&&j.tagNameCheck(r))&&(j.attributeNameCheck instanceof RegExp&&H(j.attributeNameCheck,i)||j.attributeNameCheck instanceof Function&&j.attributeNameCheck(i,r))||i==="is"&&j.allowCustomizedBuiltInElements&&(j.tagNameCheck instanceof RegExp&&H(j.tagNameCheck,h)||j.tagNameCheck instanceof Function&&j.tagNameCheck(h))))return!1}else if(!$e[i]){if(!H(lt,be(h,Ne,""))){if(!((i==="src"||i==="xlink:href"||i==="href")&&r!=="script"&&Yr(h,"data:")===0&&gt[r])){if(!(mt&&!H($,be(h,Ne,"")))){if(h)return!1}}}}}}}return!0},St=function(r){return r!=="annotation-xml"&&Qe(r,qt)},jt=function(r){Q(O.beforeSanitizeAttributes,r,null);const{attributes:i}=r;if(!i||Xe(r))return;const h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M,forceKeepAttr:void 0};let C=i.length;for(;C--;){const U=i[C],{name:R,namespaceURI:G,value:ee}=U,he=D(R),Je=ee;let I=R==="value"?Je:Xr(Je);if(h.attrName=he,h.attrValue=I,h.keepAttr=!0,h.forceKeepAttr=void 0,Q(O.uponSanitizeAttribute,r,h),I=h.attrValue,ft&&(he==="id"||he==="name")&&(re(R,r),I=Vt+I),Te&&H(/((--!?|])>)|<\/(style|title|textarea)/i,I)){re(R,r);continue}if(he==="attributename"&&Qe(I,"href")){re(R,r);continue}if(h.forceKeepAttr)continue;if(!h.keepAttr){re(R,r);continue}if(!ht&&H(/\/>/i,I)){re(R,r);continue}le&&De([ne,ae,oe],kt=>{I=be(I,kt," ")});const _t=D(r.nodeName);if(!Ct(_t,he,I)){re(R,r);continue}if(S&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!G)switch(y.getAttributeType(_t,he)){case"TrustedHTML":{I=S.createHTML(I);break}case"TrustedScriptURL":{I=S.createScriptURL(I);break}}if(I!==Je)try{G?r.setAttributeNS(G,R,I):r.setAttribute(R,I),Xe(r)?X(r):Dt(t.removed)}catch{re(R,r)}}Q(O.afterSanitizeAttributes,r,null)},er=function p(r){let i=null;const h=Nt(r);for(Q(O.beforeSanitizeShadowDOM,r,null);i=h.nextNode();)Q(O.uponSanitizeShadowNode,i,null),At(i),jt(i),i.content instanceof d&&p(i.content);Q(O.afterSanitizeShadowDOM,r,null)};return t.sanitize=function(p){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=null,h=null,C=null,U=null;if(qe=!p,qe&&(p="<!-->"),typeof p!="string"&&!Tt(p))if(typeof p.toString=="function"){if(p=p.toString(),typeof p!="string")throw ve("dirty is not a string, aborting")}else throw ve("toString is not a function");if(!t.isSupported)return p;if(He||Ye(r),t.removed=[],typeof p=="string"&&(ge=!1),ge){if(p.nodeName){const ee=D(p.nodeName);if(!L[ee]||fe[ee])throw ve("root node is forbidden and cannot be sanitized in-place")}}else if(p instanceof E)i=Et("<!---->"),h=i.ownerDocument.importNode(p,!0),h.nodeType===Ee.element&&h.nodeName==="BODY"||h.nodeName==="HTML"?i=h:i.appendChild(h);else{if(!ce&&!le&&!te&&p.indexOf("<")===-1)return S&&Ce?S.createHTML(p):p;if(i=Et(p),!i)return ce?null:Ce?Z:""}i&&We&&X(i.firstChild);const R=Nt(ge?p:i);for(;C=R.nextNode();)At(C),jt(C),C.content instanceof d&&er(C.content);if(ge)return p;if(ce){if(Ae)for(U=Ie.call(i.ownerDocument);i.firstChild;)U.appendChild(i.firstChild);else U=i;return(M.shadowroot||M.shadowrootmode)&&(U=Be.call(a,U,!0)),U}let G=te?i.outerHTML:i.innerHTML;return te&&L["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&H(Wt,i.ownerDocument.doctype.name)&&(G="<!DOCTYPE "+i.ownerDocument.doctype.name+`>
`+G),le&&De([ne,ae,oe],ee=>{G=be(G,ee," ")}),S&&Ce?S.createHTML(G):G},t.setConfig=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(p),He=!0},t.clearConfig=function(){me=null,He=!1},t.isValidAttribute=function(p,r,i){me||Ye({});const h=D(p),C=D(r);return Ct(h,C,i)},t.addHook=function(p,r){typeof r=="function"&&ye(O[p],r)},t.removeHook=function(p,r){if(r!==void 0){const i=qr(O[p],r);return i===-1?void 0:Vr(O[p],i,1)[0]}return Dt(O[p])},t.removeHooks=function(p){O[p]=[]},t.removeAllHooks=function(){O=Bt()},t}var Gt=zt();const ds=(s,t)=>{const n={ALLOWED_TAGS:["p","br","strong","em","u","a","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","code","pre","span","div","img","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","target","rel","src","alt","title","class"],ALLOW_DATA_ATTR:!1,FORBID_TAGS:["script","style","iframe","object","embed"],FORBID_ATTR:["onerror","onload","onclick","onmouseover"]},a=t?{ALLOWED_TAGS:t.allowedTags||n.ALLOWED_TAGS,ALLOWED_ATTR:t.allowedAttributes||n.ALLOWED_ATTR,ALLOW_DATA_ATTR:!1,FORBID_TAGS:n.FORBID_TAGS,FORBID_ATTR:n.FORBID_ATTR}:n;return Gt.sanitize(s,a)},us=s=>Gt.sanitize(s,{ALLOWED_TAGS:["p","br","strong","em","u"],ALLOWED_ATTR:[],ALLOW_DATA_ATTR:!1}),ms=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),e.jsx("path",{d:"M3 9h18M9 21V9"})]}),it=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M4 7V4h16v3M9 20h6M12 4v16"})}),$t=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("path",{d:"M21 15l-5-5L5 21"})]}),hs=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M23 7l-7 5 7 5V7z"}),e.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2"})]}),ps=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("rect",{x:"3",y:"8",width:"18",height:"8",rx:"2"})}),fs=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M3 12h18M3 6h18M3 18h18",strokeDasharray:"2 2"})}),gs=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M16 18l6-6-6-6M8 6l-6 6 6 6"})}),xs=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"18",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"18",rx:"1"})]}),ys={type:"hero",label:"Hero Section",description:"Large header section with title, subtitle, and call-to-action",icon:ms,category:"layout",defaultContent:{title:"Welcome to Our Site",subtitle:"Create amazing experiences",buttonText:"Get Started",buttonUrl:"#",backgroundImage:""},defaultStyles:{padding:"80px 20px",textAlign:"center",backgroundColor:"#f8f9fa"},contentSchema:{title:{type:"string",required:!0,default:""},subtitle:{type:"string",required:!1,default:""},buttonText:{type:"string",required:!1,default:""},buttonUrl:{type:"string",required:!1,default:"#"},backgroundImage:{type:"string",required:!1,default:""}},renderPreview:s=>x.createElement("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:s.styles.backgroundColor||"#f8f9fa"}},[x.createElement("h1",{key:"title"},s.content.title||"Hero Title"),x.createElement("p",{key:"subtitle"},s.content.subtitle||"Hero subtitle"),s.content.buttonText&&x.createElement("button",{key:"button"},s.content.buttonText)]),renderEditor:(s,t)=>x.createElement("div",null,"Hero editor placeholder")},bs={type:"text",label:"Text",description:"Rich text content block",icon:it,category:"content",defaultContent:{text:"<p>Enter your text here...</p>"},defaultStyles:{padding:"20px"},contentSchema:{text:{type:"string",required:!0,default:"<p></p>"}},renderPreview:s=>{const t=us(s.content.text||"");return x.createElement("div",{dangerouslySetInnerHTML:{__html:t}})},renderEditor:(s,t)=>x.createElement("div",null,"Text editor placeholder")},vs={type:"image",label:"Image",description:"Image with optional caption",icon:$t,category:"media",defaultContent:{src:"",alt:"",caption:""},defaultStyles:{textAlign:"center"},contentSchema:{src:{type:"string",required:!0,default:""},alt:{type:"string",required:!1,default:""},caption:{type:"string",required:!1,default:""}},renderPreview:s=>x.createElement("div",{style:{textAlign:"center"}},[s.content.src&&x.createElement("img",{key:"img",src:s.content.src,alt:s.content.alt||"",style:{maxWidth:"100%"}}),s.content.caption&&x.createElement("p",{key:"caption"},s.content.caption)]),renderEditor:(s,t)=>x.createElement("div",null,"Image editor placeholder")},ws={type:"video",label:"Video",description:"Embedded video player",icon:hs,category:"media",defaultContent:{url:"",provider:"youtube"},defaultStyles:{textAlign:"center"},contentSchema:{url:{type:"string",required:!0,default:""},provider:{type:"string",required:!1,default:"youtube"}},renderPreview:s=>x.createElement("div",{style:{textAlign:"center",padding:"20px"}},"Video: "+(s.content.url||"No URL")),renderEditor:(s,t)=>x.createElement("div",null,"Video editor placeholder")},Es={type:"cta-button",label:"Call to Action Button",description:"Button with link",icon:ps,category:"interactive",defaultContent:{text:"Click Here",url:"#",variant:"primary"},defaultStyles:{textAlign:"center",padding:"20px"},contentSchema:{text:{type:"string",required:!0,default:"Button"},url:{type:"string",required:!0,default:"#"},variant:{type:"string",required:!1,default:"primary"}},renderPreview:s=>x.createElement("div",{style:{textAlign:"center",padding:"20px"}},x.createElement("button",null,s.content.text||"Button")),renderEditor:(s,t)=>x.createElement("div",null,"Button editor placeholder")},Ns={type:"spacer",label:"Spacer",description:"Vertical spacing",icon:fs,category:"layout",defaultContent:{height:"40px"},defaultStyles:{},contentSchema:{height:{type:"string",required:!0,default:"40px"}},renderPreview:s=>x.createElement("div",{style:{height:s.content.height||"40px",backgroundColor:"#f0f0f0",border:"1px dashed #ccc"}}),renderEditor:(s,t)=>x.createElement("div",null,"Spacer editor placeholder")},Ts={type:"custom-html",label:"Custom HTML",description:"Custom HTML content",icon:gs,category:"advanced",defaultContent:{html:"<div>Custom HTML</div>"},defaultStyles:{},contentSchema:{html:{type:"string",required:!0,default:""}},renderPreview:s=>{const t=ds(s.content.html||"",{allowedTags:["p","div","span","br","strong","em","u","a","h1","h2","h3"],allowedAttributes:["href","target","rel","class"]});return x.createElement("div",{dangerouslySetInnerHTML:{__html:t}})},renderEditor:(s,t)=>x.createElement("div",null,"Custom HTML editor placeholder")},As=[ys,bs,vs,ws,Es,Ns,Ts],Cs={type:"celebration-wall",label:"Celebration Wall",description:"Display celebration messages from colleagues",icon:it,category:"interactive",defaultContent:{title:"Celebration Messages",displayMode:"wall",allowPeerMessages:!0},defaultStyles:{padding:"40px 20px"},contentSchema:{title:{type:"string",required:!1,default:"Celebration Messages"},displayMode:{type:"string",required:!1,default:"wall"},allowPeerMessages:{type:"boolean",required:!1,default:!0}},renderPreview:s=>x.createElement("div",{style:{padding:"20px",textAlign:"center"}},[x.createElement("h3",{key:"title"},s.content.title||"Celebration Messages"),x.createElement("p",{key:"desc",style:{color:"#666"}},"Celebration wall will display here")]),renderEditor:(s,t)=>x.createElement("div",null,"Celebration wall editor placeholder")},Ss={type:"testimonial",label:"Testimonial",description:"Customer or employee testimonial",icon:it,category:"content",defaultContent:{quote:"This is an amazing experience!",author:"John Doe",role:"Customer",avatar:""},defaultStyles:{padding:"30px",textAlign:"center"},contentSchema:{quote:{type:"string",required:!0,default:""},author:{type:"string",required:!0,default:""},role:{type:"string",required:!1,default:""},avatar:{type:"string",required:!1,default:""}},renderPreview:s=>x.createElement("div",{style:{padding:"20px",textAlign:"center"}},[x.createElement("blockquote",{key:"quote",style:{fontSize:"18px",fontStyle:"italic",marginBottom:"10px"}},`"${s.content.quote||"Quote"}"`),x.createElement("div",{key:"author",style:{fontWeight:"bold"}},s.content.author||"Author"),s.content.role&&x.createElement("div",{key:"role",style:{color:"#666",fontSize:"14px"}},s.content.role)]),renderEditor:(s,t)=>x.createElement("div",null,"Testimonial editor placeholder")},js={type:"gift-preview",label:"Gift Preview",description:"Preview of available gifts",icon:$t,category:"interactive",defaultContent:{title:"Featured Gifts",showPricing:!1,itemsPerRow:3},defaultStyles:{padding:"40px 20px"},contentSchema:{title:{type:"string",required:!1,default:"Featured Gifts"},showPricing:{type:"boolean",required:!1,default:!1},itemsPerRow:{type:"number",required:!1,default:3}},renderPreview:s=>x.createElement("div",{style:{padding:"20px"}},[x.createElement("h3",{key:"title",style:{textAlign:"center",marginBottom:"20px"}},s.content.title||"Featured Gifts"),x.createElement("p",{key:"desc",style:{textAlign:"center",color:"#666"}},"Gift preview grid will display here")]),renderEditor:(s,t)=>x.createElement("div",null,"Gift preview editor placeholder")},_s={type:"layout",label:"Layout (Columns)",description:"Multi-column layout container for organizing blocks",icon:xs,category:"layout",defaultContent:{columnCount:2,columnRatios:[1,1],gap:"1rem",stackOnMobile:!0,verticalAlign:"top"},defaultStyles:{padding:"20px"},contentSchema:{columnCount:{type:"number",required:!0,default:2},columnRatios:{type:"array",required:!0,default:[1,1]},gap:{type:"string",required:!1,default:"1rem"},stackOnMobile:{type:"boolean",required:!1,default:!0},verticalAlign:{type:"string",required:!1,default:"top"}},renderPreview:s=>{const t=s.content;return x.createElement("div",{style:{display:"grid",gridTemplateColumns:`repeat(${t.columnCount||2}, 1fr)`,gap:t.gap||"1rem",padding:"20px",border:"2px dashed #ccc",borderRadius:"8px"}},Array.from({length:t.columnCount||2}).map((n,a)=>x.createElement("div",{key:a,style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"4px",textAlign:"center",color:"#666"}},`Column ${a+1}`)))},renderEditor:(s,t)=>{const n=s.content;return x.createElement("div",{className:"space-y-3"},[x.createElement("div",{key:"columns"},[x.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-1"},"Number of Columns"),x.createElement("select",{key:"select",value:n.columnCount||2,onChange:a=>{const l=Number(a.target.value);t({content:{...n,columnCount:l,columnRatios:Array(l).fill(1)}})},className:"w-full px-3 py-2 border border-gray-300 rounded-md"},[1,2,3,4].map(a=>x.createElement("option",{key:a,value:a},a)))]),x.createElement("div",{key:"gap"},[x.createElement("label",{key:"label",className:"block text-sm font-medium text-gray-700 mb-1"},"Gap"),x.createElement("input",{key:"input",type:"text",value:n.gap||"1rem",onChange:a=>t({content:{...n,gap:a.target.value}}),placeholder:"e.g., 1rem, 20px",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]),x.createElement("div",{key:"stack",className:"flex items-center gap-2"},[x.createElement("input",{key:"checkbox",type:"checkbox",checked:n.stackOnMobile!==!1,onChange:a=>t({content:{...n,stackOnMobile:a.target.checked}}),className:"rounded border-gray-300"}),x.createElement("label",{key:"label",className:"text-sm font-medium text-gray-700"},"Stack on Mobile")])])},allowChildren:!0,maxChildren:100},ks=[...As,Cs,Ss,js,_s];function Rs(s){ks.forEach(t=>{s.register(t.type,t)})}class Ds extends x.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("[PageEditor] Error caught by boundary:",t,n)}render(){var t;return this.state.hasError?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"})]}):this.props.children}}const qs=({pageType:s,pageId:t,defaultConfig:n,visualConfig:a,allowedBlockTypes:l,allowedModes:d=["visual","blocks","custom"],storageAdapter:f,storageKey:E,onSave:u,onLoad:T,onChange:o,enableDragDrop:g=!1,enableLayouts:c=!1,enableTemplates:y=!1,enableGlobalBlocks:B=!1,maxNestingDepth:k=5})=>{var ne,ae,oe;const[N,m]=_.useState({config:n,mode:n.mode||"visual",selectedBlockId:null,previewDevice:"desktop",hasChanges:!1,saveStatus:"idle",history:{past:[],present:n,future:[],maxSize:50},dragState:null}),[b]=_.useState(()=>new wr(n)),[F,S]=_.useState(!0);_.useEffect(()=>{se.getAll().length===0&&Rs(se)},[]),_.useEffect(()=>{(async()=>{try{S(!0);const A=await f.load(E);A&&(m($=>({...$,config:A,mode:A.mode||$.mode})),b.reset(A),T&&T(A))}catch(A){console.error("[PageEditor] Failed to load configuration:",A)}finally{S(!1)}})()},[f,E,T]),_.useEffect(()=>{const v=A=>{N.hasChanges&&(A.preventDefault(),A.returnValue="")};return window.addEventListener("beforeunload",v),()=>{window.removeEventListener("beforeunload",v)}},[N.hasChanges]);const Z=_.useCallback(v=>{m(A=>{const $={...A.config,...v};b.push($);const Ne=!0;return o&&o($),{...A,config:$,hasChanges:Ne,history:b.getHistory()}})},[o,b]),pe=_.useCallback(v=>{m(A=>{const $={...A.config,mode:v};return b.push($),o&&o($),{...A,config:$,mode:v,hasChanges:!0,history:b.getHistory()}})},[o,b]);_.useCallback(v=>{m(A=>({...A,selectedBlockId:v}))},[]);const Me=_.useCallback(()=>{const v=b.undo();v&&(m(A=>({...A,config:v,hasChanges:!0,history:b.getHistory()})),o&&o(v))},[o,b]),Ie=_.useCallback(()=>{const v=b.redo();v&&(m(A=>({...A,config:v,hasChanges:!0,history:b.getHistory()})),o&&o(v))},[o,b]),Pe=_.useCallback(async()=>{try{m(v=>({...v,saveStatus:"saving"})),await f.save(E,N.config),u&&await u(N.config),m(v=>({...v,hasChanges:!1,saveStatus:"saved"})),setTimeout(()=>{m(v=>({...v,saveStatus:"idle"}))},2e3)}catch(v){console.error("[PageEditor] Failed to save configuration:",v),m(A=>({...A,saveStatus:"error"}))}},[f,E,N.config,u]),Be=_.useCallback(()=>{window.confirm("Are you sure you want to reset to default configuration? This cannot be undone.")&&(m(v=>({...v,config:n,hasChanges:!0})),b.reset(n),o&&o(n))},[n,o,b]),O=_.useCallback(v=>{m(A=>({...A,previewDevice:v}))},[]);return F?e.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading page editor..."})]})}):e.jsx(Ds,{children:e.jsxs("div",{className:"page-editor h-full flex flex-col",children:[e.jsx(Er,{hasChanges:N.hasChanges,saveStatus:N.saveStatus,onSave:Pe,onReset:Be,canUndo:b.canUndo(),canRedo:b.canRedo(),onUndo:Me,onRedo:Ie}),e.jsx(Tr,{currentMode:N.mode,allowedModes:d,onModeChange:pe}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 border-r overflow-auto",children:[N.mode==="visual"&&a&&e.jsx(Sr,{config:a,values:N.config.visual||{},onChange:v=>Z({visual:v})}),N.mode==="blocks"&&e.jsx(Br,{blocks:N.config.blocks||[],onChange:v=>Z({blocks:v}),allowedBlockTypes:l,enableDragDrop:g,enableLayouts:c,maxNestingDepth:k}),N.mode==="custom"&&e.jsx(Ur,{html:((ne=N.config.custom)==null?void 0:ne.html)||"",css:((ae=N.config.custom)==null?void 0:ae.css)||"",javascript:((oe=N.config.custom)==null?void 0:oe.javascript)||"",onChange:v=>Z({custom:{...N.config.custom,...v}})})]}),e.jsx("div",{className:"w-1/2",children:e.jsx(Wr,{config:N.config,device:N.previewDevice,onDeviceChange:O,showDeviceControls:!0,showExternalLink:!1,pageType:s})})]})]})})};export{qs as P};
