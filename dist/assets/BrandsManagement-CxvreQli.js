import{u as pe,q as je,r as t,j as e,S as fe,C as o,a6 as ye}from"./index-dV4Uttrq.js";import{u as ve}from"./usePhase5A-DaOkd9LR.js";import{a as m,s as h}from"./errorHandling-CwdwM2Re.js";import{B as be}from"./badge-hStN7-Ju.js";import{D as R,a as q,b as V,c as O,d as W,e as z}from"./dialog-BOcbCdZI.js";import{I as n}from"./input-DElxXLEL.js";import{L as c}from"./label-Cx_2PmZF.js";import{T as Ce}from"./textarea-Ckytr8B0.js";import{P as f}from"./palette-o-RVb535.js";import{P as Q}from"./plus-DUZUgypq.js";import{C as Ne}from"./circle-check-big-BTbhA0uw.js";import{C as we}from"./circle-x-CrdKUO8e.js";import{S as Se}from"./square-pen-BiMIh-Tu.js";import{T as Fe}from"./trash-2-B2VV2ZDP.js";import"./index-Bnc4558u.js";import"./index-Ttf8ZMtO.js";import"./index-C8MzEdCL.js";import"./index-DJFIPDZ_.js";import"./index-DS1l-0-y.js";import"./index-BO2tctDo.js";import"./index-faiGe14u.js";function Je(){const G=pe(),{clients:y,sites:k}=je(),[B,H]=t.useState(""),[v,J]=t.useState("all"),[i,X]=t.useState("all"),[b,K]=t.useState("all"),[Y,d]=t.useState(!1),[a,C]=t.useState(null),[Z,D]=t.useState(!1),[N,u]=t.useState("#4F46E5"),[w,g]=t.useState("#818CF8"),[_,U]=t.useState("#1F2937"),[ee,T]=t.useState("#F9FAFB"),[se,A]=t.useState(""),[ae,I]=t.useState(""),[re,p]=t.useState(!1),[x,S]=t.useState(""),[F,L]=t.useState(!1),[j,E]=t.useState([]),{brands:te,loading:le,error:P,createBrand:oe,updateBrand:ce,deleteBrand:ne}=ve({status:v==="all"?void 0:v,search:B||void 0}),M=te.filter(s=>{if(i!=="all"&&s.clientId!==i)return!1;if(b!=="all"){const r=k.find(l=>l.id===b);if(!r||r.brandId!==s.id)return!1}return!0}),ie=async s=>{s.preventDefault();const r=new FormData(s.currentTarget),l={name:r.get("name"),clientId:r.get("clientId"),description:r.get("description"),logoUrl:r.get("logoUrl"),primaryColor:N,secondaryColor:w,bodyTextColorDark:_,bodyTextColorLight:ee,accentColor1:se||void 0,accentColor2:ae||void 0,status:r.get("status")||"active"};try{a?(await ce(a.id,l),m("Brand updated successfully")):(await oe(l),m("Brand created successfully")),d(!1),C(null)}catch(ge){h(ge.message||"Failed to save brand")}},de=async(s,r)=>{if(confirm(`Are you sure you want to delete "${r}"?`)){D(!0);try{await ne(s),m(`"${r}" deleted successfully`)}catch(l){h(l.message||"Failed to delete brand")}finally{D(!1)}}},$=()=>{C(null),u("#4F46E5"),g("#818CF8"),U("#1F2937"),T("#F9FAFB"),A(""),I(""),d(!0)},xe=s=>{G(`/admin/brands/${s.id}/edit`)},me=async()=>{if(!x){h("Please enter a URL");return}L(!0);try{const s=await ye("/v2/brands/extract-colors",{method:"POST",body:JSON.stringify({url:x})});if(!s.success)throw new Error(s.error||"Failed to extract colors from website");E(s.colors||[]),s.colors&&s.colors.length>0?m(`Extracted ${s.colors.length} colors from website`):h("No colors found on the website. Try a different URL.")}catch(s){console.error("Extract colors error:",s),h(s.message||"Failed to extract branding")}finally{L(!1)}},he=(s,r)=>{switch(r){case"primary":u(s);break;case"secondary":g(s);break;case"bodyDark":U(s);break;case"bodyLight":T(s);break;case"accent1":A(s);break;case"accent2":I(s);break}m(`Applied ${s} to ${{primary:"Primary",secondary:"Secondary",bodyDark:"Body Text (Dark)",bodyLight:"Body Text (Light)",accent1:"Accent 1",accent2:"Accent 2"}[r]}`)},ue=()=>{S(""),E([]),p(!0)};return le?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading brands..."})}):P?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-red-500",children:["Error: ",P]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Brands Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage brand configurations for your sites"})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(n,{type:"text",placeholder:"Search brands...",value:B,onChange:s=>H(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:i,onChange:s=>X(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Clients"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{value:b,onChange:s=>K(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Sites"}),k.filter(s=>i==="all"||s.clientId===i).map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{value:v,onChange:s=>J(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",onClick:ue,children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Extract from Website"]}),e.jsxs(o,{onClick:$,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"New Brand"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(s=>{var r;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center",style:{backgroundColor:s.primaryColor||"#4F46E5"},children:e.jsx(f,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),s.clientId&&e.jsx("p",{className:"text-xs text-gray-500",children:((r=y.find(l=>l.id===s.clientId))==null?void 0:r.name)||"Unknown Client"}),e.jsxs(be,{variant:s.status==="active"?"default":"secondary",children:[s.status==="active"?e.jsx(Ne,{className:"w-3 h-3 mr-1"}):e.jsx(we,{className:"w-3 h-3 mr-1"}),s.status]})]})]})}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[s.primaryColor&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:s.primaryColor}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Primary"})]}),s.secondaryColor&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:s.secondaryColor}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Secondary"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-200",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>xe(s),className:"flex-1",children:[e.jsx(Se,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>de(s.id,s.name),disabled:Z,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]},s.id)})}),M.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(f,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No brands found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by creating your first brand"}),e.jsxs(o,{onClick:$,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Create Brand"]})]}),e.jsx(R,{open:Y,onOpenChange:d,children:e.jsxs(q,{className:"max-w-2xl",children:[e.jsxs(V,{children:[e.jsx(O,{children:a?"Edit Brand":"Create New Brand"}),e.jsx(W,{children:a?"Update brand information":"Add a new brand configuration"})]}),e.jsxs("form",{onSubmit:ie,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"clientId",children:"Client *"}),e.jsxs("select",{id:"clientId",name:"clientId",defaultValue:(a==null?void 0:a.clientId)||"",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Select a client"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This brand will only be accessible to the selected client"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"name",children:"Brand Name *"}),e.jsx(n,{id:"name",name:"name",defaultValue:a==null?void 0:a.name,required:!0,placeholder:"e.g., WeCelebrate"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"description",children:"Description"}),e.jsx(Ce,{id:"description",name:"description",defaultValue:a==null?void 0:a.description,placeholder:"Brief description of the brand",rows:3})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"logoUrl",children:"Logo URL"}),e.jsx(n,{id:"logoUrl",name:"logoUrl",type:"url",defaultValue:a==null?void 0:a.logoUrl,placeholder:"https://example.com/logo.png"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"primaryColor",children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{id:"primaryColor",name:"primaryColor",type:"color",value:N,onChange:s=>u(s.target.value),className:"w-20"}),e.jsx(n,{type:"text",value:N,onChange:s=>u(s.target.value),placeholder:"#4F46E5",className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"secondaryColor",children:"Secondary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{id:"secondaryColor",name:"secondaryColor",type:"color",value:w,onChange:s=>g(s.target.value),className:"w-20"}),e.jsx(n,{type:"text",value:w,onChange:s=>g(s.target.value),placeholder:"#818CF8",className:"flex-1"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",name:"status",defaultValue:(a==null?void 0:a.status)||"active",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs(z,{className:"mt-6",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{d(!1),C(null)},children:"Cancel"}),e.jsx(o,{type:"submit",children:a?"Update Brand":"Create Brand"})]})]})]})}),e.jsx(R,{open:re,onOpenChange:p,children:e.jsxs(q,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsx(O,{children:"Extract Branding from Website"}),e.jsx(W,{children:"Enter a website URL to automatically extract colors from its design"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"extractUrl",children:"Website URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{id:"extractUrl",value:x,onChange:s=>S(s.target.value),placeholder:"https://example.com",className:"flex-1"}),e.jsx(o,{onClick:me,disabled:F||!x,children:F?"Extracting...":"Extract Colors"})]})]}),j.length>0&&e.jsxs("div",{children:[e.jsx(c,{children:"Extracted Colors"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Colors are sorted by frequency of use. Select where to apply each color."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[50vh] overflow-y-auto pr-2",children:j.map((s,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"w-full h-24 rounded-lg mb-2 border-2 border-gray-300",style:{backgroundColor:s.color}}),e.jsx("div",{className:"text-xs font-mono text-center mb-1 font-semibold",children:s.color}),e.jsxs("div",{className:"text-xs text-gray-500 text-center mb-3 line-clamp-2",title:`Used ${s.count}x in: ${s.usage}`,children:[s.count,"x â€¢ ",s.usage]}),e.jsxs("select",{className:"w-full text-xs border border-gray-300 rounded px-2 py-1.5 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",onChange:l=>{l.target.value&&(he(s.color,l.target.value),l.target.value="")},defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Apply to..."}),e.jsx("option",{value:"primary",children:"Primary Color"}),e.jsx("option",{value:"secondary",children:"Secondary Color"}),e.jsx("option",{value:"bodyDark",children:"Body Text (Dark)"}),e.jsx("option",{value:"bodyLight",children:"Body Text (Light)"}),e.jsx("option",{value:"accent1",children:"Accent Color 1"}),e.jsx("option",{value:"accent2",children:"Accent Color 2"})]})]},r))})]}),j.length===0&&!F&&x&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:'No colors extracted yet. Click "Extract Colors" to analyze the website.'})]})]}),e.jsxs(z,{children:[e.jsx(o,{variant:"outline",onClick:()=>{p(!1),S(""),E([])},children:"Close"}),e.jsx(o,{onClick:()=>{p(!1),d(!0)},disabled:j.length===0,children:"Continue to Create Brand"})]})]})})]})}export{Je as BrandsManagement};
