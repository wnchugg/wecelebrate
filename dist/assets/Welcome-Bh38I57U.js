import{j as e,u as L,a as U,b as _,c as G,d as H,r as h,l as A,g as D,p as E,M as V,A as S}from"./index-DHDOl0g2.js";import{S as P}from"./star-BHKNlOOK.js";import{H as X}from"./heart-Dz5W68yx.js";import{S as K}from"./sparkles-4N5dLyDN.js";import{G as q}from"./gift-BJG2t0OD.js";import{A as J}from"./award-uiW92NxF.js";import{P as O}from"./play-C-DWbc3T.js";const N=[{id:"anniversary-confetti",name:"Anniversary Confetti",category:"anniversary",backgroundColor:"#FF6B9D",accentColor:"#FFD93D",textColor:"#FFFFFF",design:"confetti"},{id:"anniversary-elegant",name:"Anniversary Elegant",category:"anniversary",backgroundColor:"#6C5CE7",accentColor:"#A29BFE",textColor:"#FFFFFF",design:"gradient"},{id:"thank-you-stars",name:"Thank You Stars",category:"thank-you",backgroundColor:"#00B4CC",accentColor:"#FFD93D",textColor:"#FFFFFF",design:"stars"},{id:"congratulations-balloons",name:"Congratulations Balloons",category:"congratulations",backgroundColor:"#FD79A8",accentColor:"#FDCB6E",textColor:"#2D3436",design:"balloons"},{id:"celebration-gradient",name:"Celebration Gradient",category:"general",backgroundColor:"#D91C81",accentColor:"#1B2A5E",textColor:"#FFFFFF",design:"gradient"},{id:"appreciation-floral",name:"Appreciation Floral",category:"thank-you",backgroundColor:"#FF6B9D",accentColor:"#FFFFFF",textColor:"#FFFFFF",design:"floral"},{id:"milestone-pattern",name:"Milestone Pattern",category:"anniversary",backgroundColor:"#1B2A5E",accentColor:"#00B4CC",textColor:"#FFFFFF",design:"pattern"},{id:"simple-minimal",name:"Simple & Clean",category:"general",backgroundColor:"#FFFFFF",accentColor:"#D91C81",textColor:"#2D3436",design:"minimal"}];function Q({template:a,message:c,senderName:t,recipientName:u="You",size:x="medium",showMessage:b=!1}){const y={small:"w-48 h-32",medium:"w-80 h-56",large:"w-96 h-72"},g=()=>{switch(a.design){case"confetti":return e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:Array.from({length:20}).map((p,o)=>e.jsx("div",{className:"absolute rounded-full opacity-60",style:{width:`${Math.random()*8+4}px`,height:`${Math.random()*8+4}px`,backgroundColor:o%2===0?a.accentColor:"#FFFFFF",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,transform:`rotate(${Math.random()*360}deg)`}},o))});case"balloons":return e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:Array.from({length:5}).map((p,o)=>e.jsx("div",{className:"absolute rounded-full opacity-40",style:{width:`${Math.random()*40+30}px`,height:`${Math.random()*50+40}px`,backgroundColor:o%2===0?a.accentColor:"#FFFFFF",left:`${Math.random()*80}%`,bottom:`-${Math.random()*20}%`},children:e.jsx("div",{className:"absolute w-0.5 h-12 opacity-60",style:{backgroundColor:a.textColor,left:"50%",top:"100%"}})},o))});case"stars":return e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:Array.from({length:12}).map((p,o)=>e.jsx(P,{className:"absolute opacity-40",style:{color:o%2===0?a.accentColor:"#FFFFFF",width:`${Math.random()*16+12}px`,height:`${Math.random()*16+12}px`,left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,transform:`rotate(${Math.random()*360}deg)`},fill:"currentColor"},o))});case"gradient":return e.jsx("div",{className:"absolute inset-0",style:{background:`linear-gradient(135deg, ${a.backgroundColor} 0%, ${a.accentColor} 100%)`}});case"pattern":return e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`radial-gradient(circle at 20% 50%, ${a.accentColor} 1px, transparent 1px),
                                  radial-gradient(circle at 80% 80%, ${a.accentColor} 1px, transparent 1px),
                                  radial-gradient(circle at 40% 20%, ${a.accentColor} 1px, transparent 1px)`,backgroundSize:"50px 50px, 80px 80px, 100px 100px"}})});case"floral":return e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:Array.from({length:8}).map((p,o)=>e.jsx("div",{className:"absolute rounded-full opacity-30",style:{width:`${Math.random()*30+20}px`,height:`${Math.random()*30+20}px`,backgroundColor:a.accentColor,left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,boxShadow:`0 0 20px ${a.accentColor}`}},o))});case"minimal":return e.jsx("div",{className:"absolute inset-0 border-4 border-current opacity-20",style:{borderColor:a.accentColor,margin:"8px"}});default:return null}},f=()=>{switch(a.category){case"anniversary":return e.jsx(J,{className:"w-8 h-8"});case"birthday":return e.jsx(q,{className:"w-8 h-8"});case"congratulations":return e.jsx(K,{className:"w-8 h-8"});case"thank-you":return e.jsx(X,{className:"w-8 h-8"});default:return e.jsx(P,{className:"w-8 h-8"})}};return e.jsxs("div",{className:`relative rounded-2xl shadow-lg overflow-hidden ${y[x]}`,style:{backgroundColor:a.backgroundColor},children:[g(),e.jsxs("div",{className:"relative h-full flex flex-col items-center justify-center p-6 text-center z-10",style:{color:a.textColor},children:[e.jsx("div",{className:"mb-4 opacity-80",children:f()}),e.jsxs("h3",{className:"font-bold text-xl mb-2 capitalize",children:[a.category==="anniversary"&&"Congratulations!",a.category==="birthday"&&"Happy Birthday!",a.category==="congratulations"&&"Well Done!",a.category==="thank-you"&&"Thank You!",a.category==="general"&&"Celebration"]}),u&&e.jsx("p",{className:"text-lg font-semibold mb-3 opacity-90",children:u}),b&&c&&e.jsxs("p",{className:"text-sm italic opacity-80 line-clamp-2",children:['"',c,'"']}),t&&e.jsxs("p",{className:"text-xs mt-auto opacity-70",children:["From ",t]})]})]})}function ne(){var F,w,k,$,M;const a=L(),{siteId:c}=U(),{currentSite:t}=_(),{t:u}=G(),{user:x}=H(),[b,y]=h.useState(!1),[g,f]=h.useState([]),[p,o]=h.useState(!1),[Z,v]=h.useState(!1),s=t==null?void 0:t.settings.welcomePageContent,j=(F=t==null?void 0:t.settings.celebrationModule)==null?void 0:F.enabled;h.useEffect(()=>{(async()=>{try{const l=D(),i=await fetch(`${l.supabaseUrl}/functions/v1/make-server-6fcaeea3/public/health-check`,{headers:{Authorization:`Bearer ${E}`,"X-Environment-ID":l.id}});if(!i.ok){v(!0);return}const d=await i.json();if(d.success&&d.sites===0&&d.admins===0){a("/initialize-database");return}v(!0)}catch(l){console.error("[Welcome] Database check error:",l),v(!0)}})()},[a]),h.useEffect(()=>{j&&T()},[j]),h.useEffect(()=>{var r,l;if(t){const i=(r=t.settings)==null?void 0:r.enableWelcomePage;if(A.log("[Welcome] Welcome page setting:",{enableWelcomePage:i,rawSetting:(l=t.settings)==null?void 0:l.enableWelcomePage,willRedirect:i===!1,siteId:c,currentPath:window.location.pathname,fullSettings:t.settings}),i===!1){A.log("[Welcome] Redirecting to gift-selection because welcome page is disabled",{from:window.location.pathname,to:c?"../gift-selection":"/gift-selection"}),a(c?"../gift-selection":"/gift-selection",{replace:!0});return}}},[t,a,c]);const T=async()=>{try{o(!0);const r=(x==null?void 0:x.employeeId)||sessionStorage.getItem("employee_id")||"EMP001",l=D(),i=await fetch(`${l.supabaseUrl}/functions/v1/make-server-6fcaeea3/public/celebrations/${r}`,{headers:{"Content-Type":"application/json","X-Environment-ID":l.id,Authorization:`Bearer ${E}`}});if(!i.ok)throw new Error("Failed to load celebrations");const d=await i.json();if(d.success){const R=(d.celebrations||[]).map(m=>({id:m.id,employeeId:m.recipientId,senderName:m.from,senderRole:"peer",message:m.message,eCard:m.eCardId&&N.find(Y=>Y.id===m.eCardId)||N[0],createdAt:m.createdAt,approved:!0}));f(R)}else throw new Error(d.error||"Failed to load celebrations")}catch(r){console.error("Error loading celebrations:",r),f([])}finally{o(!1)}},B=()=>{a(c?"../gift-selection":"/gift-selection")},I=u("welcome.defaultTitle")||"Congratulations on Your Anniversary!",W=u("welcome.defaultMessage")||`Your dedication and commitment over the years have been invaluable to our team. Today, we celebrate your contributions and the positive impact you've made on our organization.

As a token of our appreciation for your continued service, we invite you to select a special gift. Thank you for being such an important part of our success.`,z=u("welcome.defaultCta")||"Choose Your Gift";if(!t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading..."})]})});if(((w=t.settings)==null?void 0:w.enableWelcomePage)===!1)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#D91C81] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Redirecting..."})]})});const n=((k=t.branding)==null?void 0:k.primaryColor)||"#D91C81",C=(($=t.branding)==null?void 0:$.secondaryColor)||"#1B2A5E";return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"relative px-4 py-16 md:py-24 flex-grow",style:{background:`linear-gradient(135deg, ${n}15 0%, ${C}15 100%)`},children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-0",children:[e.jsx("div",{className:"relative h-[400px] md:h-auto",children:s!=null&&s.videoUrl?e.jsx("div",{className:"relative w-full h-full",children:b?e.jsx("iframe",{src:s.videoUrl,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Welcome Video"}):e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:s.imageUrl||"https://images.unsplash.com/photo-1560439514-4e9645039924?w=800&h=800&fit=crop",alt:"Welcome",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>y(!0),className:"absolute inset-0 flex items-center justify-center group bg-black/20 hover:bg-black/30 transition-colors","aria-label":"Play video",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center transition-transform group-hover:scale-110",style:{backgroundColor:n},children:e.jsx(O,{className:"w-10 h-10 text-white ml-1",fill:"white"})})})]})}):e.jsx("img",{src:(s==null?void 0:s.imageUrl)||"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=800&h=800&fit=crop",alt:"Leadership",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-8 md:p-12 flex flex-col justify-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-6",style:{color:n},children:(s==null?void 0:s.title)||I}),e.jsx("div",{className:"prose prose-lg max-w-none mb-8",children:e.jsx("p",{className:"text-gray-700 text-base md:text-lg leading-relaxed whitespace-pre-wrap",children:(s==null?void 0:s.message)||W})}),((s==null?void 0:s.authorName)||(s==null?void 0:s.authorTitle))&&e.jsx("div",{className:"mt-auto pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center text-white text-lg font-bold flex-shrink-0",style:{backgroundColor:n},children:((M=s.authorName)==null?void 0:M.charAt(0))||"A"}),e.jsxs("div",{children:[s.authorName&&e.jsx("p",{className:"font-bold text-gray-900 text-lg",children:s.authorName}),s.authorTitle&&e.jsx("p",{className:"text-gray-600 text-sm",children:s.authorTitle})]})]})})]})]})})})}),j&&g.length>0&&e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",style:{color:n},children:"Messages from Your Team"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Your colleagues have shared their congratulations and appreciation"})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:g.map(r=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 overflow-hidden cursor-pointer",children:[e.jsx("div",{className:"p-4",children:e.jsx(Q,{template:r.eCard,message:r.message,senderName:r.senderName,recipientName:"You",size:"small",showMessage:!1})}),e.jsxs("div",{className:"px-6 pb-4",children:[e.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed italic mb-4",children:['"',r.message,'"']}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:n},children:r.senderName.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:r.senderName}),e.jsx("p",{className:"text-gray-600 text-xs capitalize",children:r.senderRole==="leadership"?"Leadership Team":r.senderRole})]})]})]})]},r.id))}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:()=>a("/celebration"),className:"inline-flex items-center gap-2 text-lg font-semibold hover:gap-3 transition-all",style:{color:n},children:[e.jsx(V,{className:"w-5 h-5"}),"View all messages & add yours",e.jsx(S,{className:"w-5 h-5"})]})})]}),e.jsx("div",{className:"sticky bottom-0 py-6 px-4 shadow-lg",style:{backgroundColor:C},children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("p",{className:"font-semibold text-lg",children:"Ready to choose your gift?"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Let's get started with your selection"})]}),e.jsxs("button",{onClick:B,className:"inline-flex items-center gap-3 px-8 py-4 rounded-xl font-bold text-lg transition-all hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-offset-2 group",style:{backgroundColor:n,boxShadow:`0 4px 14px ${n}40`},children:[e.jsx("span",{className:"text-white",children:(s==null?void 0:s.ctaText)||z}),e.jsx(S,{className:"w-5 h-5 text-white transition-transform group-hover:translate-x-1"})]})]})})]})}export{ne as Welcome,ne as default};
